(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();function Kn(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var Ie=Kn();function As(e){Ie=e}var yt={exec:()=>null};function S(e,t=""){let n=typeof e=="string"?e:e.source,r={replace:(s,o)=>{let i=typeof o=="string"?o:o.source;return i=i.replace(H.caret,"$1"),n=n.replace(s,i),r},getRegex:()=>new RegExp(n,t)};return r}var ai=(()=>{try{return!!new RegExp("(?<=1)(?<!1)")}catch{return!1}})(),H={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] +\S/,listReplaceTask:/^\[[ xX]\] +/,listTaskCheckbox:/\[[ xX]\]/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:e=>new RegExp(`^( {0,3}${e})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}#`),htmlBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}<(?:[a-z].*>|!--)`,"i")},li=/^(?:[ \t]*(?:\n|$))+/,ci=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,ui=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,xt=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,hi=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,Qn=/(?:[*+-]|\d{1,9}[.)])/,Os=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,zs=S(Os).replace(/bull/g,Qn).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),di=S(Os).replace(/bull/g,Qn).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),er=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,pi=/^[^\n]+/,tr=/(?!\s*\])(?:\\[\s\S]|[^\[\]\\])+/,fi=S(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",tr).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),gi=S(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,Qn).getRegex(),dn="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",nr=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,mi=S("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",nr).replace("tag",dn).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),qs=S(er).replace("hr",xt).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",dn).getRegex(),_i=S(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",qs).getRegex(),rr={blockquote:_i,code:ci,def:fi,fences:ui,heading:hi,hr:xt,html:mi,lheading:zs,list:gi,newline:li,paragraph:qs,table:yt,text:pi},Ar=S("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",xt).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",dn).getRegex(),yi={...rr,lheading:di,table:Ar,paragraph:S(er).replace("hr",xt).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Ar).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",dn).getRegex()},bi={...rr,html:S(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",nr).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:yt,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:S(er).replace("hr",xt).replace("heading",` *#{1,6} *[^
]`).replace("lheading",zs).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},wi=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,ki=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,Is=/^( {2,}|\\)\n(?!\s*$)/,vi=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,pn=/[\p{P}\p{S}]/u,sr=/[\s\p{P}\p{S}]/u,Cs=/[^\s\p{P}\p{S}]/u,Si=S(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,sr).getRegex(),Ns=/(?!~)[\p{P}\p{S}]/u,xi=/(?!~)[\s\p{P}\p{S}]/u,$i=/(?:[^\s\p{P}\p{S}]|~)/u,Pi=S(/link|precode-code|html/,"g").replace("link",/\[(?:[^\[\]`]|(?<a>`+)[^`]+\k<a>(?!`))*?\]\((?:\\[\s\S]|[^\\\(\)]|\((?:\\[\s\S]|[^\\\(\)])*\))*\)/).replace("precode-",ai?"(?<!`)()":"(^^|[^`])").replace("code",/(?<b>`+)[^`]+\k<b>(?!`)/).replace("html",/<(?! )[^<>]*?>/).getRegex(),Ls=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,Ti=S(Ls,"u").replace(/punct/g,pn).getRegex(),Ri=S(Ls,"u").replace(/punct/g,Ns).getRegex(),Ds="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",Mi=S(Ds,"gu").replace(/notPunctSpace/g,Cs).replace(/punctSpace/g,sr).replace(/punct/g,pn).getRegex(),Ei=S(Ds,"gu").replace(/notPunctSpace/g,$i).replace(/punctSpace/g,xi).replace(/punct/g,Ns).getRegex(),Ai=S("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,Cs).replace(/punctSpace/g,sr).replace(/punct/g,pn).getRegex(),Oi=S(/\\(punct)/,"gu").replace(/punct/g,pn).getRegex(),zi=S(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),qi=S(nr).replace("(?:-->|$)","-->").getRegex(),Ii=S("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",qi).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),en=/(?:\[(?:\\[\s\S]|[^\[\]\\])*\]|\\[\s\S]|`+[^`]*?`+(?!`)|[^\[\]\\`])*?/,Ci=S(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",en).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),Zs=S(/^!?\[(label)\]\[(ref)\]/).replace("label",en).replace("ref",tr).getRegex(),Bs=S(/^!?\[(ref)\](?:\[\])?/).replace("ref",tr).getRegex(),Ni=S("reflink|nolink(?!\\()","g").replace("reflink",Zs).replace("nolink",Bs).getRegex(),Or=/[hH][tT][tT][pP][sS]?|[fF][tT][pP]/,or={_backpedal:yt,anyPunctuation:Oi,autolink:zi,blockSkip:Pi,br:Is,code:ki,del:yt,emStrongLDelim:Ti,emStrongRDelimAst:Mi,emStrongRDelimUnd:Ai,escape:wi,link:Ci,nolink:Bs,punctuation:Si,reflink:Zs,reflinkSearch:Ni,tag:Ii,text:vi,url:yt},Li={...or,link:S(/^!?\[(label)\]\((.*?)\)/).replace("label",en).getRegex(),reflink:S(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",en).getRegex()},Dn={...or,emStrongRDelimAst:Ei,emStrongLDelim:Ri,url:S(/^((?:protocol):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/).replace("protocol",Or).replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\[\s\S]|[^\\])*?(?:\\[\s\S]|[^\s~\\]))\1(?=[^~]|$)/,text:S(/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|protocol:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/).replace("protocol",Or).getRegex()},Di={...Dn,br:S(Is).replace("{2,}","*").getRegex(),text:S(Dn.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},Ot={normal:rr,gfm:yi,pedantic:bi},Xe={normal:or,gfm:Dn,breaks:Di,pedantic:Li},Zi={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},zr=e=>Zi[e];function ge(e,t){if(t){if(H.escapeTest.test(e))return e.replace(H.escapeReplace,zr)}else if(H.escapeTestNoEncode.test(e))return e.replace(H.escapeReplaceNoEncode,zr);return e}function qr(e){try{e=encodeURI(e).replace(H.percentDecode,"%")}catch{return null}return e}function Ir(e,t){let n=e.replace(H.findPipe,(o,i,a)=>{let l=!1,c=i;for(;--c>=0&&a[c]==="\\";)l=!l;return l?"|":" |"}),r=n.split(H.splitPipe),s=0;if(r[0].trim()||r.shift(),r.length>0&&!r.at(-1)?.trim()&&r.pop(),t)if(r.length>t)r.splice(t);else for(;r.length<t;)r.push("");for(;s<r.length;s++)r[s]=r[s].trim().replace(H.slashPipe,"|");return r}function Ke(e,t,n){let r=e.length;if(r===0)return"";let s=0;for(;s<r&&e.charAt(r-s-1)===t;)s++;return e.slice(0,r-s)}function Bi(e,t){if(e.indexOf(t[1])===-1)return-1;let n=0;for(let r=0;r<e.length;r++)if(e[r]==="\\")r++;else if(e[r]===t[0])n++;else if(e[r]===t[1]&&(n--,n<0))return r;return n>0?-2:-1}function Cr(e,t,n,r,s){let o=t.href,i=t.title||null,a=e[1].replace(s.other.outputLinkReplace,"$1");r.state.inLink=!0;let l={type:e[0].charAt(0)==="!"?"image":"link",raw:n,href:o,title:i,text:a,tokens:r.inlineTokens(a)};return r.state.inLink=!1,l}function ji(e,t,n){let r=e.match(n.other.indentCodeCompensation);if(r===null)return t;let s=r[1];return t.split(`
`).map(o=>{let i=o.match(n.other.beginningSpace);if(i===null)return o;let[a]=i;return a.length>=s.length?o.slice(s.length):o}).join(`
`)}var tn=class{options;rules;lexer;constructor(e){this.options=e||Ie}space(e){let t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){let t=this.rules.block.code.exec(e);if(t){let n=t[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?n:Ke(n,`
`)}}}fences(e){let t=this.rules.block.fences.exec(e);if(t){let n=t[0],r=ji(n,t[3]||"",this.rules);return{type:"code",raw:n,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:r}}}heading(e){let t=this.rules.block.heading.exec(e);if(t){let n=t[2].trim();if(this.rules.other.endingHash.test(n)){let r=Ke(n,"#");(this.options.pedantic||!r||this.rules.other.endingSpaceChar.test(r))&&(n=r.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:n,tokens:this.lexer.inline(n)}}}hr(e){let t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:Ke(t[0],`
`)}}blockquote(e){let t=this.rules.block.blockquote.exec(e);if(t){let n=Ke(t[0],`
`).split(`
`),r="",s="",o=[];for(;n.length>0;){let i=!1,a=[],l;for(l=0;l<n.length;l++)if(this.rules.other.blockquoteStart.test(n[l]))a.push(n[l]),i=!0;else if(!i)a.push(n[l]);else break;n=n.slice(l);let c=a.join(`
`),u=c.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");r=r?`${r}
${c}`:c,s=s?`${s}
${u}`:u;let d=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(u,o,!0),this.lexer.state.top=d,n.length===0)break;let g=o.at(-1);if(g?.type==="code")break;if(g?.type==="blockquote"){let f=g,_=f.raw+`
`+n.join(`
`),k=this.blockquote(_);o[o.length-1]=k,r=r.substring(0,r.length-f.raw.length)+k.raw,s=s.substring(0,s.length-f.text.length)+k.text;break}else if(g?.type==="list"){let f=g,_=f.raw+`
`+n.join(`
`),k=this.list(_);o[o.length-1]=k,r=r.substring(0,r.length-g.raw.length)+k.raw,s=s.substring(0,s.length-f.raw.length)+k.raw,n=_.substring(o.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:r,tokens:o,text:s}}}list(e){let t=this.rules.block.list.exec(e);if(t){let n=t[1].trim(),r=n.length>1,s={type:"list",raw:"",ordered:r,start:r?+n.slice(0,-1):"",loose:!1,items:[]};n=r?`\\d{1,9}\\${n.slice(-1)}`:`\\${n}`,this.options.pedantic&&(n=r?n:"[*+-]");let o=this.rules.other.listItemRegex(n),i=!1;for(;e;){let l=!1,c="",u="";if(!(t=o.exec(e))||this.rules.block.hr.test(e))break;c=t[0],e=e.substring(c.length);let d=t[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,k=>" ".repeat(3*k.length)),g=e.split(`
`,1)[0],f=!d.trim(),_=0;if(this.options.pedantic?(_=2,u=d.trimStart()):f?_=t[1].length+1:(_=t[2].search(this.rules.other.nonSpaceChar),_=_>4?1:_,u=d.slice(_),_+=t[1].length),f&&this.rules.other.blankLine.test(g)&&(c+=g+`
`,e=e.substring(g.length+1),l=!0),!l){let k=this.rules.other.nextBulletRegex(_),M=this.rules.other.hrRegex(_),L=this.rules.other.fencesBeginRegex(_),I=this.rules.other.headingBeginRegex(_),O=this.rules.other.htmlBeginRegex(_);for(;e;){let T=e.split(`
`,1)[0],E;if(g=T,this.options.pedantic?(g=g.replace(this.rules.other.listReplaceNesting,"  "),E=g):E=g.replace(this.rules.other.tabCharGlobal,"    "),L.test(g)||I.test(g)||O.test(g)||k.test(g)||M.test(g))break;if(E.search(this.rules.other.nonSpaceChar)>=_||!g.trim())u+=`
`+E.slice(_);else{if(f||d.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||L.test(d)||I.test(d)||M.test(d))break;u+=`
`+g}!f&&!g.trim()&&(f=!0),c+=T+`
`,e=e.substring(T.length+1),d=E.slice(_)}}s.loose||(i?s.loose=!0:this.rules.other.doubleBlankLine.test(c)&&(i=!0)),s.items.push({type:"list_item",raw:c,task:!!this.options.gfm&&this.rules.other.listIsTask.test(u),loose:!1,text:u,tokens:[]}),s.raw+=c}let a=s.items.at(-1);if(a)a.raw=a.raw.trimEnd(),a.text=a.text.trimEnd();else return;s.raw=s.raw.trimEnd();for(let l of s.items){if(this.lexer.state.top=!1,l.tokens=this.lexer.blockTokens(l.text,[]),l.task){if(l.text=l.text.replace(this.rules.other.listReplaceTask,""),l.tokens[0]?.type==="text"||l.tokens[0]?.type==="paragraph"){l.tokens[0].raw=l.tokens[0].raw.replace(this.rules.other.listReplaceTask,""),l.tokens[0].text=l.tokens[0].text.replace(this.rules.other.listReplaceTask,"");for(let u=this.lexer.inlineQueue.length-1;u>=0;u--)if(this.rules.other.listIsTask.test(this.lexer.inlineQueue[u].src)){this.lexer.inlineQueue[u].src=this.lexer.inlineQueue[u].src.replace(this.rules.other.listReplaceTask,"");break}}let c=this.rules.other.listTaskCheckbox.exec(l.raw);if(c){let u={type:"checkbox",raw:c[0]+" ",checked:c[0]!=="[ ]"};l.checked=u.checked,s.loose?l.tokens[0]&&["paragraph","text"].includes(l.tokens[0].type)&&"tokens"in l.tokens[0]&&l.tokens[0].tokens?(l.tokens[0].raw=u.raw+l.tokens[0].raw,l.tokens[0].text=u.raw+l.tokens[0].text,l.tokens[0].tokens.unshift(u)):l.tokens.unshift({type:"paragraph",raw:u.raw,text:u.raw,tokens:[u]}):l.tokens.unshift(u)}}if(!s.loose){let c=l.tokens.filter(d=>d.type==="space"),u=c.length>0&&c.some(d=>this.rules.other.anyLine.test(d.raw));s.loose=u}}if(s.loose)for(let l of s.items){l.loose=!0;for(let c of l.tokens)c.type==="text"&&(c.type="paragraph")}return s}}html(e){let t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:t[1]==="pre"||t[1]==="script"||t[1]==="style",text:t[0]}}def(e){let t=this.rules.block.def.exec(e);if(t){let n=t[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),r=t[2]?t[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",s=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:n,raw:t[0],href:r,title:s}}}table(e){let t=this.rules.block.table.exec(e);if(!t||!this.rules.other.tableDelimiter.test(t[2]))return;let n=Ir(t[1]),r=t[2].replace(this.rules.other.tableAlignChars,"").split("|"),s=t[3]?.trim()?t[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],o={type:"table",raw:t[0],header:[],align:[],rows:[]};if(n.length===r.length){for(let i of r)this.rules.other.tableAlignRight.test(i)?o.align.push("right"):this.rules.other.tableAlignCenter.test(i)?o.align.push("center"):this.rules.other.tableAlignLeft.test(i)?o.align.push("left"):o.align.push(null);for(let i=0;i<n.length;i++)o.header.push({text:n[i],tokens:this.lexer.inline(n[i]),header:!0,align:o.align[i]});for(let i of s)o.rows.push(Ir(i,o.header.length).map((a,l)=>({text:a,tokens:this.lexer.inline(a),header:!1,align:o.align[l]})));return o}}lheading(e){let t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){let t=this.rules.block.paragraph.exec(e);if(t){let n=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:n,tokens:this.lexer.inline(n)}}}text(e){let t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){let t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:t[1]}}tag(e){let t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&this.rules.other.startATag.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){let t=this.rules.inline.link.exec(e);if(t){let n=t[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(n)){if(!this.rules.other.endAngleBracket.test(n))return;let o=Ke(n.slice(0,-1),"\\");if((n.length-o.length)%2===0)return}else{let o=Bi(t[2],"()");if(o===-2)return;if(o>-1){let i=(t[0].indexOf("!")===0?5:4)+t[1].length+o;t[2]=t[2].substring(0,o),t[0]=t[0].substring(0,i).trim(),t[3]=""}}let r=t[2],s="";if(this.options.pedantic){let o=this.rules.other.pedanticHrefTitle.exec(r);o&&(r=o[1],s=o[3])}else s=t[3]?t[3].slice(1,-1):"";return r=r.trim(),this.rules.other.startAngleBracket.test(r)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(n)?r=r.slice(1):r=r.slice(1,-1)),Cr(t,{href:r&&r.replace(this.rules.inline.anyPunctuation,"$1"),title:s&&s.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer,this.rules)}}reflink(e,t){let n;if((n=this.rules.inline.reflink.exec(e))||(n=this.rules.inline.nolink.exec(e))){let r=(n[2]||n[1]).replace(this.rules.other.multipleSpaceGlobal," "),s=t[r.toLowerCase()];if(!s){let o=n[0].charAt(0);return{type:"text",raw:o,text:o}}return Cr(n,s,n[0],this.lexer,this.rules)}}emStrong(e,t,n=""){let r=this.rules.inline.emStrongLDelim.exec(e);if(!(!r||r[3]&&n.match(this.rules.other.unicodeAlphaNumeric))&&(!(r[1]||r[2])||!n||this.rules.inline.punctuation.exec(n))){let s=[...r[0]].length-1,o,i,a=s,l=0,c=r[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(c.lastIndex=0,t=t.slice(-1*e.length+s);(r=c.exec(t))!=null;){if(o=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!o)continue;if(i=[...o].length,r[3]||r[4]){a+=i;continue}else if((r[5]||r[6])&&s%3&&!((s+i)%3)){l+=i;continue}if(a-=i,a>0)continue;i=Math.min(i,i+a+l);let u=[...r[0]][0].length,d=e.slice(0,s+r.index+u+i);if(Math.min(s,i)%2){let f=d.slice(1,-1);return{type:"em",raw:d,text:f,tokens:this.lexer.inlineTokens(f)}}let g=d.slice(2,-2);return{type:"strong",raw:d,text:g,tokens:this.lexer.inlineTokens(g)}}}}codespan(e){let t=this.rules.inline.code.exec(e);if(t){let n=t[2].replace(this.rules.other.newLineCharGlobal," "),r=this.rules.other.nonSpaceChar.test(n),s=this.rules.other.startingSpaceChar.test(n)&&this.rules.other.endingSpaceChar.test(n);return r&&s&&(n=n.substring(1,n.length-1)),{type:"codespan",raw:t[0],text:n}}}br(e){let t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){let t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){let t=this.rules.inline.autolink.exec(e);if(t){let n,r;return t[2]==="@"?(n=t[1],r="mailto:"+n):(n=t[1],r=n),{type:"link",raw:t[0],text:n,href:r,tokens:[{type:"text",raw:n,text:n}]}}}url(e){let t;if(t=this.rules.inline.url.exec(e)){let n,r;if(t[2]==="@")n=t[0],r="mailto:"+n;else{let s;do s=t[0],t[0]=this.rules.inline._backpedal.exec(t[0])?.[0]??"";while(s!==t[0]);n=t[0],t[1]==="www."?r="http://"+t[0]:r=t[0]}return{type:"link",raw:t[0],text:n,href:r,tokens:[{type:"text",raw:n,text:n}]}}}inlineText(e){let t=this.rules.inline.text.exec(e);if(t){let n=this.lexer.state.inRawBlock;return{type:"text",raw:t[0],text:t[0],escaped:n}}}},ae=class Zn{tokens;options;state;inlineQueue;tokenizer;constructor(t){this.tokens=[],this.tokens.links=Object.create(null),this.options=t||Ie,this.options.tokenizer=this.options.tokenizer||new tn,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let n={other:H,block:Ot.normal,inline:Xe.normal};this.options.pedantic?(n.block=Ot.pedantic,n.inline=Xe.pedantic):this.options.gfm&&(n.block=Ot.gfm,this.options.breaks?n.inline=Xe.breaks:n.inline=Xe.gfm),this.tokenizer.rules=n}static get rules(){return{block:Ot,inline:Xe}}static lex(t,n){return new Zn(n).lex(t)}static lexInline(t,n){return new Zn(n).inlineTokens(t)}lex(t){t=t.replace(H.carriageReturn,`
`),this.blockTokens(t,this.tokens);for(let n=0;n<this.inlineQueue.length;n++){let r=this.inlineQueue[n];this.inlineTokens(r.src,r.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(t,n=[],r=!1){for(this.options.pedantic&&(t=t.replace(H.tabCharGlobal,"    ").replace(H.spaceLine,""));t;){let s;if(this.options.extensions?.block?.some(i=>(s=i.call({lexer:this},t,n))?(t=t.substring(s.raw.length),n.push(s),!0):!1))continue;if(s=this.tokenizer.space(t)){t=t.substring(s.raw.length);let i=n.at(-1);s.raw.length===1&&i!==void 0?i.raw+=`
`:n.push(s);continue}if(s=this.tokenizer.code(t)){t=t.substring(s.raw.length);let i=n.at(-1);i?.type==="paragraph"||i?.type==="text"?(i.raw+=(i.raw.endsWith(`
`)?"":`
`)+s.raw,i.text+=`
`+s.text,this.inlineQueue.at(-1).src=i.text):n.push(s);continue}if(s=this.tokenizer.fences(t)){t=t.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.heading(t)){t=t.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.hr(t)){t=t.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.blockquote(t)){t=t.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.list(t)){t=t.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.html(t)){t=t.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.def(t)){t=t.substring(s.raw.length);let i=n.at(-1);i?.type==="paragraph"||i?.type==="text"?(i.raw+=(i.raw.endsWith(`
`)?"":`
`)+s.raw,i.text+=`
`+s.raw,this.inlineQueue.at(-1).src=i.text):this.tokens.links[s.tag]||(this.tokens.links[s.tag]={href:s.href,title:s.title},n.push(s));continue}if(s=this.tokenizer.table(t)){t=t.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.lheading(t)){t=t.substring(s.raw.length),n.push(s);continue}let o=t;if(this.options.extensions?.startBlock){let i=1/0,a=t.slice(1),l;this.options.extensions.startBlock.forEach(c=>{l=c.call({lexer:this},a),typeof l=="number"&&l>=0&&(i=Math.min(i,l))}),i<1/0&&i>=0&&(o=t.substring(0,i+1))}if(this.state.top&&(s=this.tokenizer.paragraph(o))){let i=n.at(-1);r&&i?.type==="paragraph"?(i.raw+=(i.raw.endsWith(`
`)?"":`
`)+s.raw,i.text+=`
`+s.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=i.text):n.push(s),r=o.length!==t.length,t=t.substring(s.raw.length);continue}if(s=this.tokenizer.text(t)){t=t.substring(s.raw.length);let i=n.at(-1);i?.type==="text"?(i.raw+=(i.raw.endsWith(`
`)?"":`
`)+s.raw,i.text+=`
`+s.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=i.text):n.push(s);continue}if(t){let i="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(i);break}else throw new Error(i)}}return this.state.top=!0,n}inline(t,n=[]){return this.inlineQueue.push({src:t,tokens:n}),n}inlineTokens(t,n=[]){let r=t,s=null;if(this.tokens.links){let l=Object.keys(this.tokens.links);if(l.length>0)for(;(s=this.tokenizer.rules.inline.reflinkSearch.exec(r))!=null;)l.includes(s[0].slice(s[0].lastIndexOf("[")+1,-1))&&(r=r.slice(0,s.index)+"["+"a".repeat(s[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(s=this.tokenizer.rules.inline.anyPunctuation.exec(r))!=null;)r=r.slice(0,s.index)+"++"+r.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let o;for(;(s=this.tokenizer.rules.inline.blockSkip.exec(r))!=null;)o=s[2]?s[2].length:0,r=r.slice(0,s.index+o)+"["+"a".repeat(s[0].length-o-2)+"]"+r.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);r=this.options.hooks?.emStrongMask?.call({lexer:this},r)??r;let i=!1,a="";for(;t;){i||(a=""),i=!1;let l;if(this.options.extensions?.inline?.some(u=>(l=u.call({lexer:this},t,n))?(t=t.substring(l.raw.length),n.push(l),!0):!1))continue;if(l=this.tokenizer.escape(t)){t=t.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.tag(t)){t=t.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.link(t)){t=t.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.reflink(t,this.tokens.links)){t=t.substring(l.raw.length);let u=n.at(-1);l.type==="text"&&u?.type==="text"?(u.raw+=l.raw,u.text+=l.text):n.push(l);continue}if(l=this.tokenizer.emStrong(t,r,a)){t=t.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.codespan(t)){t=t.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.br(t)){t=t.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.del(t)){t=t.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.autolink(t)){t=t.substring(l.raw.length),n.push(l);continue}if(!this.state.inLink&&(l=this.tokenizer.url(t))){t=t.substring(l.raw.length),n.push(l);continue}let c=t;if(this.options.extensions?.startInline){let u=1/0,d=t.slice(1),g;this.options.extensions.startInline.forEach(f=>{g=f.call({lexer:this},d),typeof g=="number"&&g>=0&&(u=Math.min(u,g))}),u<1/0&&u>=0&&(c=t.substring(0,u+1))}if(l=this.tokenizer.inlineText(c)){t=t.substring(l.raw.length),l.raw.slice(-1)!=="_"&&(a=l.raw.slice(-1)),i=!0;let u=n.at(-1);u?.type==="text"?(u.raw+=l.raw,u.text+=l.text):n.push(l);continue}if(t){let u="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(u);break}else throw new Error(u)}}return n}},nn=class{options;parser;constructor(e){this.options=e||Ie}space(e){return""}code({text:e,lang:t,escaped:n}){let r=(t||"").match(H.notSpaceStart)?.[0],s=e.replace(H.endingNewline,"")+`
`;return r?'<pre><code class="language-'+ge(r)+'">'+(n?s:ge(s,!0))+`</code></pre>
`:"<pre><code>"+(n?s:ge(s,!0))+`</code></pre>
`}blockquote({tokens:e}){return`<blockquote>
${this.parser.parse(e)}</blockquote>
`}html({text:e}){return e}def(e){return""}heading({tokens:e,depth:t}){return`<h${t}>${this.parser.parseInline(e)}</h${t}>
`}hr(e){return`<hr>
`}list(e){let t=e.ordered,n=e.start,r="";for(let i=0;i<e.items.length;i++){let a=e.items[i];r+=this.listitem(a)}let s=t?"ol":"ul",o=t&&n!==1?' start="'+n+'"':"";return"<"+s+o+`>
`+r+"</"+s+`>
`}listitem(e){return`<li>${this.parser.parse(e.tokens)}</li>
`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox"> '}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>
`}table(e){let t="",n="";for(let s=0;s<e.header.length;s++)n+=this.tablecell(e.header[s]);t+=this.tablerow({text:n});let r="";for(let s=0;s<e.rows.length;s++){let o=e.rows[s];n="";for(let i=0;i<o.length;i++)n+=this.tablecell(o[i]);r+=this.tablerow({text:n})}return r&&(r=`<tbody>${r}</tbody>`),`<table>
<thead>
`+t+`</thead>
`+r+`</table>
`}tablerow({text:e}){return`<tr>
${e}</tr>
`}tablecell(e){let t=this.parser.parseInline(e.tokens),n=e.header?"th":"td";return(e.align?`<${n} align="${e.align}">`:`<${n}>`)+t+`</${n}>
`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${ge(e,!0)}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:t,tokens:n}){let r=this.parser.parseInline(n),s=qr(e);if(s===null)return r;e=s;let o='<a href="'+e+'"';return t&&(o+=' title="'+ge(t)+'"'),o+=">"+r+"</a>",o}image({href:e,title:t,text:n,tokens:r}){r&&(n=this.parser.parseInline(r,this.parser.textRenderer));let s=qr(e);if(s===null)return ge(n);e=s;let o=`<img src="${e}" alt="${n}"`;return t&&(o+=` title="${ge(t)}"`),o+=">",o}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):"escaped"in e&&e.escaped?e.text:ge(e.text)}},ir=class{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}checkbox({raw:e}){return e}},le=class Bn{options;renderer;textRenderer;constructor(t){this.options=t||Ie,this.options.renderer=this.options.renderer||new nn,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new ir}static parse(t,n){return new Bn(n).parse(t)}static parseInline(t,n){return new Bn(n).parseInline(t)}parse(t){let n="";for(let r=0;r<t.length;r++){let s=t[r];if(this.options.extensions?.renderers?.[s.type]){let i=s,a=this.options.extensions.renderers[i.type].call({parser:this},i);if(a!==!1||!["space","hr","heading","code","table","blockquote","list","html","def","paragraph","text"].includes(i.type)){n+=a||"";continue}}let o=s;switch(o.type){case"space":{n+=this.renderer.space(o);break}case"hr":{n+=this.renderer.hr(o);break}case"heading":{n+=this.renderer.heading(o);break}case"code":{n+=this.renderer.code(o);break}case"table":{n+=this.renderer.table(o);break}case"blockquote":{n+=this.renderer.blockquote(o);break}case"list":{n+=this.renderer.list(o);break}case"checkbox":{n+=this.renderer.checkbox(o);break}case"html":{n+=this.renderer.html(o);break}case"def":{n+=this.renderer.def(o);break}case"paragraph":{n+=this.renderer.paragraph(o);break}case"text":{n+=this.renderer.text(o);break}default:{let i='Token with "'+o.type+'" type was not found.';if(this.options.silent)return console.error(i),"";throw new Error(i)}}}return n}parseInline(t,n=this.renderer){let r="";for(let s=0;s<t.length;s++){let o=t[s];if(this.options.extensions?.renderers?.[o.type]){let a=this.options.extensions.renderers[o.type].call({parser:this},o);if(a!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(o.type)){r+=a||"";continue}}let i=o;switch(i.type){case"escape":{r+=n.text(i);break}case"html":{r+=n.html(i);break}case"link":{r+=n.link(i);break}case"image":{r+=n.image(i);break}case"checkbox":{r+=n.checkbox(i);break}case"strong":{r+=n.strong(i);break}case"em":{r+=n.em(i);break}case"codespan":{r+=n.codespan(i);break}case"br":{r+=n.br(i);break}case"del":{r+=n.del(i);break}case"text":{r+=n.text(i);break}default:{let a='Token with "'+i.type+'" type was not found.';if(this.options.silent)return console.error(a),"";throw new Error(a)}}}return r}},ft=class{options;block;constructor(e){this.options=e||Ie}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens","emStrongMask"]);static passThroughHooksRespectAsync=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}emStrongMask(e){return e}provideLexer(){return this.block?ae.lex:ae.lexInline}provideParser(){return this.block?le.parse:le.parseInline}},Fi=class{defaults=Kn();options=this.setOptions;parse=this.parseMarkdown(!0);parseInline=this.parseMarkdown(!1);Parser=le;Renderer=nn;TextRenderer=ir;Lexer=ae;Tokenizer=tn;Hooks=ft;constructor(...e){this.use(...e)}walkTokens(e,t){let n=[];for(let r of e)switch(n=n.concat(t.call(this,r)),r.type){case"table":{let s=r;for(let o of s.header)n=n.concat(this.walkTokens(o.tokens,t));for(let o of s.rows)for(let i of o)n=n.concat(this.walkTokens(i.tokens,t));break}case"list":{let s=r;n=n.concat(this.walkTokens(s.items,t));break}default:{let s=r;this.defaults.extensions?.childTokens?.[s.type]?this.defaults.extensions.childTokens[s.type].forEach(o=>{let i=s[o].flat(1/0);n=n.concat(this.walkTokens(i,t))}):s.tokens&&(n=n.concat(this.walkTokens(s.tokens,t)))}}return n}use(...e){let t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(n=>{let r={...n};if(r.async=this.defaults.async||r.async||!1,n.extensions&&(n.extensions.forEach(s=>{if(!s.name)throw new Error("extension name required");if("renderer"in s){let o=t.renderers[s.name];o?t.renderers[s.name]=function(...i){let a=s.renderer.apply(this,i);return a===!1&&(a=o.apply(this,i)),a}:t.renderers[s.name]=s.renderer}if("tokenizer"in s){if(!s.level||s.level!=="block"&&s.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let o=t[s.level];o?o.unshift(s.tokenizer):t[s.level]=[s.tokenizer],s.start&&(s.level==="block"?t.startBlock?t.startBlock.push(s.start):t.startBlock=[s.start]:s.level==="inline"&&(t.startInline?t.startInline.push(s.start):t.startInline=[s.start]))}"childTokens"in s&&s.childTokens&&(t.childTokens[s.name]=s.childTokens)}),r.extensions=t),n.renderer){let s=this.defaults.renderer||new nn(this.defaults);for(let o in n.renderer){if(!(o in s))throw new Error(`renderer '${o}' does not exist`);if(["options","parser"].includes(o))continue;let i=o,a=n.renderer[i],l=s[i];s[i]=(...c)=>{let u=a.apply(s,c);return u===!1&&(u=l.apply(s,c)),u||""}}r.renderer=s}if(n.tokenizer){let s=this.defaults.tokenizer||new tn(this.defaults);for(let o in n.tokenizer){if(!(o in s))throw new Error(`tokenizer '${o}' does not exist`);if(["options","rules","lexer"].includes(o))continue;let i=o,a=n.tokenizer[i],l=s[i];s[i]=(...c)=>{let u=a.apply(s,c);return u===!1&&(u=l.apply(s,c)),u}}r.tokenizer=s}if(n.hooks){let s=this.defaults.hooks||new ft;for(let o in n.hooks){if(!(o in s))throw new Error(`hook '${o}' does not exist`);if(["options","block"].includes(o))continue;let i=o,a=n.hooks[i],l=s[i];ft.passThroughHooks.has(o)?s[i]=c=>{if(this.defaults.async&&ft.passThroughHooksRespectAsync.has(o))return(async()=>{let d=await a.call(s,c);return l.call(s,d)})();let u=a.call(s,c);return l.call(s,u)}:s[i]=(...c)=>{if(this.defaults.async)return(async()=>{let d=await a.apply(s,c);return d===!1&&(d=await l.apply(s,c)),d})();let u=a.apply(s,c);return u===!1&&(u=l.apply(s,c)),u}}r.hooks=s}if(n.walkTokens){let s=this.defaults.walkTokens,o=n.walkTokens;r.walkTokens=function(i){let a=[];return a.push(o.call(this,i)),s&&(a=a.concat(s.call(this,i))),a}}this.defaults={...this.defaults,...r}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return ae.lex(e,t??this.defaults)}parser(e,t){return le.parse(e,t??this.defaults)}parseMarkdown(e){return(t,n)=>{let r={...n},s={...this.defaults,...r},o=this.onError(!!s.silent,!!s.async);if(this.defaults.async===!0&&r.async===!1)return o(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof t>"u"||t===null)return o(new Error("marked(): input parameter is undefined or null"));if(typeof t!="string")return o(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(t)+", string expected"));if(s.hooks&&(s.hooks.options=s,s.hooks.block=e),s.async)return(async()=>{let i=s.hooks?await s.hooks.preprocess(t):t,a=await(s.hooks?await s.hooks.provideLexer():e?ae.lex:ae.lexInline)(i,s),l=s.hooks?await s.hooks.processAllTokens(a):a;s.walkTokens&&await Promise.all(this.walkTokens(l,s.walkTokens));let c=await(s.hooks?await s.hooks.provideParser():e?le.parse:le.parseInline)(l,s);return s.hooks?await s.hooks.postprocess(c):c})().catch(o);try{s.hooks&&(t=s.hooks.preprocess(t));let i=(s.hooks?s.hooks.provideLexer():e?ae.lex:ae.lexInline)(t,s);s.hooks&&(i=s.hooks.processAllTokens(i)),s.walkTokens&&this.walkTokens(i,s.walkTokens);let a=(s.hooks?s.hooks.provideParser():e?le.parse:le.parseInline)(i,s);return s.hooks&&(a=s.hooks.postprocess(a)),a}catch(i){return o(i)}}}onError(e,t){return n=>{if(n.message+=`
Please report this to https://github.com/markedjs/marked.`,e){let r="<p>An error occurred:</p><pre>"+ge(n.message+"",!0)+"</pre>";return t?Promise.resolve(r):r}if(t)return Promise.reject(n);throw n}}},Oe=new Fi;function x(e,t){return Oe.parse(e,t)}x.options=x.setOptions=function(e){return Oe.setOptions(e),x.defaults=Oe.defaults,As(x.defaults),x};x.getDefaults=Kn;x.defaults=Ie;x.use=function(...e){return Oe.use(...e),x.defaults=Oe.defaults,As(x.defaults),x};x.walkTokens=function(e,t){return Oe.walkTokens(e,t)};x.parseInline=Oe.parseInline;x.Parser=le;x.parser=le.parse;x.Renderer=nn;x.TextRenderer=ir;x.Lexer=ae;x.lexer=ae.lex;x.Tokenizer=tn;x.Hooks=ft;x.parse=x;x.options;x.setOptions;x.use;x.walkTokens;x.parseInline;le.parse;ae.lex;function p(e,t,n){function r(a,l){if(a._zod||Object.defineProperty(a,"_zod",{value:{def:l,constr:i,traits:new Set},enumerable:!1}),a._zod.traits.has(e))return;a._zod.traits.add(e),t(a,l);const c=i.prototype,u=Object.keys(c);for(let d=0;d<u.length;d++){const g=u[d];g in a||(a[g]=c[g].bind(a))}}const s=n?.Parent??Object;class o extends s{}Object.defineProperty(o,"name",{value:e});function i(a){var l;const c=n?.Parent?new o:this;r(c,a),(l=c._zod).deferred??(l.deferred=[]);for(const u of c._zod.deferred)u();return c}return Object.defineProperty(i,"init",{value:r}),Object.defineProperty(i,Symbol.hasInstance,{value:a=>n?.Parent&&a instanceof n.Parent?!0:a?._zod?.traits?.has(e)}),Object.defineProperty(i,"name",{value:e}),i}class Ue extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}class js extends Error{constructor(t){super(`Encountered unidirectional transform during encode: ${t}`),this.name="ZodEncodeError"}}const Fs={};function ze(e){return Fs}function Us(e){const t=Object.values(e).filter(r=>typeof r=="number");return Object.entries(e).filter(([r,s])=>t.indexOf(+r)===-1).map(([r,s])=>s)}function jn(e,t){return typeof t=="bigint"?t.toString():t}function ar(e){return{get value(){{const t=e();return Object.defineProperty(this,"value",{value:t}),t}}}}function lr(e){return e==null}function cr(e){const t=e.startsWith("^")?1:0,n=e.endsWith("$")?e.length-1:e.length;return e.slice(t,n)}function Ui(e,t){const n=(e.toString().split(".")[1]||"").length,r=t.toString();let s=(r.split(".")[1]||"").length;if(s===0&&/\d?e-\d?/.test(r)){const l=r.match(/\d?e-(\d?)/);l?.[1]&&(s=Number.parseInt(l[1]))}const o=n>s?n:s,i=Number.parseInt(e.toFixed(o).replace(".","")),a=Number.parseInt(t.toFixed(o).replace(".",""));return i%a/10**o}const Nr=Symbol("evaluating");function $(e,t,n){let r;Object.defineProperty(e,t,{get(){if(r!==Nr)return r===void 0&&(r=Nr,r=n()),r},set(s){Object.defineProperty(e,t,{value:s})},configurable:!0})}function Ce(e,t,n){Object.defineProperty(e,t,{value:n,writable:!0,enumerable:!0,configurable:!0})}function ve(...e){const t={};for(const n of e){const r=Object.getOwnPropertyDescriptors(n);Object.assign(t,r)}return Object.defineProperties({},t)}function Lr(e){return JSON.stringify(e)}function Wi(e){return e.toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/[\s_-]+/g,"-").replace(/^-+|-+$/g,"")}const Ws="captureStackTrace"in Error?Error.captureStackTrace:(...e)=>{};function rn(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}const Hi=ar(()=>{if(typeof navigator<"u"&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{const e=Function;return new e(""),!0}catch{return!1}});function wt(e){if(rn(e)===!1)return!1;const t=e.constructor;if(t===void 0||typeof t!="function")return!0;const n=t.prototype;return!(rn(n)===!1||Object.prototype.hasOwnProperty.call(n,"isPrototypeOf")===!1)}function Hs(e){return wt(e)?{...e}:Array.isArray(e)?[...e]:e}const Yi=new Set(["string","number","symbol"]);function fn(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Se(e,t,n){const r=new e._zod.constr(t??e._zod.def);return(!t||n?.parent)&&(r._zod.parent=e),r}function y(e){const t=e;if(!t)return{};if(typeof t=="string")return{error:()=>t};if(t?.message!==void 0){if(t?.error!==void 0)throw new Error("Cannot specify both `message` and `error` params");t.error=t.message}return delete t.message,typeof t.error=="string"?{...t,error:()=>t.error}:t}function Ji(e){return Object.keys(e).filter(t=>e[t]._zod.optin==="optional"&&e[t]._zod.optout==="optional")}const Gi={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]};function Vi(e,t){const n=e._zod.def,r=n.checks;if(r&&r.length>0)throw new Error(".pick() cannot be used on object schemas containing refinements");const o=ve(e._zod.def,{get shape(){const i={};for(const a in t){if(!(a in n.shape))throw new Error(`Unrecognized key: "${a}"`);t[a]&&(i[a]=n.shape[a])}return Ce(this,"shape",i),i},checks:[]});return Se(e,o)}function Xi(e,t){const n=e._zod.def,r=n.checks;if(r&&r.length>0)throw new Error(".omit() cannot be used on object schemas containing refinements");const o=ve(e._zod.def,{get shape(){const i={...e._zod.def.shape};for(const a in t){if(!(a in n.shape))throw new Error(`Unrecognized key: "${a}"`);t[a]&&delete i[a]}return Ce(this,"shape",i),i},checks:[]});return Se(e,o)}function Ki(e,t){if(!wt(t))throw new Error("Invalid input to extend: expected a plain object");const n=e._zod.def.checks;if(n&&n.length>0){const o=e._zod.def.shape;for(const i in t)if(Object.getOwnPropertyDescriptor(o,i)!==void 0)throw new Error("Cannot overwrite keys on object schemas containing refinements. Use `.safeExtend()` instead.")}const s=ve(e._zod.def,{get shape(){const o={...e._zod.def.shape,...t};return Ce(this,"shape",o),o}});return Se(e,s)}function Qi(e,t){if(!wt(t))throw new Error("Invalid input to safeExtend: expected a plain object");const n=ve(e._zod.def,{get shape(){const r={...e._zod.def.shape,...t};return Ce(this,"shape",r),r}});return Se(e,n)}function ea(e,t){const n=ve(e._zod.def,{get shape(){const r={...e._zod.def.shape,...t._zod.def.shape};return Ce(this,"shape",r),r},get catchall(){return t._zod.def.catchall},checks:[]});return Se(e,n)}function ta(e,t,n){const s=t._zod.def.checks;if(s&&s.length>0)throw new Error(".partial() cannot be used on object schemas containing refinements");const i=ve(t._zod.def,{get shape(){const a=t._zod.def.shape,l={...a};if(n)for(const c in n){if(!(c in a))throw new Error(`Unrecognized key: "${c}"`);n[c]&&(l[c]=e?new e({type:"optional",innerType:a[c]}):a[c])}else for(const c in a)l[c]=e?new e({type:"optional",innerType:a[c]}):a[c];return Ce(this,"shape",l),l},checks:[]});return Se(t,i)}function na(e,t,n){const r=ve(t._zod.def,{get shape(){const s=t._zod.def.shape,o={...s};if(n)for(const i in n){if(!(i in o))throw new Error(`Unrecognized key: "${i}"`);n[i]&&(o[i]=new e({type:"nonoptional",innerType:s[i]}))}else for(const i in s)o[i]=new e({type:"nonoptional",innerType:s[i]});return Ce(this,"shape",o),o}});return Se(t,r)}function Fe(e,t=0){if(e.aborted===!0)return!0;for(let n=t;n<e.issues.length;n++)if(e.issues[n]?.continue!==!0)return!0;return!1}function Ys(e,t){return t.map(n=>{var r;return(r=n).path??(r.path=[]),n.path.unshift(e),n})}function zt(e){return typeof e=="string"?e:e?.message}function qe(e,t,n){const r={...e,path:e.path??[]};if(!e.message){const s=zt(e.inst?._zod.def?.error?.(e))??zt(t?.error?.(e))??zt(n.customError?.(e))??zt(n.localeError?.(e))??"Invalid input";r.message=s}return delete r.inst,delete r.continue,t?.reportInput||delete r.input,r}function ur(e){return Array.isArray(e)?"array":typeof e=="string"?"string":"unknown"}function kt(...e){const[t,n,r]=e;return typeof t=="string"?{message:t,code:"custom",input:n,inst:r}:{...t}}const Js=(e,t)=>{e.name="$ZodError",Object.defineProperty(e,"_zod",{value:e._zod,enumerable:!1}),Object.defineProperty(e,"issues",{value:t,enumerable:!1}),e.message=JSON.stringify(t,jn,2),Object.defineProperty(e,"toString",{value:()=>e.message,enumerable:!1})},Gs=p("$ZodError",Js),Vs=p("$ZodError",Js,{Parent:Error});function ra(e,t=n=>n.message){const n={},r=[];for(const s of e.issues)s.path.length>0?(n[s.path[0]]=n[s.path[0]]||[],n[s.path[0]].push(t(s))):r.push(t(s));return{formErrors:r,fieldErrors:n}}function sa(e,t=n=>n.message){const n={_errors:[]},r=s=>{for(const o of s.issues)if(o.code==="invalid_union"&&o.errors.length)o.errors.map(i=>r({issues:i}));else if(o.code==="invalid_key")r({issues:o.issues});else if(o.code==="invalid_element")r({issues:o.issues});else if(o.path.length===0)n._errors.push(t(o));else{let i=n,a=0;for(;a<o.path.length;){const l=o.path[a];a===o.path.length-1?(i[l]=i[l]||{_errors:[]},i[l]._errors.push(t(o))):i[l]=i[l]||{_errors:[]},i=i[l],a++}}};return r(e),n}const hr=e=>(t,n,r,s)=>{const o=r?Object.assign(r,{async:!1}):{async:!1},i=t._zod.run({value:n,issues:[]},o);if(i instanceof Promise)throw new Ue;if(i.issues.length){const a=new(s?.Err??e)(i.issues.map(l=>qe(l,o,ze())));throw Ws(a,s?.callee),a}return i.value},dr=e=>async(t,n,r,s)=>{const o=r?Object.assign(r,{async:!0}):{async:!0};let i=t._zod.run({value:n,issues:[]},o);if(i instanceof Promise&&(i=await i),i.issues.length){const a=new(s?.Err??e)(i.issues.map(l=>qe(l,o,ze())));throw Ws(a,s?.callee),a}return i.value},gn=e=>(t,n,r)=>{const s=r?{...r,async:!1}:{async:!1},o=t._zod.run({value:n,issues:[]},s);if(o instanceof Promise)throw new Ue;return o.issues.length?{success:!1,error:new(e??Gs)(o.issues.map(i=>qe(i,s,ze())))}:{success:!0,data:o.value}},oa=gn(Vs),mn=e=>async(t,n,r)=>{const s=r?Object.assign(r,{async:!0}):{async:!0};let o=t._zod.run({value:n,issues:[]},s);return o instanceof Promise&&(o=await o),o.issues.length?{success:!1,error:new e(o.issues.map(i=>qe(i,s,ze())))}:{success:!0,data:o.value}},ia=mn(Vs),aa=e=>(t,n,r)=>{const s=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return hr(e)(t,n,s)},la=e=>(t,n,r)=>hr(e)(t,n,r),ca=e=>async(t,n,r)=>{const s=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return dr(e)(t,n,s)},ua=e=>async(t,n,r)=>dr(e)(t,n,r),ha=e=>(t,n,r)=>{const s=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return gn(e)(t,n,s)},da=e=>(t,n,r)=>gn(e)(t,n,r),pa=e=>async(t,n,r)=>{const s=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return mn(e)(t,n,s)},fa=e=>async(t,n,r)=>mn(e)(t,n,r),ga=/^[cC][^\s-]{8,}$/,ma=/^[0-9a-z]+$/,_a=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,ya=/^[0-9a-vA-V]{20}$/,ba=/^[A-Za-z0-9]{27}$/,wa=/^[a-zA-Z0-9_-]{21}$/,ka=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,va=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,Dr=e=>e?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${e}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/,Sa=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,xa="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function $a(){return new RegExp(xa,"u")}const Pa=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Ta=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:))$/,Ra=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,Ma=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Ea=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,Xs=/^[A-Za-z0-9_-]*$/,Aa=/^\+[1-9]\d{6,14}$/,Ks="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",Oa=new RegExp(`^${Ks}$`);function Qs(e){const t="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof e.precision=="number"?e.precision===-1?`${t}`:e.precision===0?`${t}:[0-5]\\d`:`${t}:[0-5]\\d\\.\\d{${e.precision}}`:`${t}(?::[0-5]\\d(?:\\.\\d+)?)?`}function za(e){return new RegExp(`^${Qs(e)}$`)}function qa(e){const t=Qs({precision:e.precision}),n=["Z"];e.local&&n.push(""),e.offset&&n.push("([+-](?:[01]\\d|2[0-3]):[0-5]\\d)");const r=`${t}(?:${n.join("|")})`;return new RegExp(`^${Ks}T(?:${r})$`)}const Ia=e=>{const t=e?`[\\s\\S]{${e?.minimum??0},${e?.maximum??""}}`:"[\\s\\S]*";return new RegExp(`^${t}$`)},Ca=/^-?\d+$/,Na=/^-?\d+(?:\.\d+)?$/,La=/^(?:true|false)$/i,Da=/^[^A-Z]*$/,Za=/^[^a-z]*$/,G=p("$ZodCheck",(e,t)=>{var n;e._zod??(e._zod={}),e._zod.def=t,(n=e._zod).onattach??(n.onattach=[])}),eo={number:"number",bigint:"bigint",object:"date"},to=p("$ZodCheckLessThan",(e,t)=>{G.init(e,t);const n=eo[typeof t.value];e._zod.onattach.push(r=>{const s=r._zod.bag,o=(t.inclusive?s.maximum:s.exclusiveMaximum)??Number.POSITIVE_INFINITY;t.value<o&&(t.inclusive?s.maximum=t.value:s.exclusiveMaximum=t.value)}),e._zod.check=r=>{(t.inclusive?r.value<=t.value:r.value<t.value)||r.issues.push({origin:n,code:"too_big",maximum:typeof t.value=="object"?t.value.getTime():t.value,input:r.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),no=p("$ZodCheckGreaterThan",(e,t)=>{G.init(e,t);const n=eo[typeof t.value];e._zod.onattach.push(r=>{const s=r._zod.bag,o=(t.inclusive?s.minimum:s.exclusiveMinimum)??Number.NEGATIVE_INFINITY;t.value>o&&(t.inclusive?s.minimum=t.value:s.exclusiveMinimum=t.value)}),e._zod.check=r=>{(t.inclusive?r.value>=t.value:r.value>t.value)||r.issues.push({origin:n,code:"too_small",minimum:typeof t.value=="object"?t.value.getTime():t.value,input:r.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),Ba=p("$ZodCheckMultipleOf",(e,t)=>{G.init(e,t),e._zod.onattach.push(n=>{var r;(r=n._zod.bag).multipleOf??(r.multipleOf=t.value)}),e._zod.check=n=>{if(typeof n.value!=typeof t.value)throw new Error("Cannot mix number and bigint in multiple_of check.");(typeof n.value=="bigint"?n.value%t.value===BigInt(0):Ui(n.value,t.value)===0)||n.issues.push({origin:typeof n.value,code:"not_multiple_of",divisor:t.value,input:n.value,inst:e,continue:!t.abort})}}),ja=p("$ZodCheckNumberFormat",(e,t)=>{G.init(e,t),t.format=t.format||"float64";const n=t.format?.includes("int"),r=n?"int":"number",[s,o]=Gi[t.format];e._zod.onattach.push(i=>{const a=i._zod.bag;a.format=t.format,a.minimum=s,a.maximum=o,n&&(a.pattern=Ca)}),e._zod.check=i=>{const a=i.value;if(n){if(!Number.isInteger(a)){i.issues.push({expected:r,format:t.format,code:"invalid_type",continue:!1,input:a,inst:e});return}if(!Number.isSafeInteger(a)){a>0?i.issues.push({input:a,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:r,inclusive:!0,continue:!t.abort}):i.issues.push({input:a,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:r,inclusive:!0,continue:!t.abort});return}}a<s&&i.issues.push({origin:"number",input:a,code:"too_small",minimum:s,inclusive:!0,inst:e,continue:!t.abort}),a>o&&i.issues.push({origin:"number",input:a,code:"too_big",maximum:o,inclusive:!0,inst:e,continue:!t.abort})}}),Fa=p("$ZodCheckMaxLength",(e,t)=>{var n;G.init(e,t),(n=e._zod.def).when??(n.when=r=>{const s=r.value;return!lr(s)&&s.length!==void 0}),e._zod.onattach.push(r=>{const s=r._zod.bag.maximum??Number.POSITIVE_INFINITY;t.maximum<s&&(r._zod.bag.maximum=t.maximum)}),e._zod.check=r=>{const s=r.value;if(s.length<=t.maximum)return;const i=ur(s);r.issues.push({origin:i,code:"too_big",maximum:t.maximum,inclusive:!0,input:s,inst:e,continue:!t.abort})}}),Ua=p("$ZodCheckMinLength",(e,t)=>{var n;G.init(e,t),(n=e._zod.def).when??(n.when=r=>{const s=r.value;return!lr(s)&&s.length!==void 0}),e._zod.onattach.push(r=>{const s=r._zod.bag.minimum??Number.NEGATIVE_INFINITY;t.minimum>s&&(r._zod.bag.minimum=t.minimum)}),e._zod.check=r=>{const s=r.value;if(s.length>=t.minimum)return;const i=ur(s);r.issues.push({origin:i,code:"too_small",minimum:t.minimum,inclusive:!0,input:s,inst:e,continue:!t.abort})}}),Wa=p("$ZodCheckLengthEquals",(e,t)=>{var n;G.init(e,t),(n=e._zod.def).when??(n.when=r=>{const s=r.value;return!lr(s)&&s.length!==void 0}),e._zod.onattach.push(r=>{const s=r._zod.bag;s.minimum=t.length,s.maximum=t.length,s.length=t.length}),e._zod.check=r=>{const s=r.value,o=s.length;if(o===t.length)return;const i=ur(s),a=o>t.length;r.issues.push({origin:i,...a?{code:"too_big",maximum:t.length}:{code:"too_small",minimum:t.length},inclusive:!0,exact:!0,input:r.value,inst:e,continue:!t.abort})}}),_n=p("$ZodCheckStringFormat",(e,t)=>{var n,r;G.init(e,t),e._zod.onattach.push(s=>{const o=s._zod.bag;o.format=t.format,t.pattern&&(o.patterns??(o.patterns=new Set),o.patterns.add(t.pattern))}),t.pattern?(n=e._zod).check??(n.check=s=>{t.pattern.lastIndex=0,!t.pattern.test(s.value)&&s.issues.push({origin:"string",code:"invalid_format",format:t.format,input:s.value,...t.pattern?{pattern:t.pattern.toString()}:{},inst:e,continue:!t.abort})}):(r=e._zod).check??(r.check=()=>{})}),Ha=p("$ZodCheckRegex",(e,t)=>{_n.init(e,t),e._zod.check=n=>{t.pattern.lastIndex=0,!t.pattern.test(n.value)&&n.issues.push({origin:"string",code:"invalid_format",format:"regex",input:n.value,pattern:t.pattern.toString(),inst:e,continue:!t.abort})}}),Ya=p("$ZodCheckLowerCase",(e,t)=>{t.pattern??(t.pattern=Da),_n.init(e,t)}),Ja=p("$ZodCheckUpperCase",(e,t)=>{t.pattern??(t.pattern=Za),_n.init(e,t)}),Ga=p("$ZodCheckIncludes",(e,t)=>{G.init(e,t);const n=fn(t.includes),r=new RegExp(typeof t.position=="number"?`^.{${t.position}}${n}`:n);t.pattern=r,e._zod.onattach.push(s=>{const o=s._zod.bag;o.patterns??(o.patterns=new Set),o.patterns.add(r)}),e._zod.check=s=>{s.value.includes(t.includes,t.position)||s.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:t.includes,input:s.value,inst:e,continue:!t.abort})}}),Va=p("$ZodCheckStartsWith",(e,t)=>{G.init(e,t);const n=new RegExp(`^${fn(t.prefix)}.*`);t.pattern??(t.pattern=n),e._zod.onattach.push(r=>{const s=r._zod.bag;s.patterns??(s.patterns=new Set),s.patterns.add(n)}),e._zod.check=r=>{r.value.startsWith(t.prefix)||r.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:t.prefix,input:r.value,inst:e,continue:!t.abort})}}),Xa=p("$ZodCheckEndsWith",(e,t)=>{G.init(e,t);const n=new RegExp(`.*${fn(t.suffix)}$`);t.pattern??(t.pattern=n),e._zod.onattach.push(r=>{const s=r._zod.bag;s.patterns??(s.patterns=new Set),s.patterns.add(n)}),e._zod.check=r=>{r.value.endsWith(t.suffix)||r.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:t.suffix,input:r.value,inst:e,continue:!t.abort})}}),Ka=p("$ZodCheckOverwrite",(e,t)=>{G.init(e,t),e._zod.check=n=>{n.value=t.tx(n.value)}});class Qa{constructor(t=[]){this.content=[],this.indent=0,this&&(this.args=t)}indented(t){this.indent+=1,t(this),this.indent-=1}write(t){if(typeof t=="function"){t(this,{execution:"sync"}),t(this,{execution:"async"});return}const r=t.split(`
`).filter(i=>i),s=Math.min(...r.map(i=>i.length-i.trimStart().length)),o=r.map(i=>i.slice(s)).map(i=>" ".repeat(this.indent*2)+i);for(const i of o)this.content.push(i)}compile(){const t=Function,n=this?.args,s=[...(this?.content??[""]).map(o=>`  ${o}`)];return new t(...n,s.join(`
`))}}const el={major:4,minor:3,patch:5},z=p("$ZodType",(e,t)=>{var n;e??(e={}),e._zod.def=t,e._zod.bag=e._zod.bag||{},e._zod.version=el;const r=[...e._zod.def.checks??[]];e._zod.traits.has("$ZodCheck")&&r.unshift(e);for(const s of r)for(const o of s._zod.onattach)o(e);if(r.length===0)(n=e._zod).deferred??(n.deferred=[]),e._zod.deferred?.push(()=>{e._zod.run=e._zod.parse});else{const s=(i,a,l)=>{let c=Fe(i),u;for(const d of a){if(d._zod.def.when){if(!d._zod.def.when(i))continue}else if(c)continue;const g=i.issues.length,f=d._zod.check(i);if(f instanceof Promise&&l?.async===!1)throw new Ue;if(u||f instanceof Promise)u=(u??Promise.resolve()).then(async()=>{await f,i.issues.length!==g&&(c||(c=Fe(i,g)))});else{if(i.issues.length===g)continue;c||(c=Fe(i,g))}}return u?u.then(()=>i):i},o=(i,a,l)=>{if(Fe(i))return i.aborted=!0,i;const c=s(a,r,l);if(c instanceof Promise){if(l.async===!1)throw new Ue;return c.then(u=>e._zod.parse(u,l))}return e._zod.parse(c,l)};e._zod.run=(i,a)=>{if(a.skipChecks)return e._zod.parse(i,a);if(a.direction==="backward"){const c=e._zod.parse({value:i.value,issues:[]},{...a,skipChecks:!0});return c instanceof Promise?c.then(u=>o(u,i,a)):o(c,i,a)}const l=e._zod.parse(i,a);if(l instanceof Promise){if(a.async===!1)throw new Ue;return l.then(c=>s(c,r,a))}return s(l,r,a)}}$(e,"~standard",()=>({validate:s=>{try{const o=oa(e,s);return o.success?{value:o.data}:{issues:o.error?.issues}}catch{return ia(e,s).then(i=>i.success?{value:i.data}:{issues:i.error?.issues})}},vendor:"zod",version:1}))}),pr=p("$ZodString",(e,t)=>{z.init(e,t),e._zod.pattern=[...e?._zod.bag?.patterns??[]].pop()??Ia(e._zod.bag),e._zod.parse=(n,r)=>{if(t.coerce)try{n.value=String(n.value)}catch{}return typeof n.value=="string"||n.issues.push({expected:"string",code:"invalid_type",input:n.value,inst:e}),n}}),R=p("$ZodStringFormat",(e,t)=>{_n.init(e,t),pr.init(e,t)}),tl=p("$ZodGUID",(e,t)=>{t.pattern??(t.pattern=va),R.init(e,t)}),nl=p("$ZodUUID",(e,t)=>{if(t.version){const r={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[t.version];if(r===void 0)throw new Error(`Invalid UUID version: "${t.version}"`);t.pattern??(t.pattern=Dr(r))}else t.pattern??(t.pattern=Dr());R.init(e,t)}),rl=p("$ZodEmail",(e,t)=>{t.pattern??(t.pattern=Sa),R.init(e,t)}),sl=p("$ZodURL",(e,t)=>{R.init(e,t),e._zod.check=n=>{try{const r=n.value.trim(),s=new URL(r);t.hostname&&(t.hostname.lastIndex=0,t.hostname.test(s.hostname)||n.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:t.hostname.source,input:n.value,inst:e,continue:!t.abort})),t.protocol&&(t.protocol.lastIndex=0,t.protocol.test(s.protocol.endsWith(":")?s.protocol.slice(0,-1):s.protocol)||n.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:t.protocol.source,input:n.value,inst:e,continue:!t.abort})),t.normalize?n.value=s.href:n.value=r;return}catch{n.issues.push({code:"invalid_format",format:"url",input:n.value,inst:e,continue:!t.abort})}}}),ol=p("$ZodEmoji",(e,t)=>{t.pattern??(t.pattern=$a()),R.init(e,t)}),il=p("$ZodNanoID",(e,t)=>{t.pattern??(t.pattern=wa),R.init(e,t)}),al=p("$ZodCUID",(e,t)=>{t.pattern??(t.pattern=ga),R.init(e,t)}),ll=p("$ZodCUID2",(e,t)=>{t.pattern??(t.pattern=ma),R.init(e,t)}),cl=p("$ZodULID",(e,t)=>{t.pattern??(t.pattern=_a),R.init(e,t)}),ul=p("$ZodXID",(e,t)=>{t.pattern??(t.pattern=ya),R.init(e,t)}),hl=p("$ZodKSUID",(e,t)=>{t.pattern??(t.pattern=ba),R.init(e,t)}),dl=p("$ZodISODateTime",(e,t)=>{t.pattern??(t.pattern=qa(t)),R.init(e,t)}),pl=p("$ZodISODate",(e,t)=>{t.pattern??(t.pattern=Oa),R.init(e,t)}),fl=p("$ZodISOTime",(e,t)=>{t.pattern??(t.pattern=za(t)),R.init(e,t)}),gl=p("$ZodISODuration",(e,t)=>{t.pattern??(t.pattern=ka),R.init(e,t)}),ml=p("$ZodIPv4",(e,t)=>{t.pattern??(t.pattern=Pa),R.init(e,t),e._zod.bag.format="ipv4"}),_l=p("$ZodIPv6",(e,t)=>{t.pattern??(t.pattern=Ta),R.init(e,t),e._zod.bag.format="ipv6",e._zod.check=n=>{try{new URL(`http://[${n.value}]`)}catch{n.issues.push({code:"invalid_format",format:"ipv6",input:n.value,inst:e,continue:!t.abort})}}}),yl=p("$ZodCIDRv4",(e,t)=>{t.pattern??(t.pattern=Ra),R.init(e,t)}),bl=p("$ZodCIDRv6",(e,t)=>{t.pattern??(t.pattern=Ma),R.init(e,t),e._zod.check=n=>{const r=n.value.split("/");try{if(r.length!==2)throw new Error;const[s,o]=r;if(!o)throw new Error;const i=Number(o);if(`${i}`!==o)throw new Error;if(i<0||i>128)throw new Error;new URL(`http://[${s}]`)}catch{n.issues.push({code:"invalid_format",format:"cidrv6",input:n.value,inst:e,continue:!t.abort})}}});function ro(e){if(e==="")return!0;if(e.length%4!==0)return!1;try{return atob(e),!0}catch{return!1}}const wl=p("$ZodBase64",(e,t)=>{t.pattern??(t.pattern=Ea),R.init(e,t),e._zod.bag.contentEncoding="base64",e._zod.check=n=>{ro(n.value)||n.issues.push({code:"invalid_format",format:"base64",input:n.value,inst:e,continue:!t.abort})}});function kl(e){if(!Xs.test(e))return!1;const t=e.replace(/[-_]/g,r=>r==="-"?"+":"/"),n=t.padEnd(Math.ceil(t.length/4)*4,"=");return ro(n)}const vl=p("$ZodBase64URL",(e,t)=>{t.pattern??(t.pattern=Xs),R.init(e,t),e._zod.bag.contentEncoding="base64url",e._zod.check=n=>{kl(n.value)||n.issues.push({code:"invalid_format",format:"base64url",input:n.value,inst:e,continue:!t.abort})}}),Sl=p("$ZodE164",(e,t)=>{t.pattern??(t.pattern=Aa),R.init(e,t)});function xl(e,t=null){try{const n=e.split(".");if(n.length!==3)return!1;const[r]=n;if(!r)return!1;const s=JSON.parse(atob(r));return!("typ"in s&&s?.typ!=="JWT"||!s.alg||t&&(!("alg"in s)||s.alg!==t))}catch{return!1}}const $l=p("$ZodJWT",(e,t)=>{R.init(e,t),e._zod.check=n=>{xl(n.value,t.alg)||n.issues.push({code:"invalid_format",format:"jwt",input:n.value,inst:e,continue:!t.abort})}}),so=p("$ZodNumber",(e,t)=>{z.init(e,t),e._zod.pattern=e._zod.bag.pattern??Na,e._zod.parse=(n,r)=>{if(t.coerce)try{n.value=Number(n.value)}catch{}const s=n.value;if(typeof s=="number"&&!Number.isNaN(s)&&Number.isFinite(s))return n;const o=typeof s=="number"?Number.isNaN(s)?"NaN":Number.isFinite(s)?void 0:"Infinity":void 0;return n.issues.push({expected:"number",code:"invalid_type",input:s,inst:e,...o?{received:o}:{}}),n}}),Pl=p("$ZodNumberFormat",(e,t)=>{ja.init(e,t),so.init(e,t)}),Tl=p("$ZodBoolean",(e,t)=>{z.init(e,t),e._zod.pattern=La,e._zod.parse=(n,r)=>{if(t.coerce)try{n.value=!!n.value}catch{}const s=n.value;return typeof s=="boolean"||n.issues.push({expected:"boolean",code:"invalid_type",input:s,inst:e}),n}}),Rl=p("$ZodUnknown",(e,t)=>{z.init(e,t),e._zod.parse=n=>n}),Ml=p("$ZodNever",(e,t)=>{z.init(e,t),e._zod.parse=(n,r)=>(n.issues.push({expected:"never",code:"invalid_type",input:n.value,inst:e}),n)});function Zr(e,t,n){e.issues.length&&t.issues.push(...Ys(n,e.issues)),t.value[n]=e.value}const El=p("$ZodArray",(e,t)=>{z.init(e,t),e._zod.parse=(n,r)=>{const s=n.value;if(!Array.isArray(s))return n.issues.push({expected:"array",code:"invalid_type",input:s,inst:e}),n;n.value=Array(s.length);const o=[];for(let i=0;i<s.length;i++){const a=s[i],l=t.element._zod.run({value:a,issues:[]},r);l instanceof Promise?o.push(l.then(c=>Zr(c,n,i))):Zr(l,n,i)}return o.length?Promise.all(o).then(()=>n):n}});function sn(e,t,n,r,s){if(e.issues.length){if(s&&!(n in r))return;t.issues.push(...Ys(n,e.issues))}e.value===void 0?n in r&&(t.value[n]=void 0):t.value[n]=e.value}function oo(e){const t=Object.keys(e.shape);for(const r of t)if(!e.shape?.[r]?._zod?.traits?.has("$ZodType"))throw new Error(`Invalid element at key "${r}": expected a Zod schema`);const n=Ji(e.shape);return{...e,keys:t,keySet:new Set(t),numKeys:t.length,optionalKeys:new Set(n)}}function io(e,t,n,r,s,o){const i=[],a=s.keySet,l=s.catchall._zod,c=l.def.type,u=l.optout==="optional";for(const d in t){if(a.has(d))continue;if(c==="never"){i.push(d);continue}const g=l.run({value:t[d],issues:[]},r);g instanceof Promise?e.push(g.then(f=>sn(f,n,d,t,u))):sn(g,n,d,t,u)}return i.length&&n.issues.push({code:"unrecognized_keys",keys:i,input:t,inst:o}),e.length?Promise.all(e).then(()=>n):n}const Al=p("$ZodObject",(e,t)=>{if(z.init(e,t),!Object.getOwnPropertyDescriptor(t,"shape")?.get){const a=t.shape;Object.defineProperty(t,"shape",{get:()=>{const l={...a};return Object.defineProperty(t,"shape",{value:l}),l}})}const r=ar(()=>oo(t));$(e._zod,"propValues",()=>{const a=t.shape,l={};for(const c in a){const u=a[c]._zod;if(u.values){l[c]??(l[c]=new Set);for(const d of u.values)l[c].add(d)}}return l});const s=rn,o=t.catchall;let i;e._zod.parse=(a,l)=>{i??(i=r.value);const c=a.value;if(!s(c))return a.issues.push({expected:"object",code:"invalid_type",input:c,inst:e}),a;a.value={};const u=[],d=i.shape;for(const g of i.keys){const f=d[g],_=f._zod.optout==="optional",k=f._zod.run({value:c[g],issues:[]},l);k instanceof Promise?u.push(k.then(M=>sn(M,a,g,c,_))):sn(k,a,g,c,_)}return o?io(u,c,a,l,r.value,e):u.length?Promise.all(u).then(()=>a):a}}),Ol=p("$ZodObjectJIT",(e,t)=>{Al.init(e,t);const n=e._zod.parse,r=ar(()=>oo(t)),s=g=>{const f=new Qa(["shape","payload","ctx"]),_=r.value,k=O=>{const T=Lr(O);return`shape[${T}]._zod.run({ value: input[${T}], issues: [] }, ctx)`};f.write("const input = payload.value;");const M=Object.create(null);let L=0;for(const O of _.keys)M[O]=`key_${L++}`;f.write("const newResult = {};");for(const O of _.keys){const T=M[O],E=Lr(O),ie=g[O]?._zod?.optout==="optional";f.write(`const ${T} = ${k(O)};`),ie?f.write(`
        if (${T}.issues.length) {
          if (${E} in input) {
            payload.issues = payload.issues.concat(${T}.issues.map(iss => ({
              ...iss,
              path: iss.path ? [${E}, ...iss.path] : [${E}]
            })));
          }
        }
        
        if (${T}.value === undefined) {
          if (${E} in input) {
            newResult[${E}] = undefined;
          }
        } else {
          newResult[${E}] = ${T}.value;
        }
        
      `):f.write(`
        if (${T}.issues.length) {
          payload.issues = payload.issues.concat(${T}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${E}, ...iss.path] : [${E}]
          })));
        }
        
        if (${T}.value === undefined) {
          if (${E} in input) {
            newResult[${E}] = undefined;
          }
        } else {
          newResult[${E}] = ${T}.value;
        }
        
      `)}f.write("payload.value = newResult;"),f.write("return payload;");const I=f.compile();return(O,T)=>I(g,O,T)};let o;const i=rn,a=!Fs.jitless,c=a&&Hi.value,u=t.catchall;let d;e._zod.parse=(g,f)=>{d??(d=r.value);const _=g.value;return i(_)?a&&c&&f?.async===!1&&f.jitless!==!0?(o||(o=s(t.shape)),g=o(g,f),u?io([],_,g,f,d,e):g):n(g,f):(g.issues.push({expected:"object",code:"invalid_type",input:_,inst:e}),g)}});function Br(e,t,n,r){for(const o of e)if(o.issues.length===0)return t.value=o.value,t;const s=e.filter(o=>!Fe(o));return s.length===1?(t.value=s[0].value,s[0]):(t.issues.push({code:"invalid_union",input:t.value,inst:n,errors:e.map(o=>o.issues.map(i=>qe(i,r,ze())))}),t)}const zl=p("$ZodUnion",(e,t)=>{z.init(e,t),$(e._zod,"optin",()=>t.options.some(s=>s._zod.optin==="optional")?"optional":void 0),$(e._zod,"optout",()=>t.options.some(s=>s._zod.optout==="optional")?"optional":void 0),$(e._zod,"values",()=>{if(t.options.every(s=>s._zod.values))return new Set(t.options.flatMap(s=>Array.from(s._zod.values)))}),$(e._zod,"pattern",()=>{if(t.options.every(s=>s._zod.pattern)){const s=t.options.map(o=>o._zod.pattern);return new RegExp(`^(${s.map(o=>cr(o.source)).join("|")})$`)}});const n=t.options.length===1,r=t.options[0]._zod.run;e._zod.parse=(s,o)=>{if(n)return r(s,o);let i=!1;const a=[];for(const l of t.options){const c=l._zod.run({value:s.value,issues:[]},o);if(c instanceof Promise)a.push(c),i=!0;else{if(c.issues.length===0)return c;a.push(c)}}return i?Promise.all(a).then(l=>Br(l,s,e,o)):Br(a,s,e,o)}}),ql=p("$ZodIntersection",(e,t)=>{z.init(e,t),e._zod.parse=(n,r)=>{const s=n.value,o=t.left._zod.run({value:s,issues:[]},r),i=t.right._zod.run({value:s,issues:[]},r);return o instanceof Promise||i instanceof Promise?Promise.all([o,i]).then(([l,c])=>jr(n,l,c)):jr(n,o,i)}});function Fn(e,t){if(e===t)return{valid:!0,data:e};if(e instanceof Date&&t instanceof Date&&+e==+t)return{valid:!0,data:e};if(wt(e)&&wt(t)){const n=Object.keys(t),r=Object.keys(e).filter(o=>n.indexOf(o)!==-1),s={...e,...t};for(const o of r){const i=Fn(e[o],t[o]);if(!i.valid)return{valid:!1,mergeErrorPath:[o,...i.mergeErrorPath]};s[o]=i.data}return{valid:!0,data:s}}if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return{valid:!1,mergeErrorPath:[]};const n=[];for(let r=0;r<e.length;r++){const s=e[r],o=t[r],i=Fn(s,o);if(!i.valid)return{valid:!1,mergeErrorPath:[r,...i.mergeErrorPath]};n.push(i.data)}return{valid:!0,data:n}}return{valid:!1,mergeErrorPath:[]}}function jr(e,t,n){const r=new Map;let s;for(const a of t.issues)if(a.code==="unrecognized_keys"){s??(s=a);for(const l of a.keys)r.has(l)||r.set(l,{}),r.get(l).l=!0}else e.issues.push(a);for(const a of n.issues)if(a.code==="unrecognized_keys")for(const l of a.keys)r.has(l)||r.set(l,{}),r.get(l).r=!0;else e.issues.push(a);const o=[...r].filter(([,a])=>a.l&&a.r).map(([a])=>a);if(o.length&&s&&e.issues.push({...s,keys:o}),Fe(e))return e;const i=Fn(t.value,n.value);if(!i.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(i.mergeErrorPath)}`);return e.value=i.data,e}const Il=p("$ZodEnum",(e,t)=>{z.init(e,t);const n=Us(t.entries),r=new Set(n);e._zod.values=r,e._zod.pattern=new RegExp(`^(${n.filter(s=>Yi.has(typeof s)).map(s=>typeof s=="string"?fn(s):s.toString()).join("|")})$`),e._zod.parse=(s,o)=>{const i=s.value;return r.has(i)||s.issues.push({code:"invalid_value",values:n,input:i,inst:e}),s}}),Cl=p("$ZodTransform",(e,t)=>{z.init(e,t),e._zod.parse=(n,r)=>{if(r.direction==="backward")throw new js(e.constructor.name);const s=t.transform(n.value,n);if(r.async)return(s instanceof Promise?s:Promise.resolve(s)).then(i=>(n.value=i,n));if(s instanceof Promise)throw new Ue;return n.value=s,n}});function Fr(e,t){return e.issues.length&&t===void 0?{issues:[],value:void 0}:e}const ao=p("$ZodOptional",(e,t)=>{z.init(e,t),e._zod.optin="optional",e._zod.optout="optional",$(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,void 0]):void 0),$(e._zod,"pattern",()=>{const n=t.innerType._zod.pattern;return n?new RegExp(`^(${cr(n.source)})?$`):void 0}),e._zod.parse=(n,r)=>{if(t.innerType._zod.optin==="optional"){const s=t.innerType._zod.run(n,r);return s instanceof Promise?s.then(o=>Fr(o,n.value)):Fr(s,n.value)}return n.value===void 0?n:t.innerType._zod.run(n,r)}}),Nl=p("$ZodExactOptional",(e,t)=>{ao.init(e,t),$(e._zod,"values",()=>t.innerType._zod.values),$(e._zod,"pattern",()=>t.innerType._zod.pattern),e._zod.parse=(n,r)=>t.innerType._zod.run(n,r)}),Ll=p("$ZodNullable",(e,t)=>{z.init(e,t),$(e._zod,"optin",()=>t.innerType._zod.optin),$(e._zod,"optout",()=>t.innerType._zod.optout),$(e._zod,"pattern",()=>{const n=t.innerType._zod.pattern;return n?new RegExp(`^(${cr(n.source)}|null)$`):void 0}),$(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,null]):void 0),e._zod.parse=(n,r)=>n.value===null?n:t.innerType._zod.run(n,r)}),Dl=p("$ZodDefault",(e,t)=>{z.init(e,t),e._zod.optin="optional",$(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(n,r)=>{if(r.direction==="backward")return t.innerType._zod.run(n,r);if(n.value===void 0)return n.value=t.defaultValue,n;const s=t.innerType._zod.run(n,r);return s instanceof Promise?s.then(o=>Ur(o,t)):Ur(s,t)}});function Ur(e,t){return e.value===void 0&&(e.value=t.defaultValue),e}const Zl=p("$ZodPrefault",(e,t)=>{z.init(e,t),e._zod.optin="optional",$(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(n,r)=>(r.direction==="backward"||n.value===void 0&&(n.value=t.defaultValue),t.innerType._zod.run(n,r))}),Bl=p("$ZodNonOptional",(e,t)=>{z.init(e,t),$(e._zod,"values",()=>{const n=t.innerType._zod.values;return n?new Set([...n].filter(r=>r!==void 0)):void 0}),e._zod.parse=(n,r)=>{const s=t.innerType._zod.run(n,r);return s instanceof Promise?s.then(o=>Wr(o,e)):Wr(s,e)}});function Wr(e,t){return!e.issues.length&&e.value===void 0&&e.issues.push({code:"invalid_type",expected:"nonoptional",input:e.value,inst:t}),e}const jl=p("$ZodCatch",(e,t)=>{z.init(e,t),$(e._zod,"optin",()=>t.innerType._zod.optin),$(e._zod,"optout",()=>t.innerType._zod.optout),$(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(n,r)=>{if(r.direction==="backward")return t.innerType._zod.run(n,r);const s=t.innerType._zod.run(n,r);return s instanceof Promise?s.then(o=>(n.value=o.value,o.issues.length&&(n.value=t.catchValue({...n,error:{issues:o.issues.map(i=>qe(i,r,ze()))},input:n.value}),n.issues=[]),n)):(n.value=s.value,s.issues.length&&(n.value=t.catchValue({...n,error:{issues:s.issues.map(o=>qe(o,r,ze()))},input:n.value}),n.issues=[]),n)}}),Fl=p("$ZodPipe",(e,t)=>{z.init(e,t),$(e._zod,"values",()=>t.in._zod.values),$(e._zod,"optin",()=>t.in._zod.optin),$(e._zod,"optout",()=>t.out._zod.optout),$(e._zod,"propValues",()=>t.in._zod.propValues),e._zod.parse=(n,r)=>{if(r.direction==="backward"){const o=t.out._zod.run(n,r);return o instanceof Promise?o.then(i=>qt(i,t.in,r)):qt(o,t.in,r)}const s=t.in._zod.run(n,r);return s instanceof Promise?s.then(o=>qt(o,t.out,r)):qt(s,t.out,r)}});function qt(e,t,n){return e.issues.length?(e.aborted=!0,e):t._zod.run({value:e.value,issues:e.issues},n)}const Ul=p("$ZodReadonly",(e,t)=>{z.init(e,t),$(e._zod,"propValues",()=>t.innerType._zod.propValues),$(e._zod,"values",()=>t.innerType._zod.values),$(e._zod,"optin",()=>t.innerType?._zod?.optin),$(e._zod,"optout",()=>t.innerType?._zod?.optout),e._zod.parse=(n,r)=>{if(r.direction==="backward")return t.innerType._zod.run(n,r);const s=t.innerType._zod.run(n,r);return s instanceof Promise?s.then(Hr):Hr(s)}});function Hr(e){return e.value=Object.freeze(e.value),e}const Wl=p("$ZodCustom",(e,t)=>{G.init(e,t),z.init(e,t),e._zod.parse=(n,r)=>n,e._zod.check=n=>{const r=n.value,s=t.fn(r);if(s instanceof Promise)return s.then(o=>Yr(o,n,r,e));Yr(s,n,r,e)}});function Yr(e,t,n,r){if(!e){const s={code:"custom",input:n,inst:r,path:[...r._zod.def.path??[]],continue:!r._zod.def.abort};r._zod.def.params&&(s.params=r._zod.def.params),t.issues.push(kt(s))}}var Jr;class Hl{constructor(){this._map=new WeakMap,this._idmap=new Map}add(t,...n){const r=n[0];return this._map.set(t,r),r&&typeof r=="object"&&"id"in r&&this._idmap.set(r.id,t),this}clear(){return this._map=new WeakMap,this._idmap=new Map,this}remove(t){const n=this._map.get(t);return n&&typeof n=="object"&&"id"in n&&this._idmap.delete(n.id),this._map.delete(t),this}get(t){const n=t._zod.parent;if(n){const r={...this.get(n)??{}};delete r.id;const s={...r,...this._map.get(t)};return Object.keys(s).length?s:void 0}return this._map.get(t)}has(t){return this._map.has(t)}}function Yl(){return new Hl}(Jr=globalThis).__zod_globalRegistry??(Jr.__zod_globalRegistry=Yl());const gt=globalThis.__zod_globalRegistry;function Jl(e,t){return new e({type:"string",...y(t)})}function Gl(e,t){return new e({type:"string",format:"email",check:"string_format",abort:!1,...y(t)})}function Gr(e,t){return new e({type:"string",format:"guid",check:"string_format",abort:!1,...y(t)})}function Vl(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,...y(t)})}function Xl(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...y(t)})}function Kl(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...y(t)})}function Ql(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...y(t)})}function ec(e,t){return new e({type:"string",format:"url",check:"string_format",abort:!1,...y(t)})}function tc(e,t){return new e({type:"string",format:"emoji",check:"string_format",abort:!1,...y(t)})}function nc(e,t){return new e({type:"string",format:"nanoid",check:"string_format",abort:!1,...y(t)})}function rc(e,t){return new e({type:"string",format:"cuid",check:"string_format",abort:!1,...y(t)})}function sc(e,t){return new e({type:"string",format:"cuid2",check:"string_format",abort:!1,...y(t)})}function oc(e,t){return new e({type:"string",format:"ulid",check:"string_format",abort:!1,...y(t)})}function ic(e,t){return new e({type:"string",format:"xid",check:"string_format",abort:!1,...y(t)})}function ac(e,t){return new e({type:"string",format:"ksuid",check:"string_format",abort:!1,...y(t)})}function lc(e,t){return new e({type:"string",format:"ipv4",check:"string_format",abort:!1,...y(t)})}function cc(e,t){return new e({type:"string",format:"ipv6",check:"string_format",abort:!1,...y(t)})}function uc(e,t){return new e({type:"string",format:"cidrv4",check:"string_format",abort:!1,...y(t)})}function hc(e,t){return new e({type:"string",format:"cidrv6",check:"string_format",abort:!1,...y(t)})}function dc(e,t){return new e({type:"string",format:"base64",check:"string_format",abort:!1,...y(t)})}function pc(e,t){return new e({type:"string",format:"base64url",check:"string_format",abort:!1,...y(t)})}function fc(e,t){return new e({type:"string",format:"e164",check:"string_format",abort:!1,...y(t)})}function gc(e,t){return new e({type:"string",format:"jwt",check:"string_format",abort:!1,...y(t)})}function mc(e,t){return new e({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...y(t)})}function _c(e,t){return new e({type:"string",format:"date",check:"string_format",...y(t)})}function yc(e,t){return new e({type:"string",format:"time",check:"string_format",precision:null,...y(t)})}function bc(e,t){return new e({type:"string",format:"duration",check:"string_format",...y(t)})}function wc(e,t){return new e({type:"number",checks:[],...y(t)})}function kc(e,t){return new e({type:"number",check:"number_format",abort:!1,format:"safeint",...y(t)})}function vc(e,t){return new e({type:"boolean",...y(t)})}function Sc(e){return new e({type:"unknown"})}function xc(e,t){return new e({type:"never",...y(t)})}function Vr(e,t){return new to({check:"less_than",...y(t),value:e,inclusive:!1})}function Pn(e,t){return new to({check:"less_than",...y(t),value:e,inclusive:!0})}function Xr(e,t){return new no({check:"greater_than",...y(t),value:e,inclusive:!1})}function Tn(e,t){return new no({check:"greater_than",...y(t),value:e,inclusive:!0})}function Kr(e,t){return new Ba({check:"multiple_of",...y(t),value:e})}function lo(e,t){return new Fa({check:"max_length",...y(t),maximum:e})}function on(e,t){return new Ua({check:"min_length",...y(t),minimum:e})}function co(e,t){return new Wa({check:"length_equals",...y(t),length:e})}function $c(e,t){return new Ha({check:"string_format",format:"regex",...y(t),pattern:e})}function Pc(e){return new Ya({check:"string_format",format:"lowercase",...y(e)})}function Tc(e){return new Ja({check:"string_format",format:"uppercase",...y(e)})}function Rc(e,t){return new Ga({check:"string_format",format:"includes",...y(t),includes:e})}function Mc(e,t){return new Va({check:"string_format",format:"starts_with",...y(t),prefix:e})}function Ec(e,t){return new Xa({check:"string_format",format:"ends_with",...y(t),suffix:e})}function He(e){return new Ka({check:"overwrite",tx:e})}function Ac(e){return He(t=>t.normalize(e))}function Oc(){return He(e=>e.trim())}function zc(){return He(e=>e.toLowerCase())}function qc(){return He(e=>e.toUpperCase())}function Ic(){return He(e=>Wi(e))}function Cc(e,t,n){return new e({type:"array",element:t,...y(n)})}function Nc(e,t,n){return new e({type:"custom",check:"custom",fn:t,...y(n)})}function Lc(e){const t=Dc(n=>(n.addIssue=r=>{if(typeof r=="string")n.issues.push(kt(r,n.value,t._zod.def));else{const s=r;s.fatal&&(s.continue=!1),s.code??(s.code="custom"),s.input??(s.input=n.value),s.inst??(s.inst=t),s.continue??(s.continue=!t._zod.def.abort),n.issues.push(kt(s))}},e(n.value,n)));return t}function Dc(e,t){const n=new G({check:"custom",...y(t)});return n._zod.check=e,n}function uo(e){let t=e?.target??"draft-2020-12";return t==="draft-4"&&(t="draft-04"),t==="draft-7"&&(t="draft-07"),{processors:e.processors??{},metadataRegistry:e?.metadata??gt,target:t,unrepresentable:e?.unrepresentable??"throw",override:e?.override??(()=>{}),io:e?.io??"output",counter:0,seen:new Map,cycles:e?.cycles??"ref",reused:e?.reused??"inline",external:e?.external??void 0}}function Z(e,t,n={path:[],schemaPath:[]}){var r;const s=e._zod.def,o=t.seen.get(e);if(o)return o.count++,n.schemaPath.includes(e)&&(o.cycle=n.path),o.schema;const i={schema:{},count:1,cycle:void 0,path:n.path};t.seen.set(e,i);const a=e._zod.toJSONSchema?.();if(a)i.schema=a;else{const u={...n,schemaPath:[...n.schemaPath,e],path:n.path};if(e._zod.processJSONSchema)e._zod.processJSONSchema(t,i.schema,u);else{const g=i.schema,f=t.processors[s.type];if(!f)throw new Error(`[toJSONSchema]: Non-representable type encountered: ${s.type}`);f(e,t,g,u)}const d=e._zod.parent;d&&(i.ref||(i.ref=d),Z(d,t,u),t.seen.get(d).isParent=!0)}const l=t.metadataRegistry.get(e);return l&&Object.assign(i.schema,l),t.io==="input"&&U(e)&&(delete i.schema.examples,delete i.schema.default),t.io==="input"&&i.schema._prefault&&((r=i.schema).default??(r.default=i.schema._prefault)),delete i.schema._prefault,t.seen.get(e).schema}function ho(e,t){const n=e.seen.get(t);if(!n)throw new Error("Unprocessed schema. This is a bug in Zod.");const r=new Map;for(const i of e.seen.entries()){const a=e.metadataRegistry.get(i[0])?.id;if(a){const l=r.get(a);if(l&&l!==i[0])throw new Error(`Duplicate schema id "${a}" detected during JSON Schema conversion. Two different schemas cannot share the same id when converted together.`);r.set(a,i[0])}}const s=i=>{const a=e.target==="draft-2020-12"?"$defs":"definitions";if(e.external){const d=e.external.registry.get(i[0])?.id,g=e.external.uri??(_=>_);if(d)return{ref:g(d)};const f=i[1].defId??i[1].schema.id??`schema${e.counter++}`;return i[1].defId=f,{defId:f,ref:`${g("__shared")}#/${a}/${f}`}}if(i[1]===n)return{ref:"#"};const c=`#/${a}/`,u=i[1].schema.id??`__schema${e.counter++}`;return{defId:u,ref:c+u}},o=i=>{if(i[1].schema.$ref)return;const a=i[1],{ref:l,defId:c}=s(i);a.def={...a.schema},c&&(a.defId=c);const u=a.schema;for(const d in u)delete u[d];u.$ref=l};if(e.cycles==="throw")for(const i of e.seen.entries()){const a=i[1];if(a.cycle)throw new Error(`Cycle detected: #/${a.cycle?.join("/")}/<root>

Set the \`cycles\` parameter to \`"ref"\` to resolve cyclical schemas with defs.`)}for(const i of e.seen.entries()){const a=i[1];if(t===i[0]){o(i);continue}if(e.external){const c=e.external.registry.get(i[0])?.id;if(t!==i[0]&&c){o(i);continue}}if(e.metadataRegistry.get(i[0])?.id){o(i);continue}if(a.cycle){o(i);continue}if(a.count>1&&e.reused==="ref"){o(i);continue}}}function po(e,t){const n=e.seen.get(t);if(!n)throw new Error("Unprocessed schema. This is a bug in Zod.");const r=i=>{const a=e.seen.get(i);if(a.ref===null)return;const l=a.def??a.schema,c={...l},u=a.ref;if(a.ref=null,u){r(u);const g=e.seen.get(u),f=g.schema;if(f.$ref&&(e.target==="draft-07"||e.target==="draft-04"||e.target==="openapi-3.0")?(l.allOf=l.allOf??[],l.allOf.push(f)):Object.assign(l,f),Object.assign(l,c),i._zod.parent===u)for(const k in l)k==="$ref"||k==="allOf"||k in c||delete l[k];if(f.$ref)for(const k in l)k==="$ref"||k==="allOf"||k in g.def&&JSON.stringify(l[k])===JSON.stringify(g.def[k])&&delete l[k]}const d=i._zod.parent;if(d&&d!==u){r(d);const g=e.seen.get(d);if(g?.schema.$ref&&(l.$ref=g.schema.$ref,g.def))for(const f in l)f==="$ref"||f==="allOf"||f in g.def&&JSON.stringify(l[f])===JSON.stringify(g.def[f])&&delete l[f]}e.override({zodSchema:i,jsonSchema:l,path:a.path??[]})};for(const i of[...e.seen.entries()].reverse())r(i[0]);const s={};if(e.target==="draft-2020-12"?s.$schema="https://json-schema.org/draft/2020-12/schema":e.target==="draft-07"?s.$schema="http://json-schema.org/draft-07/schema#":e.target==="draft-04"?s.$schema="http://json-schema.org/draft-04/schema#":e.target,e.external?.uri){const i=e.external.registry.get(t)?.id;if(!i)throw new Error("Schema is missing an `id` property");s.$id=e.external.uri(i)}Object.assign(s,n.def??n.schema);const o=e.external?.defs??{};for(const i of e.seen.entries()){const a=i[1];a.def&&a.defId&&(o[a.defId]=a.def)}e.external||Object.keys(o).length>0&&(e.target==="draft-2020-12"?s.$defs=o:s.definitions=o);try{const i=JSON.parse(JSON.stringify(s));return Object.defineProperty(i,"~standard",{value:{...t["~standard"],jsonSchema:{input:an(t,"input",e.processors),output:an(t,"output",e.processors)}},enumerable:!1,writable:!1}),i}catch{throw new Error("Error converting schema to JSON.")}}function U(e,t){const n=t??{seen:new Set};if(n.seen.has(e))return!1;n.seen.add(e);const r=e._zod.def;if(r.type==="transform")return!0;if(r.type==="array")return U(r.element,n);if(r.type==="set")return U(r.valueType,n);if(r.type==="lazy")return U(r.getter(),n);if(r.type==="promise"||r.type==="optional"||r.type==="nonoptional"||r.type==="nullable"||r.type==="readonly"||r.type==="default"||r.type==="prefault")return U(r.innerType,n);if(r.type==="intersection")return U(r.left,n)||U(r.right,n);if(r.type==="record"||r.type==="map")return U(r.keyType,n)||U(r.valueType,n);if(r.type==="pipe")return U(r.in,n)||U(r.out,n);if(r.type==="object"){for(const s in r.shape)if(U(r.shape[s],n))return!0;return!1}if(r.type==="union"){for(const s of r.options)if(U(s,n))return!0;return!1}if(r.type==="tuple"){for(const s of r.items)if(U(s,n))return!0;return!!(r.rest&&U(r.rest,n))}return!1}const Zc=(e,t={})=>n=>{const r=uo({...n,processors:t});return Z(e,r),ho(r,e),po(r,e)},an=(e,t,n={})=>r=>{const{libraryOptions:s,target:o}=r??{},i=uo({...s??{},target:o,io:t,processors:n});return Z(e,i),ho(i,e),po(i,e)},Bc={guid:"uuid",url:"uri",datetime:"date-time",json_string:"json-string",regex:""},jc=(e,t,n,r)=>{const s=n;s.type="string";const{minimum:o,maximum:i,format:a,patterns:l,contentEncoding:c}=e._zod.bag;if(typeof o=="number"&&(s.minLength=o),typeof i=="number"&&(s.maxLength=i),a&&(s.format=Bc[a]??a,s.format===""&&delete s.format,a==="time"&&delete s.format),c&&(s.contentEncoding=c),l&&l.size>0){const u=[...l];u.length===1?s.pattern=u[0].source:u.length>1&&(s.allOf=[...u.map(d=>({...t.target==="draft-07"||t.target==="draft-04"||t.target==="openapi-3.0"?{type:"string"}:{},pattern:d.source}))])}},Fc=(e,t,n,r)=>{const s=n,{minimum:o,maximum:i,format:a,multipleOf:l,exclusiveMaximum:c,exclusiveMinimum:u}=e._zod.bag;typeof a=="string"&&a.includes("int")?s.type="integer":s.type="number",typeof u=="number"&&(t.target==="draft-04"||t.target==="openapi-3.0"?(s.minimum=u,s.exclusiveMinimum=!0):s.exclusiveMinimum=u),typeof o=="number"&&(s.minimum=o,typeof u=="number"&&t.target!=="draft-04"&&(u>=o?delete s.minimum:delete s.exclusiveMinimum)),typeof c=="number"&&(t.target==="draft-04"||t.target==="openapi-3.0"?(s.maximum=c,s.exclusiveMaximum=!0):s.exclusiveMaximum=c),typeof i=="number"&&(s.maximum=i,typeof c=="number"&&t.target!=="draft-04"&&(c<=i?delete s.maximum:delete s.exclusiveMaximum)),typeof l=="number"&&(s.multipleOf=l)},Uc=(e,t,n,r)=>{n.type="boolean"},Wc=(e,t,n,r)=>{n.not={}},Hc=(e,t,n,r)=>{},Yc=(e,t,n,r)=>{const s=e._zod.def,o=Us(s.entries);o.every(i=>typeof i=="number")&&(n.type="number"),o.every(i=>typeof i=="string")&&(n.type="string"),n.enum=o},Jc=(e,t,n,r)=>{if(t.unrepresentable==="throw")throw new Error("Custom types cannot be represented in JSON Schema")},Gc=(e,t,n,r)=>{if(t.unrepresentable==="throw")throw new Error("Transforms cannot be represented in JSON Schema")},Vc=(e,t,n,r)=>{const s=n,o=e._zod.def,{minimum:i,maximum:a}=e._zod.bag;typeof i=="number"&&(s.minItems=i),typeof a=="number"&&(s.maxItems=a),s.type="array",s.items=Z(o.element,t,{...r,path:[...r.path,"items"]})},Xc=(e,t,n,r)=>{const s=n,o=e._zod.def;s.type="object",s.properties={};const i=o.shape;for(const c in i)s.properties[c]=Z(i[c],t,{...r,path:[...r.path,"properties",c]});const a=new Set(Object.keys(i)),l=new Set([...a].filter(c=>{const u=o.shape[c]._zod;return t.io==="input"?u.optin===void 0:u.optout===void 0}));l.size>0&&(s.required=Array.from(l)),o.catchall?._zod.def.type==="never"?s.additionalProperties=!1:o.catchall?o.catchall&&(s.additionalProperties=Z(o.catchall,t,{...r,path:[...r.path,"additionalProperties"]})):t.io==="output"&&(s.additionalProperties=!1)},Kc=(e,t,n,r)=>{const s=e._zod.def,o=s.inclusive===!1,i=s.options.map((a,l)=>Z(a,t,{...r,path:[...r.path,o?"oneOf":"anyOf",l]}));o?n.oneOf=i:n.anyOf=i},Qc=(e,t,n,r)=>{const s=e._zod.def,o=Z(s.left,t,{...r,path:[...r.path,"allOf",0]}),i=Z(s.right,t,{...r,path:[...r.path,"allOf",1]}),a=c=>"allOf"in c&&Object.keys(c).length===1,l=[...a(o)?o.allOf:[o],...a(i)?i.allOf:[i]];n.allOf=l},eu=(e,t,n,r)=>{const s=e._zod.def,o=Z(s.innerType,t,r),i=t.seen.get(e);t.target==="openapi-3.0"?(i.ref=s.innerType,n.nullable=!0):n.anyOf=[o,{type:"null"}]},tu=(e,t,n,r)=>{const s=e._zod.def;Z(s.innerType,t,r);const o=t.seen.get(e);o.ref=s.innerType},nu=(e,t,n,r)=>{const s=e._zod.def;Z(s.innerType,t,r);const o=t.seen.get(e);o.ref=s.innerType,n.default=JSON.parse(JSON.stringify(s.defaultValue))},ru=(e,t,n,r)=>{const s=e._zod.def;Z(s.innerType,t,r);const o=t.seen.get(e);o.ref=s.innerType,t.io==="input"&&(n._prefault=JSON.parse(JSON.stringify(s.defaultValue)))},su=(e,t,n,r)=>{const s=e._zod.def;Z(s.innerType,t,r);const o=t.seen.get(e);o.ref=s.innerType;let i;try{i=s.catchValue(void 0)}catch{throw new Error("Dynamic catch values are not supported in JSON Schema")}n.default=i},ou=(e,t,n,r)=>{const s=e._zod.def,o=t.io==="input"?s.in._zod.def.type==="transform"?s.out:s.in:s.out;Z(o,t,r);const i=t.seen.get(e);i.ref=o},iu=(e,t,n,r)=>{const s=e._zod.def;Z(s.innerType,t,r);const o=t.seen.get(e);o.ref=s.innerType,n.readOnly=!0},fo=(e,t,n,r)=>{const s=e._zod.def;Z(s.innerType,t,r);const o=t.seen.get(e);o.ref=s.innerType},au=p("ZodISODateTime",(e,t)=>{dl.init(e,t),A.init(e,t)});function lu(e){return mc(au,e)}const cu=p("ZodISODate",(e,t)=>{pl.init(e,t),A.init(e,t)});function uu(e){return _c(cu,e)}const hu=p("ZodISOTime",(e,t)=>{fl.init(e,t),A.init(e,t)});function du(e){return yc(hu,e)}const pu=p("ZodISODuration",(e,t)=>{gl.init(e,t),A.init(e,t)});function fu(e){return bc(pu,e)}const gu=(e,t)=>{Gs.init(e,t),e.name="ZodError",Object.defineProperties(e,{format:{value:n=>sa(e,n)},flatten:{value:n=>ra(e,n)},addIssue:{value:n=>{e.issues.push(n),e.message=JSON.stringify(e.issues,jn,2)}},addIssues:{value:n=>{e.issues.push(...n),e.message=JSON.stringify(e.issues,jn,2)}},isEmpty:{get(){return e.issues.length===0}}})},oe=p("ZodError",gu,{Parent:Error}),mu=hr(oe),_u=dr(oe),yu=gn(oe),bu=mn(oe),wu=aa(oe),ku=la(oe),vu=ca(oe),Su=ua(oe),xu=ha(oe),$u=da(oe),Pu=pa(oe),Tu=fa(oe),q=p("ZodType",(e,t)=>(z.init(e,t),Object.assign(e["~standard"],{jsonSchema:{input:an(e,"input"),output:an(e,"output")}}),e.toJSONSchema=Zc(e,{}),e.def=t,e.type=t.type,Object.defineProperty(e,"_def",{value:t}),e.check=(...n)=>e.clone(ve(t,{checks:[...t.checks??[],...n.map(r=>typeof r=="function"?{_zod:{check:r,def:{check:"custom"},onattach:[]}}:r)]}),{parent:!0}),e.with=e.check,e.clone=(n,r)=>Se(e,n,r),e.brand=()=>e,e.register=((n,r)=>(n.add(e,r),e)),e.parse=(n,r)=>mu(e,n,r,{callee:e.parse}),e.safeParse=(n,r)=>yu(e,n,r),e.parseAsync=async(n,r)=>_u(e,n,r,{callee:e.parseAsync}),e.safeParseAsync=async(n,r)=>bu(e,n,r),e.spa=e.safeParseAsync,e.encode=(n,r)=>wu(e,n,r),e.decode=(n,r)=>ku(e,n,r),e.encodeAsync=async(n,r)=>vu(e,n,r),e.decodeAsync=async(n,r)=>Su(e,n,r),e.safeEncode=(n,r)=>xu(e,n,r),e.safeDecode=(n,r)=>$u(e,n,r),e.safeEncodeAsync=async(n,r)=>Pu(e,n,r),e.safeDecodeAsync=async(n,r)=>Tu(e,n,r),e.refine=(n,r)=>e.check(bh(n,r)),e.superRefine=n=>e.check(wh(n)),e.overwrite=n=>e.check(He(n)),e.optional=()=>ns(e),e.exactOptional=()=>ih(e),e.nullable=()=>rs(e),e.nullish=()=>ns(rs(e)),e.nonoptional=n=>dh(e,n),e.array=()=>he(e),e.or=n=>eh([e,n]),e.and=n=>nh(e,n),e.transform=n=>ss(e,sh(n)),e.default=n=>ch(e,n),e.prefault=n=>hh(e,n),e.catch=n=>fh(e,n),e.pipe=n=>ss(e,n),e.readonly=()=>_h(e),e.describe=n=>{const r=e.clone();return gt.add(r,{description:n}),r},Object.defineProperty(e,"description",{get(){return gt.get(e)?.description},configurable:!0}),e.meta=(...n)=>{if(n.length===0)return gt.get(e);const r=e.clone();return gt.add(r,n[0]),r},e.isOptional=()=>e.safeParse(void 0).success,e.isNullable=()=>e.safeParse(null).success,e.apply=n=>n(e),e)),go=p("_ZodString",(e,t)=>{pr.init(e,t),q.init(e,t),e._zod.processJSONSchema=(r,s,o)=>jc(e,r,s);const n=e._zod.bag;e.format=n.format??null,e.minLength=n.minimum??null,e.maxLength=n.maximum??null,e.regex=(...r)=>e.check($c(...r)),e.includes=(...r)=>e.check(Rc(...r)),e.startsWith=(...r)=>e.check(Mc(...r)),e.endsWith=(...r)=>e.check(Ec(...r)),e.min=(...r)=>e.check(on(...r)),e.max=(...r)=>e.check(lo(...r)),e.length=(...r)=>e.check(co(...r)),e.nonempty=(...r)=>e.check(on(1,...r)),e.lowercase=r=>e.check(Pc(r)),e.uppercase=r=>e.check(Tc(r)),e.trim=()=>e.check(Oc()),e.normalize=(...r)=>e.check(Ac(...r)),e.toLowerCase=()=>e.check(zc()),e.toUpperCase=()=>e.check(qc()),e.slugify=()=>e.check(Ic())}),Ru=p("ZodString",(e,t)=>{pr.init(e,t),go.init(e,t),e.email=n=>e.check(Gl(Mu,n)),e.url=n=>e.check(ec(Eu,n)),e.jwt=n=>e.check(gc(Wu,n)),e.emoji=n=>e.check(tc(Au,n)),e.guid=n=>e.check(Gr(Qr,n)),e.uuid=n=>e.check(Vl(It,n)),e.uuidv4=n=>e.check(Xl(It,n)),e.uuidv6=n=>e.check(Kl(It,n)),e.uuidv7=n=>e.check(Ql(It,n)),e.nanoid=n=>e.check(nc(Ou,n)),e.guid=n=>e.check(Gr(Qr,n)),e.cuid=n=>e.check(rc(zu,n)),e.cuid2=n=>e.check(sc(qu,n)),e.ulid=n=>e.check(oc(Iu,n)),e.base64=n=>e.check(dc(ju,n)),e.base64url=n=>e.check(pc(Fu,n)),e.xid=n=>e.check(ic(Cu,n)),e.ksuid=n=>e.check(ac(Nu,n)),e.ipv4=n=>e.check(lc(Lu,n)),e.ipv6=n=>e.check(cc(Du,n)),e.cidrv4=n=>e.check(uc(Zu,n)),e.cidrv6=n=>e.check(hc(Bu,n)),e.e164=n=>e.check(fc(Uu,n)),e.datetime=n=>e.check(lu(n)),e.date=n=>e.check(uu(n)),e.time=n=>e.check(du(n)),e.duration=n=>e.check(fu(n))});function b(e){return Jl(Ru,e)}const A=p("ZodStringFormat",(e,t)=>{R.init(e,t),go.init(e,t)}),Mu=p("ZodEmail",(e,t)=>{rl.init(e,t),A.init(e,t)}),Qr=p("ZodGUID",(e,t)=>{tl.init(e,t),A.init(e,t)}),It=p("ZodUUID",(e,t)=>{nl.init(e,t),A.init(e,t)}),Eu=p("ZodURL",(e,t)=>{sl.init(e,t),A.init(e,t)}),Au=p("ZodEmoji",(e,t)=>{ol.init(e,t),A.init(e,t)}),Ou=p("ZodNanoID",(e,t)=>{il.init(e,t),A.init(e,t)}),zu=p("ZodCUID",(e,t)=>{al.init(e,t),A.init(e,t)}),qu=p("ZodCUID2",(e,t)=>{ll.init(e,t),A.init(e,t)}),Iu=p("ZodULID",(e,t)=>{cl.init(e,t),A.init(e,t)}),Cu=p("ZodXID",(e,t)=>{ul.init(e,t),A.init(e,t)}),Nu=p("ZodKSUID",(e,t)=>{hl.init(e,t),A.init(e,t)}),Lu=p("ZodIPv4",(e,t)=>{ml.init(e,t),A.init(e,t)}),Du=p("ZodIPv6",(e,t)=>{_l.init(e,t),A.init(e,t)}),Zu=p("ZodCIDRv4",(e,t)=>{yl.init(e,t),A.init(e,t)}),Bu=p("ZodCIDRv6",(e,t)=>{bl.init(e,t),A.init(e,t)}),ju=p("ZodBase64",(e,t)=>{wl.init(e,t),A.init(e,t)}),Fu=p("ZodBase64URL",(e,t)=>{vl.init(e,t),A.init(e,t)}),Uu=p("ZodE164",(e,t)=>{Sl.init(e,t),A.init(e,t)}),Wu=p("ZodJWT",(e,t)=>{$l.init(e,t),A.init(e,t)}),mo=p("ZodNumber",(e,t)=>{so.init(e,t),q.init(e,t),e._zod.processJSONSchema=(r,s,o)=>Fc(e,r,s),e.gt=(r,s)=>e.check(Xr(r,s)),e.gte=(r,s)=>e.check(Tn(r,s)),e.min=(r,s)=>e.check(Tn(r,s)),e.lt=(r,s)=>e.check(Vr(r,s)),e.lte=(r,s)=>e.check(Pn(r,s)),e.max=(r,s)=>e.check(Pn(r,s)),e.int=r=>e.check(es(r)),e.safe=r=>e.check(es(r)),e.positive=r=>e.check(Xr(0,r)),e.nonnegative=r=>e.check(Tn(0,r)),e.negative=r=>e.check(Vr(0,r)),e.nonpositive=r=>e.check(Pn(0,r)),e.multipleOf=(r,s)=>e.check(Kr(r,s)),e.step=(r,s)=>e.check(Kr(r,s)),e.finite=()=>e;const n=e._zod.bag;e.minValue=Math.max(n.minimum??Number.NEGATIVE_INFINITY,n.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,e.maxValue=Math.min(n.maximum??Number.POSITIVE_INFINITY,n.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,e.isInt=(n.format??"").includes("int")||Number.isSafeInteger(n.multipleOf??.5),e.isFinite=!0,e.format=n.format??null});function ee(e){return wc(mo,e)}const Hu=p("ZodNumberFormat",(e,t)=>{Pl.init(e,t),mo.init(e,t)});function es(e){return kc(Hu,e)}const Yu=p("ZodBoolean",(e,t)=>{Tl.init(e,t),q.init(e,t),e._zod.processJSONSchema=(n,r,s)=>Uc(e,n,r)});function J(e){return vc(Yu,e)}const Ju=p("ZodUnknown",(e,t)=>{Rl.init(e,t),q.init(e,t),e._zod.processJSONSchema=(n,r,s)=>Hc()});function ts(){return Sc(Ju)}const Gu=p("ZodNever",(e,t)=>{Ml.init(e,t),q.init(e,t),e._zod.processJSONSchema=(n,r,s)=>Wc(e,n,r)});function Vu(e){return xc(Gu,e)}const Xu=p("ZodArray",(e,t)=>{El.init(e,t),q.init(e,t),e._zod.processJSONSchema=(n,r,s)=>Vc(e,n,r,s),e.element=t.element,e.min=(n,r)=>e.check(on(n,r)),e.nonempty=n=>e.check(on(1,n)),e.max=(n,r)=>e.check(lo(n,r)),e.length=(n,r)=>e.check(co(n,r)),e.unwrap=()=>e.element});function he(e,t){return Cc(Xu,e,t)}const Ku=p("ZodObject",(e,t)=>{Ol.init(e,t),q.init(e,t),e._zod.processJSONSchema=(n,r,s)=>Xc(e,n,r,s),$(e,"shape",()=>t.shape),e.keyof=()=>Ye(Object.keys(e._zod.def.shape)),e.catchall=n=>e.clone({...e._zod.def,catchall:n}),e.passthrough=()=>e.clone({...e._zod.def,catchall:ts()}),e.loose=()=>e.clone({...e._zod.def,catchall:ts()}),e.strict=()=>e.clone({...e._zod.def,catchall:Vu()}),e.strip=()=>e.clone({...e._zod.def,catchall:void 0}),e.extend=n=>Ki(e,n),e.safeExtend=n=>Qi(e,n),e.merge=n=>ea(e,n),e.pick=n=>Vi(e,n),e.omit=n=>Xi(e,n),e.partial=(...n)=>ta(_o,e,n[0]),e.required=(...n)=>na(yo,e,n[0])});function se(e,t){const n={type:"object",shape:e??{},...y(t)};return new Ku(n)}const Qu=p("ZodUnion",(e,t)=>{zl.init(e,t),q.init(e,t),e._zod.processJSONSchema=(n,r,s)=>Kc(e,n,r,s),e.options=t.options});function eh(e,t){return new Qu({type:"union",options:e,...y(t)})}const th=p("ZodIntersection",(e,t)=>{ql.init(e,t),q.init(e,t),e._zod.processJSONSchema=(n,r,s)=>Qc(e,n,r,s)});function nh(e,t){return new th({type:"intersection",left:e,right:t})}const Un=p("ZodEnum",(e,t)=>{Il.init(e,t),q.init(e,t),e._zod.processJSONSchema=(r,s,o)=>Yc(e,r,s),e.enum=t.entries,e.options=Object.values(t.entries);const n=new Set(Object.keys(t.entries));e.extract=(r,s)=>{const o={};for(const i of r)if(n.has(i))o[i]=t.entries[i];else throw new Error(`Key ${i} not found in enum`);return new Un({...t,checks:[],...y(s),entries:o})},e.exclude=(r,s)=>{const o={...t.entries};for(const i of r)if(n.has(i))delete o[i];else throw new Error(`Key ${i} not found in enum`);return new Un({...t,checks:[],...y(s),entries:o})}});function Ye(e,t){const n=Array.isArray(e)?Object.fromEntries(e.map(r=>[r,r])):e;return new Un({type:"enum",entries:n,...y(t)})}const rh=p("ZodTransform",(e,t)=>{Cl.init(e,t),q.init(e,t),e._zod.processJSONSchema=(n,r,s)=>Gc(e,n),e._zod.parse=(n,r)=>{if(r.direction==="backward")throw new js(e.constructor.name);n.addIssue=o=>{if(typeof o=="string")n.issues.push(kt(o,n.value,t));else{const i=o;i.fatal&&(i.continue=!1),i.code??(i.code="custom"),i.input??(i.input=n.value),i.inst??(i.inst=e),n.issues.push(kt(i))}};const s=t.transform(n.value,n);return s instanceof Promise?s.then(o=>(n.value=o,n)):(n.value=s,n)}});function sh(e){return new rh({type:"transform",transform:e})}const _o=p("ZodOptional",(e,t)=>{ao.init(e,t),q.init(e,t),e._zod.processJSONSchema=(n,r,s)=>fo(e,n,r,s),e.unwrap=()=>e._zod.def.innerType});function ns(e){return new _o({type:"optional",innerType:e})}const oh=p("ZodExactOptional",(e,t)=>{Nl.init(e,t),q.init(e,t),e._zod.processJSONSchema=(n,r,s)=>fo(e,n,r,s),e.unwrap=()=>e._zod.def.innerType});function ih(e){return new oh({type:"optional",innerType:e})}const ah=p("ZodNullable",(e,t)=>{Ll.init(e,t),q.init(e,t),e._zod.processJSONSchema=(n,r,s)=>eu(e,n,r,s),e.unwrap=()=>e._zod.def.innerType});function rs(e){return new ah({type:"nullable",innerType:e})}const lh=p("ZodDefault",(e,t)=>{Dl.init(e,t),q.init(e,t),e._zod.processJSONSchema=(n,r,s)=>nu(e,n,r,s),e.unwrap=()=>e._zod.def.innerType,e.removeDefault=e.unwrap});function ch(e,t){return new lh({type:"default",innerType:e,get defaultValue(){return typeof t=="function"?t():Hs(t)}})}const uh=p("ZodPrefault",(e,t)=>{Zl.init(e,t),q.init(e,t),e._zod.processJSONSchema=(n,r,s)=>ru(e,n,r,s),e.unwrap=()=>e._zod.def.innerType});function hh(e,t){return new uh({type:"prefault",innerType:e,get defaultValue(){return typeof t=="function"?t():Hs(t)}})}const yo=p("ZodNonOptional",(e,t)=>{Bl.init(e,t),q.init(e,t),e._zod.processJSONSchema=(n,r,s)=>tu(e,n,r,s),e.unwrap=()=>e._zod.def.innerType});function dh(e,t){return new yo({type:"nonoptional",innerType:e,...y(t)})}const ph=p("ZodCatch",(e,t)=>{jl.init(e,t),q.init(e,t),e._zod.processJSONSchema=(n,r,s)=>su(e,n,r,s),e.unwrap=()=>e._zod.def.innerType,e.removeCatch=e.unwrap});function fh(e,t){return new ph({type:"catch",innerType:e,catchValue:typeof t=="function"?t:()=>t})}const gh=p("ZodPipe",(e,t)=>{Fl.init(e,t),q.init(e,t),e._zod.processJSONSchema=(n,r,s)=>ou(e,n,r,s),e.in=t.in,e.out=t.out});function ss(e,t){return new gh({type:"pipe",in:e,out:t})}const mh=p("ZodReadonly",(e,t)=>{Ul.init(e,t),q.init(e,t),e._zod.processJSONSchema=(n,r,s)=>iu(e,n,r,s),e.unwrap=()=>e._zod.def.innerType});function _h(e){return new mh({type:"readonly",innerType:e})}const yh=p("ZodCustom",(e,t)=>{Wl.init(e,t),q.init(e,t),e._zod.processJSONSchema=(n,r,s)=>Jc(e,n)});function bh(e,t={}){return Nc(yh,e,t)}function wh(e){return Lc(e)}const kh=Ye(["critical","warning","info"]),vh=Ye(["double_publishing_admin","pro_admin_overlap","unconfirmed_splits","cowriter_already_registered","distrokid_confusion","no_mlc","no_soundexchange","soundexchange_one_side","multiple_artist_names","dissolved_publishing_entity","songs_by_others_unregistered","estate_inherited","legal_disputes","high_income_no_setup","new_artist","international_no_admin","missing_pro_publisher_share","missing_youtube_content_id","cover_song_download_licensing","producer_points_undocumented","cd_baby_pro_migration_gap","international_audience_no_admin"]),Sh=se({id:vh,severity:kh,title:b(),description:b(),consequence:b(),action:b(),blocksDiy:J()});Sh.extend({triggeredBy:b()});const xh={double_publishing_admin:{severity:"critical",title:"Multiple Publishing Administrators Detected",description:"You have both a current publishing administrator and a previous one that may still be active.",consequence:"Both admins may be registering your songs with PROs, creating conflicting ownership claims. This can freeze your royalties until resolved.",action:"Do NOT register any new songs until this is resolved. Confirm whether your previous admin account is active, and if so, formally close it before proceeding.",blocksDiy:!0},pro_admin_overlap:{severity:"warning",title:"PRO + Publishing Admin Registration Overlap",description:"You registered songs with your PRO yourself, and also have a publishing administrator.",consequence:"Your admin may have re-registered the same works, creating duplicate registrations in the PRO database.",action:"Check your PRO portal for duplicate registrations. If found, work with your admin to consolidate.",blocksDiy:!1},unconfirmed_splits:{severity:"warning",title:"Co-Writer Splits Not Fully Documented",description:"Some or all of your co-written songs don't have signed split sheets.",consequence:"If you and your co-writers register different split percentages, total ownership could exceed 100%, which freezes royalty payments.",action:"Before registering any co-written songs, get signed split sheets from all co-writers. This should be Priority 1.",blocksDiy:!1},cowriter_already_registered:{severity:"warning",title:"Co-Writers May Have Already Registered",description:"Your co-writers may have already registered these songs with their PRO.",consequence:"If their registered splits don't match yours, you'll create a conflict that freezes payments.",action:"Before registering, search Songview (songview.com) for your songs and contact co-writers to verify what splits they registered.",blocksDiy:!1},distrokid_confusion:{severity:"info",title:"DistroKid Publishing Clarification Needed",description:"You use DistroKid and may be unclear about what publishing services they provide.",consequence:"DistroKid does NOT provide publishing administration. Many artists think they're covered when they're not.",action:"Understand that DistroKid only handles distribution and YouTube monetization. You still need separate registrations with PRO, MLC, and SoundExchange.",blocksDiy:!1},no_mlc:{severity:"critical",title:"Missing MLC Registration",description:"You're not registered with The MLC and don't have a publishing administrator to collect mechanical royalties.",consequence:"You're missing ~12-15% of your streaming income. These royalties are accumulating in the MLC's unmatched pool and may be redistributed to others after 3 years.",action:"Register with The MLC immediately. This is free and should be done this week.",blocksDiy:!1},no_soundexchange:{severity:"warning",title:"Missing SoundExchange Registration",description:"You're not registered with SoundExchange to collect digital radio royalties.",consequence:"You're missing royalties from Pandora, SiriusXM, and internet radio. SiriusXM spins are especially valuable (~$35/spin total at 100% ownership).",action:"Register with SoundExchange as BOTH Rights Owner AND Featured Artist to collect your full share.",blocksDiy:!1},soundexchange_one_side:{severity:"warning",title:"SoundExchange - Only Registered One Side",description:"You're registered with SoundExchange, but only as Rights Owner OR Featured Artist, not both.",consequence:"You're only collecting about half of what you're owed. The Rights Owner gets 50% and Featured Artist gets 45%.",action:"Log into SoundExchange and register as the other side to collect your full 95% (the remaining 5% goes to session musician fund).",blocksDiy:!1},multiple_artist_names:{severity:"warning",title:"Multiple Artist Names May Have Fragmented Registrations",description:"You've released music under multiple artist names.",consequence:"Your registrations may be fragmented across different names, and searches may miss parts of your catalog.",action:"Search all royalty databases under each name variation and verify registrations exist for songs under each name.",blocksDiy:!1},dissolved_publishing_entity:{severity:"warning",title:"Previous Publishing Administrator May Be Defunct",description:"Your previous publishing administrator may no longer be in business or has an unclear status.",consequence:"Your songs may still be registered under a defunct entity, and royalties could be going to an inactive account.",action:"Check your PRO account to see who is listed as publisher. If it's the old entity, you may need to file for rights reversion.",blocksDiy:!1},songs_by_others_unregistered:{severity:"warning",title:"Songs Recorded by Other Artists May Not Credit You",description:"Other artists have recorded your songs, but you may not be registered as the songwriter on those releases.",consequence:"You're not collecting songwriter royalties on those recordings, which could be significant if those artists have success.",action:"Identify all songs recorded by other artists and verify you're registered as songwriter on each. Contact those artists' teams to confirm.",blocksDiy:!1},estate_inherited:{severity:"critical",title:"Estate/Inherited Catalog Requires Special Handling",description:"You're managing music for someone else or an inherited catalog.",consequence:"Estate situations require legal authority (estate documents, power of attorney) before any changes can be made. Making registrations without proper authority could create legal problems.",action:"Do not proceed with any registrations until legal authority is established. This requires professional consultation.",blocksDiy:!0},legal_disputes:{severity:"critical",title:"Legal Disputes or Contested Ownership",description:"There are legal disputes or contested ownership issues with your songs.",consequence:"Registering songs during a dispute could complicate legal proceedings and potentially harm your case.",action:"Do not make any registrations until the dispute is resolved. Consult with an entertainment attorney.",blocksDiy:!0},high_income_no_setup:{severity:"warning",title:"High Income Without Complete Registration Setup",description:"You're earning $3,000+/month but missing multiple royalty registrations.",consequence:"At your income level, missing registrations could mean thousands of dollars lost annually.",action:"Given the amounts at stake, we strongly recommend completing all registrations immediately or using our Done-For-You service to ensure nothing is missed.",blocksDiy:!1},new_artist:{severity:"info",title:"New Artist - Get Set Up Right From the Start",description:"You're relatively new to releasing music with a small catalog and modest income.",consequence:"This is actually good news - you can get everything set up correctly from the beginning rather than fixing problems later.",action:"Follow the basic setup checklist to ensure you're collecting from all royalty streams as you grow.",blocksDiy:!1},international_no_admin:{severity:"warning",title:"Significant International Audience Without Publishing Admin",description:"You have significant audience outside the US but no publishing administrator for international collection.",consequence:"The MLC only collects US mechanical royalties. Your international streaming royalties may be going uncollected.",action:"Consider a publishing administrator (Songtrust, Sentric, TuneCore Publishing) to collect international royalties, or register directly with foreign collection societies.",blocksDiy:!1},missing_pro_publisher_share:{severity:"critical",title:"Missing 50% of PRO Income - No Publishing Entity",description:"You're registered with a PRO but haven't created a publishing entity to collect the publisher share of your performance royalties.",consequence:"Performance royalties are split 50/50 between Writer and Publisher. Without a publishing entity, you're only collecting the Writer half - missing 50% of your PRO income!",action:"Create a publishing entity with your PRO immediately. This is FREE and takes about 15 minutes. At ASCAP: Go to Member Access → Create a Publisher. At BMI: Apply for publisher affiliation.",blocksDiy:!1},missing_youtube_content_id:{severity:"warning",title:"Potentially Missing YouTube Content ID Revenue",description:"Your distributor may not include YouTube Content ID, meaning you're not collecting revenue from others using your music in their videos.",consequence:"User-generated content using your music generates ad revenue you could be collecting.",action:"Verify your distributor includes YouTube Content ID. If not, upgrade to a tier that includes it or use a separate Content ID administrator.",blocksDiy:!1},cover_song_download_licensing:{severity:"info",title:"Cover Song Download Licensing Reminder",description:"You've released cover songs that are available for download.",consequence:"While streaming is covered by the MLC blanket license, paid downloads still require mechanical licenses.",action:"Verify mechanical licenses were obtained for cover songs on download platforms. Most distributors handle this for a fee - check that it was included.",blocksDiy:!1},producer_points_undocumented:{severity:"warning",title:"Producer Agreements May Need Documentation",description:"You've worked with outside producers without clear written agreements on royalty splits.",consequence:"Unclear producer agreements can lead to disputes later about what percentage they're owed.",action:"Document producer agreements in writing. If producer has royalty points, file a Letter of Direction with SoundExchange.",blocksDiy:!1},cd_baby_pro_migration_gap:{severity:"warning",title:"CD Baby Pro Publishing Discontinuation",description:"You previously used CD Baby Pro Publishing, which was discontinued in 2023.",consequence:"If you weren't properly migrated or didn't set up an alternative, you may have a gap in royalty collection.",action:"Verify your songs are still registered somewhere for publishing collection. You may need to register with The MLC directly and/or get a new publishing admin.",blocksDiy:!1},international_audience_no_admin:{severity:"warning",title:"International Audience Without Publishing Admin",description:"You report 30%+ of your audience is outside the US but have no publishing administrator.",consequence:"The MLC only collects US mechanical royalties. International mechanical royalties are going uncollected.",action:"Consider a publishing administrator for international collection, or register directly with foreign societies.",blocksDiy:!1}};function $h(e){const{intake:t,followUps:n}=e,r=[],s=(o,i)=>{const a=xh[o];r.push({id:o,...a,triggeredBy:i})};if(t.q10_publishing_admin!=="none"&&t.q10_publishing_admin!=="not_sure"&&t.q10_publishing_admin!=="distrokid"&&t.q11_previous_admin==="yes"&&n.f2_admin_cancelled!=="yes_cancelled"&&s("double_publishing_admin",`Current admin (${t.q10_publishing_admin}) and previous admin may both be active`),t.q9_mlc!=="yes"&&(t.q10_publishing_admin==="none"||t.q10_publishing_admin==="not_sure"||t.q10_publishing_admin==="distrokid")&&t.q3_time_releasing!=="less_than_6_months"&&s("no_mlc","No MLC registration and no publishing admin to collect mechanicals"),(t.q15_managing_for==="managing_for_other"||t.q15_managing_for==="inherited_catalog")&&s("estate_inherited",`Managing for ${t.q15_managing_for==="inherited_catalog"?"inherited catalog":"someone else"}`),(t.q16_disputes==="yes"||t.q16_disputes==="possibly")&&s("legal_disputes",`Disputes status: ${t.q16_disputes}`),t.q7_pro!=="none"&&t.q7_pro!=="not_sure"&&(t.q10_publishing_admin==="none"||t.q10_publishing_admin==="not_sure"||t.q10_publishing_admin==="distrokid")&&n.f17_pro_publishing_entity!=="yes_have_publishing_entity"&&s("missing_pro_publisher_share","Has PRO but no publishing entity - missing 50% of performance royalties"),t.q7_pro!=="none"&&t.q7_pro!=="not_sure"&&t.q10_publishing_admin!=="none"&&t.q10_publishing_admin!=="not_sure"&&t.q10_publishing_admin!=="distrokid"&&(n.f3_pro_registration_order==="i_registered_first"||n.f3_pro_registration_order==="both_or_not_sure")&&s("pro_admin_overlap","Registered with PRO before/alongside publishing admin - possible duplicates"),t.q12_has_cowriters==="yes"&&(n.f5_split_sheets_status==="no"||n.f5_split_sheets_status==="yes_some"||n.f5_split_sheets_status==="whats_a_split_sheet")&&s("unconfirmed_splits",`Split sheets status: ${n.f5_split_sheets_status||"not documented"}`),t.q12_has_cowriters==="yes"&&(n.f6_cowriter_registered==="yes_they_registered"||n.f6_cowriter_registered==="not_sure"||n.f6_cowriter_registered==="some_have_some_havent")&&s("cowriter_already_registered","Co-writers may have already registered - need to verify splits match"),t.q8_soundexchange!=="yes"&&s("no_soundexchange","Not registered with SoundExchange for digital radio royalties"),t.q8_soundexchange==="yes"&&(n.f18_soundexchange_registration_type==="rights_owner_only"||n.f18_soundexchange_registration_type==="featured_artist_only"||n.f18_soundexchange_registration_type==="not_sure")&&s("soundexchange_one_side",`Only registered as ${n.f18_soundexchange_registration_type} - missing ~half of SE royalties`),t.q13_changed_names==="yes"){const o=n.f7_previous_names?.split(",").length||1;o>=2&&s("multiple_artist_names",`${o+1} total artist names - registrations may be fragmented`)}return t.q11_previous_admin==="yes"&&(n.f11_previous_admin_status==="closed"||n.f11_previous_admin_status==="not_sure"||n.f11_previous_admin_status==="acquired")&&s("dissolved_publishing_entity",`Previous admin status: ${n.f11_previous_admin_status}`),t.q14_songs_by_others==="yes"&&(n.f10_registered_on_others==="no"||n.f10_registered_on_others==="not_sure"||n.f10_registered_on_others==="yes_some")&&s("songs_by_others_unregistered","Songs recorded by other artists may not credit you as songwriter"),(t.q6_monthly_income==="3000_to_10000"||t.q6_monthly_income==="10000_plus")&&(t.q7_pro==="none"||t.q9_mlc!=="yes"||t.q8_soundexchange!=="yes")&&s("high_income_no_setup","High income ($3k+/month) with missing registrations"),(n.f16_audience_location==="mostly_outside_us"||n.f16_audience_location==="mix")&&(t.q10_publishing_admin==="none"||t.q10_publishing_admin==="not_sure"||t.q10_publishing_admin==="distrokid")&&s("international_no_admin","Significant international audience but no publishing admin for global collection"),n.f1_previous_admins?.includes("cd_baby_pro")&&n.f11_previous_admin_status!=="still_active"&&s("cd_baby_pro_migration_gap","Previously used CD Baby Pro Publishing (discontinued 2023) - may have collection gap"),t.q5_distributor==="distrokid"&&(t.q10_publishing_admin==="none"||t.q10_publishing_admin==="distrokid")&&s("distrokid_confusion","Uses DistroKid and may think it covers publishing admin"),t.q3_time_releasing==="less_than_6_months"&&t.q4_catalog_size==="1_to_10"&&t.q6_monthly_income==="0_to_100"&&s("new_artist","New artist with small catalog - can set up correctly from the start"),r}function Ph(e){return e.some(t=>t.severity==="critical"&&t.blocksDiy)}const Le=se({monthly:ee(),totalLow:ee(),totalHigh:ee(),monthsMissed:ee(),applicable:J(),note:b().optional()}),Th=se({mlc:Le,soundexchange:Le,soundexchangeMissingSide:Le,pro:Le,proPublisherShare:Le,songsByOthers:Le,total:se({monthlyGap:ee(),totalLow:ee(),totalHigh:ee()})}),bo=Ye(["Excellent","Good","Fair","Poor","Critical"]),wo=Ye(["Simple","Moderate","Complex"]),ko=Ye(["DIY","DIY or Done-For-You","Done-For-You Recommended","Consultation Required"]);se({estimates:Th,score:ee().min(0).max(10),scoreLabel:bo,complexity:wo,complexityPoints:ee(),recommendation:ko,diyTimeHoursLow:ee(),diyTimeHoursHigh:ee(),blockDiy:J()});const Rh={"0_to_100":50,"100_to_500":300,"500_to_1000":750,"1000_to_3000":2e3,"3000_to_10000":6500,"10000_plus":12e3},Mh={"1_to_10":5,"11_to_25":18,"26_to_50":38,"51_to_100":75,"100_plus":120},Eh={"1_to_5":3,"6_to_15":10,"16_to_30":23,most_or_all:.8},Ah={"1_to_3":2,"4_to_10":7,"10_plus":15},Oh={unknown:1},Pe={joinPro:20,registerWorksPerSong:5,joinMlc:30,registerMlcPerSong:3,joinSoundexchange:20,documentSplitsPerSong:15,createPublishingEntity:15};function zh(e){return{less_than_6_months:3,"6_months_to_2_years":15,"2_to_5_years":42,"5_to_10_years":90,"10_plus_years":144}[e]||12}function qh(){const e=new Date("2021-01-01"),t=new Date;return(t.getFullYear()-e.getFullYear())*12+(t.getMonth()-e.getMonth())}function Ih(e,t){const{intake:n,followUps:r}=e,s=Rh[n.q6_monthly_income]||300,o=Mh[n.q4_catalog_size]||10,i=zh(n.q3_time_releasing),a=qh(),l=Oh.unknown,c=n.q9_mlc!=="yes"&&(n.q10_publishing_admin==="none"||n.q10_publishing_admin==="not_sure"||n.q10_publishing_admin==="distrokid"),u=s*.12,d=Math.min(i,a),g=u*d,f={monthly:c?Math.round(u):0,totalLow:c?Math.round(g*.7):0,totalHigh:c?Math.round(g*1.3):0,monthsMissed:c?d:0,applicable:c},_=n.q8_soundexchange!=="yes",k=s*.03*l,M=Math.min(i,60),L=k*M,I={monthly:_?Math.round(k):0,totalLow:_?Math.round(L*.5):0,totalHigh:_?Math.round(L*1.5):0,monthsMissed:_?M:0,applicable:_},O=n.q8_soundexchange==="yes"&&(r.f18_soundexchange_registration_type==="rights_owner_only"||r.f18_soundexchange_registration_type==="featured_artist_only"||r.f18_soundexchange_registration_type==="not_sure"),T=s*.03*l*.5,E=Math.min(i,60),Rt=T*E,ie={monthly:O?Math.round(T):0,totalLow:O?Math.round(Rt*.5):0,totalHigh:O?Math.round(Rt*1.5):0,monthsMissed:O?E:0,applicable:O,note:"Only applies if registered but only on one side"},Ne=n.q7_pro==="none"||n.q7_pro==="not_sure",xn=s*.04,kr=Math.min(i,60),vr=xn*kr,Mt={monthly:Ne?Math.round(xn):0,totalLow:Ne?Math.round(vr*.5):0,totalHigh:Ne?Math.round(vr*2):0,monthsMissed:Ne?kr:0,applicable:Ne},xe=n.q7_pro!=="none"&&n.q7_pro!=="not_sure"&&(n.q10_publishing_admin==="none"||n.q10_publishing_admin==="not_sure"||n.q10_publishing_admin==="distrokid")&&r.f17_pro_publishing_entity!=="yes_have_publishing_entity",Sr=xn,xr=Math.min(i,60),$r=Sr*xr,Et={monthly:xe?Math.round(Sr):0,totalLow:xe?Math.round($r*.5):0,totalHigh:xe?Math.round($r*2):0,monthsMissed:xe?xr:0,applicable:xe,note:"Only applies if PRO member but no publishing entity"},Ge=n.q14_songs_by_others==="yes"&&(r.f10_registered_on_others==="no"||r.f10_registered_on_others==="not_sure"||r.f10_registered_on_others==="yes_some"),Pr=(Ah[r.f9_songs_by_others_count||"1_to_3"]||2)*25,Tr=24,Rr=Pr*Tr,At={monthly:Ge?Math.round(Pr):0,totalLow:Ge?Math.round(Rr*.3):0,totalHigh:Ge?Math.round(Rr*3):0,monthsMissed:Ge?Tr:0,applicable:Ge},ri={mlc:f,soundexchange:I,soundexchangeMissingSide:ie,pro:Mt,proPublisherShare:Et,songsByOthers:At,total:{monthlyGap:f.monthly+I.monthly+ie.monthly+Mt.monthly+Et.monthly+At.monthly,totalLow:f.totalLow+I.totalLow+ie.totalLow+Mt.totalLow+Et.totalLow+At.totalLow,totalHigh:f.totalHigh+I.totalHigh+ie.totalHigh+Mt.totalHigh+Et.totalHigh+At.totalHigh}};let V=0;n.q5_distributor!=="none"&&(V+=2),n.q7_pro!=="none"&&n.q7_pro!=="not_sure"&&(V+=2,V+=1),(n.q9_mlc==="yes"||n.q10_publishing_admin!=="none"&&n.q10_publishing_admin!=="not_sure"&&n.q10_publishing_admin!=="distrokid")&&(V+=2),n.q8_soundexchange==="yes"&&(V+=2),t.some(ye=>ye.severity==="critical"&&ye.id!=="estate_inherited"&&ye.id!=="legal_disputes")||(V+=1),V=Math.min(10,Math.max(0,V));const si=V>=9?"Excellent":V>=7?"Good":V>=5?"Fair":V>=3?"Poor":"Critical";let F=0;(n.q4_catalog_size==="51_to_100"||n.q4_catalog_size==="100_plus")&&(F+=1),n.q4_catalog_size==="100_plus"&&(F+=1),n.q12_has_cowriters==="yes"&&(F+=1,(r.f4_cowriter_count==="16_to_30"||r.f4_cowriter_count==="most_or_all")&&(F+=1),(r.f5_split_sheets_status==="no"||r.f5_split_sheets_status==="whats_a_split_sheet")&&(F+=1)),n.q13_changed_names==="yes"&&(F+=1,(r.f7_previous_names?.split(",").length||0)+1>2&&(F+=1)),n.q11_previous_admin==="yes"&&(F+=1,(r.f2_admin_cancelled!=="yes_cancelled"||r.f11_previous_admin_status==="not_sure")&&(F+=2)),n.q14_songs_by_others==="yes"&&(F+=1),(n.q6_monthly_income==="3000_to_10000"||n.q6_monthly_income==="10000_plus")&&(F+=1);const Mr=t.some(ye=>ye.blocksDiy);Mr&&(F+=5);const $n=F>=5?"Complex":F>=2?"Moderate":"Simple";let Ve,Er=!1;Mr?(Ve="Consultation Required",Er=!0):$n==="Complex"||n.q6_monthly_income==="10000_plus"?Ve="Done-For-You Recommended":$n==="Moderate"?Ve="DIY or Done-For-You":Ve="DIY";let $e=0;if((Ne||xe)&&($e+=Pe.joinPro+o*Pe.registerWorksPerSong),xe&&($e+=Pe.createPublishingEntity),c&&($e+=Pe.joinMlc+o*Pe.registerMlcPerSong),(_||O)&&($e+=Pe.joinSoundexchange),n.q12_has_cowriters==="yes"){const ye=r.f4_cowriter_count==="most_or_all"?Math.round(o*.8):Eh[r.f4_cowriter_count||"1_to_5"]||3;$e+=ye*Pe.documentSplitsPerSong}const oi=Math.round($e/60*.8),ii=Math.round($e/60*1.2);return{estimates:ri,score:V,scoreLabel:si,complexity:$n,complexityPoints:F,recommendation:Ve,diyTimeHoursLow:Math.max(1,oi),diyTimeHoursHigh:Math.max(2,ii),blockDiy:Er}}function re(e){return`$${e.toLocaleString()}`}function Te(e,t){return`${re(e)} - ${re(t)}`}const Ch=[{id:"f1_previous_admins",question:"Which publishing administrator(s) did you use before?",type:"multi-select",required:!0,options:[{value:"songtrust",label:"Songtrust"},{value:"cd_baby_pro",label:"CD Baby Pro"},{value:"tunecore_publishing",label:"TuneCore Publishing"},{value:"sentric",label:"Sentric"},{value:"other",label:"Other"}],triggeredBy:e=>e.q11_previous_admin==="yes"},{id:"f2_admin_cancelled",question:"Did you formally cancel or close that account?",type:"single-select",required:!0,options:[{value:"yes_cancelled",label:"Yes, I cancelled it"},{value:"no_might_be_active",label:"No, it might still be active"},{value:"not_sure",label:"Not sure"}],triggeredBy:e=>e.q11_previous_admin==="yes"},{id:"f3_pro_registration_order",question:"Did you register your songs with your PRO yourself, or did your publishing admin do it?",type:"single-select",required:!0,options:[{value:"i_registered_first",label:"I registered them myself first"},{value:"admin_registered",label:"My publishing admin registered them"},{value:"both_or_not_sure",label:"Both / Not sure"}],triggeredBy:e=>e.q7_pro!=="none"&&e.q7_pro!=="not_sure"&&e.q10_publishing_admin!=="none"&&e.q10_publishing_admin!=="not_sure"&&e.q10_publishing_admin!=="distrokid"},{id:"f4_cowriter_count",question:"Approximately how many of your songs have co-writers?",type:"single-select",required:!0,options:[{value:"1_to_5",label:"1-5 songs"},{value:"6_to_15",label:"6-15 songs"},{value:"16_to_30",label:"16-30 songs"},{value:"most_or_all",label:"Most or all of my songs"}],triggeredBy:e=>e.q12_has_cowriters==="yes"},{id:"f5_split_sheets_status",question:"Do you have signed split sheets documenting ownership percentages for co-written songs?",type:"single-select",required:!0,options:[{value:"yes_all",label:"Yes, for all of them"},{value:"yes_some",label:"Yes, for some of them"},{value:"no",label:"No"},{value:"whats_a_split_sheet",label:"What's a split sheet?"}],triggeredBy:e=>e.q12_has_cowriters==="yes"},{id:"f6_cowriter_registered",question:"Do you know if your co-writers have registered these songs with their PRO?",type:"single-select",required:!0,options:[{value:"yes_they_registered",label:"Yes, they have registered"},{value:"no_they_havent",label:"No, they haven't"},{value:"not_sure",label:"Not sure"},{value:"some_have_some_havent",label:"Some have, some haven't"}],triggeredBy:e=>e.q12_has_cowriters==="yes"},{id:"f7_previous_names",question:"What were your previous artist names?",type:"text",required:!0,placeholder:"List all previous names, separated by commas",triggeredBy:e=>e.q13_changed_names==="yes"},{id:"f8_songs_per_name",question:"Approximately how many songs were released under each previous name?",type:"text",required:!1,placeholder:"e.g., 'Old Name 1: 15 songs, Old Name 2: 8 songs'",triggeredBy:e=>e.q13_changed_names==="yes"},{id:"f9_songs_by_others_count",question:"Approximately how many of your songs have been recorded by other artists?",type:"single-select",required:!0,options:[{value:"1_to_3",label:"1-3 songs"},{value:"4_to_10",label:"4-10 songs"},{value:"10_plus",label:"10+ songs"}],triggeredBy:e=>e.q14_songs_by_others==="yes"},{id:"f10_registered_on_others",question:"Are you registered as the songwriter on those releases?",type:"single-select",required:!0,options:[{value:"yes_all",label:"Yes, I'm registered on all of them"},{value:"yes_some",label:"Yes, on some of them"},{value:"no",label:"No"},{value:"not_sure",label:"Not sure"}],triggeredBy:e=>e.q14_songs_by_others==="yes"},{id:"f11_previous_admin_status",question:"Is the publishing company you previously used still in business?",type:"single-select",required:!0,options:[{value:"still_active",label:"Yes, they're still active"},{value:"closed",label:"No, they closed/went out of business"},{value:"not_sure",label:"Not sure"},{value:"acquired",label:"They were acquired by another company"}],triggeredBy:e=>e.q11_previous_admin==="yes"},{id:"f12_relationship",question:"What is your relationship to the original artist/songwriter?",type:"single-select",required:!0,options:[{value:"family",label:"Family member (child, spouse, sibling)"},{value:"designated_rep",label:"Designated representative"},{value:"business_partner",label:"Business partner"},{value:"other",label:"Other"}],triggeredBy:e=>e.q15_managing_for==="managing_for_other"||e.q15_managing_for==="inherited_catalog"},{id:"f13_deceased",question:"Is the original artist/songwriter deceased?",type:"single-select",required:!0,options:[{value:"yes",label:"Yes"},{value:"no",label:"No"},{value:"prefer_not_to_say",label:"Prefer not to say"}],triggeredBy:e=>e.q15_managing_for==="managing_for_other"||e.q15_managing_for==="inherited_catalog"},{id:"f14_legal_authority",question:"Do you have legal authority (estate documents, power of attorney) to manage this catalog?",type:"single-select",required:!0,options:[{value:"yes_have_docs",label:"Yes, I have documentation"},{value:"in_progress",label:"In progress"},{value:"no",label:"No"},{value:"not_sure_whats_needed",label:"Not sure what's needed"}],triggeredBy:e=>e.q15_managing_for==="managing_for_other"||e.q15_managing_for==="inherited_catalog"},{id:"f15_dispute_description",question:"Can you briefly describe the dispute or ownership question?",type:"text",required:!1,placeholder:"Brief description - this helps us understand if DIY is appropriate",triggeredBy:e=>e.q16_disputes==="yes"||e.q16_disputes==="possibly"},{id:"f16_audience_location",question:"Where is most of your audience located?",type:"single-select",required:!1,options:[{value:"mostly_us",label:"Mostly US"},{value:"mostly_outside_us",label:"Mostly outside US"},{value:"mix",label:"Mix of US and international"},{value:"not_sure",label:"Not sure"}],triggeredBy:()=>!0},{id:"f17_pro_publishing_entity",question:"Have you set up a publishing entity with your PRO?",type:"single-select",required:!0,helpText:"This is different from being a member. A publishing entity lets you collect both the writer AND publisher share of your royalties.",options:[{value:"yes_have_publishing_entity",label:"Yes, I have a publishing entity"},{value:"no_only_writer",label:"No, I'm only registered as a writer"},{value:"whats_a_publishing_entity",label:"What's a publishing entity?"},{value:"not_sure",label:"Not sure"}],triggeredBy:e=>e.q7_pro!=="none"&&e.q7_pro!=="not_sure"&&(e.q10_publishing_admin==="none"||e.q10_publishing_admin==="not_sure"||e.q10_publishing_admin==="distrokid")},{id:"f18_soundexchange_registration_type",question:"When you registered with SoundExchange, did you register as:",type:"single-select",required:!0,helpText:"SoundExchange has two sides: Rights Owner (who owns the master) and Featured Artist (who performed). Most indie artists need both.",options:[{value:"both_rights_owner_and_featured_artist",label:"Both Rights Owner AND Featured Artist"},{value:"rights_owner_only",label:"Rights Owner only"},{value:"featured_artist_only",label:"Featured Artist only"},{value:"not_sure",label:"Not sure"}],triggeredBy:e=>e.q8_soundexchange==="yes"}];function Nh(e){return Ch.filter(t=>t.triggeredBy(e))}function Lh(e,t={}){const n={intake:e,followUps:t},r=e.q7_pro!=="none"&&e.q7_pro!=="not_sure",s=e.q10_publishing_admin!=="none"&&e.q10_publishing_admin!=="not_sure"&&e.q10_publishing_admin!=="distrokid",o={hasDistributor:e.q5_distributor!=="none",distributor:e.q5_distributor!=="none"?e.q5_distributor:null,hasPro:r,proName:r?e.q7_pro:null,hasMlc:e.q9_mlc==="yes",mlcCoveredByAdmin:s,hasSoundexchange:e.q8_soundexchange==="yes",soundexchangeBothSides:e.q8_soundexchange==="yes"?t.f18_soundexchange_registration_type==="both_rights_owner_and_featured_artist":null,soundexchangeOneSide:e.q8_soundexchange==="yes"?t.f18_soundexchange_registration_type==="rights_owner_only"||t.f18_soundexchange_registration_type==="featured_artist_only":null,soundexchangeRegisteredAs:e.q8_soundexchange==="yes"&&t.f18_soundexchange_registration_type||null,hasPublishingAdmin:s,publishingAdmin:s?e.q10_publishing_admin:null,hasPreviousAdmin:e.q11_previous_admin==="yes",previousAdminCancelled:e.q11_previous_admin==="yes"?t.f2_admin_cancelled==="yes_cancelled":null,hasProPublishingEntity:r&&!s?t.f17_pro_publishing_entity==="yes_have_publishing_entity":null},i={hasCowriters:e.q12_has_cowriters==="yes",cowriterCount:e.q12_has_cowriters==="yes"&&t.f4_cowriter_count||null,splitSheetsStatus:e.q12_has_cowriters==="yes"&&t.f5_split_sheets_status||null,nameChanges:e.q13_changed_names==="yes",previousNames:e.q13_changed_names==="yes"&&t.f7_previous_names||null,songsByOthers:e.q14_songs_by_others==="yes",managingForOther:e.q15_managing_for==="managing_for_other",inheritedCatalog:e.q15_managing_for==="inherited_catalog",disputes:e.q16_disputes==="yes"?t.f15_dispute_description||!0:e.q16_disputes==="possibly"?"possibly":!1},a=$h(n),l=Ph(a),c=Nh(e),u=c.every(g=>{const f=g.id;return t[f]!==void 0}),d=Ih(n,a);return{intake:e,followUps:t,registrations:o,complexityFactors:i,gotchasDetected:a,hasCriticalGotcha:l,followUpsNeeded:c,followUpsAnswered:u,calculations:d,timestamp:new Date().toISOString()}}function ln(e){return e?{distrokid:"DistroKid",tunecore:"TuneCore",cd_baby:"CD Baby",awal:"AWAL",ditto:"Ditto",unitedmasters:"UnitedMasters",other:"Other",none:"None"}[e]||e:"None"}function os(e){return e?{ascap:"ASCAP",bmi:"BMI",sesac:"SESAC",gmr:"GMR",none:"None",not_sure:"Not sure"}[e]||e:"None"}function is(e){return e?{songtrust:"Songtrust",cd_baby_pro:"CD Baby Pro",tunecore_publishing:"TuneCore Publishing",sentric:"Sentric",distrokid:"DistroKid (not actually publishing admin)",other:"Other",none:"None",not_sure:"Not sure"}[e]||e:"None"}function Dh(e){return{"0_to_100":"$0-100","100_to_500":"$100-500","500_to_1000":"$500-1,000","1000_to_3000":"$1,000-3,000","3000_to_10000":"$3,000-10,000","10000_plus":"$10,000+"}[e]||e}function Zh(e){return{less_than_6_months:"Less than 6 months","6_months_to_2_years":"6 months to 2 years","2_to_5_years":"2-5 years","5_to_10_years":"5-10 years","10_plus_years":"10+ years"}[e]||e}function Bh(e){return{"1_to_10":"1-10 songs","11_to_25":"11-25 songs","26_to_50":"26-50 songs","51_to_100":"51-100 songs","100_plus":"100+ songs"}[e]||e}const jh=["f1_previous_admins","f2_admin_cancelled","f5_split_sheets_status","f14_legal_authority","f17_pro_publishing_entity","f18_soundexchange_registration_type"],Fh=["f3_pro_registration_order","f6_cowriter_registered","f10_registered_on_others","f11_previous_admin_status","f12_relationship","f13_deceased"],Uh={f1_previous_admins:"Need to check for potential conflicts with your current publishing setup",f2_admin_cancelled:"Important to know if there might be overlapping registrations",f3_pro_registration_order:"Helps us check for duplicate registrations in your PRO",f4_cowriter_count:"Helps us estimate the complexity of your catalog",f5_split_sheets_status:"Critical for avoiding frozen royalties from conflicting claims",f6_cowriter_registered:"Need to verify no conflicting registrations exist",f7_previous_names:"So we can check all databases for your music",f8_songs_per_name:"Helps understand your catalog distribution",f9_songs_by_others_count:"To estimate potential uncollected songwriter royalties",f10_registered_on_others:"Important for ensuring you're collecting what you're owed",f11_previous_admin_status:"Need to know if your previous admin might still have active registrations",f12_relationship:"Required for estate/inherited catalog situations",f13_deceased:"Affects the legal requirements for managing the catalog",f14_legal_authority:"Critical for determining if registrations can proceed",f15_dispute_description:"Helps us understand if DIY is appropriate",f16_audience_location:"Helps us advise on international royalty collection",f17_pro_publishing_entity:"You might be missing 50% of your performance royalties",f18_soundexchange_registration_type:"You might be missing half of your SoundExchange royalties"};function fr(e){const{followUpsNeeded:t,followUps:n}=e,s=t.filter(c=>{const u=c.id;return n[u]===void 0}).map(c=>({id:c.id,question:c.question,type:c.type,options:c.options,required:c.required,helpText:c.helpText,placeholder:c.placeholder,priority:Wh(c.id),reason:Uh[c.id]||"Additional context for your report"})),o=s.filter(c=>c.priority==="must_ask"),i=s.filter(c=>c.priority==="should_ask"),a=s.filter(c=>c.priority==="nice_to_have"),l=[...o,...i,...a].slice(0,8);return{questions:l,mustAsk:o,shouldAsk:i,niceToHave:a,totalQuestions:l.length,allAnswered:l.length===0}}function Wh(e){return jh.includes(e)?"must_ask":Fh.includes(e)?"should_ask":"nice_to_have"}function Hh(e){return fr(e).mustAsk.length===0}function Yh(e){const t=fr(e);return t.mustAsk.length>0?"We're missing important information that could significantly affect your report. Please answer the follow-up questions to get accurate recommendations.":t.shouldAsk.length>0?"Some additional information would help us give you more accurate recommendations. Your report will include caveats where information is incomplete.":null}function m(e,t,n,r,s){if(typeof t=="function"?e!==t||!0:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return t.set(e,n),n}function h(e,t,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(e):r?r.value:t.get(e)}let vo=function(){const{crypto:e}=globalThis;if(e?.randomUUID)return vo=e.randomUUID.bind(e),e.randomUUID();const t=new Uint8Array(1),n=e?()=>e.getRandomValues(t)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,r=>(+r^n()&15>>+r/4).toString(16))};function vt(e){return typeof e=="object"&&e!==null&&("name"in e&&e.name==="AbortError"||"message"in e&&String(e.message).includes("FetchRequestCanceledException"))}const Wn=e=>{if(e instanceof Error)return e;if(typeof e=="object"&&e!==null){try{if(Object.prototype.toString.call(e)==="[object Error]"){const t=new Error(e.message,e.cause?{cause:e.cause}:{});return e.stack&&(t.stack=e.stack),e.cause&&!t.cause&&(t.cause=e.cause),e.name&&(t.name=e.name),t}}catch{}try{return new Error(JSON.stringify(e))}catch{}}return new Error(e)};class w extends Error{}class j extends w{constructor(t,n,r,s){super(`${j.makeMessage(t,n,r)}`),this.status=t,this.headers=s,this.requestID=s?.get("request-id"),this.error=n}static makeMessage(t,n,r){const s=n?.message?typeof n.message=="string"?n.message:JSON.stringify(n.message):n?JSON.stringify(n):r;return t&&s?`${t} ${s}`:t?`${t} status code (no body)`:s||"(no status code or body)"}static generate(t,n,r,s){if(!t||!s)return new yn({message:r,cause:Wn(n)});const o=n;return t===400?new xo(t,o,r,s):t===401?new $o(t,o,r,s):t===403?new Po(t,o,r,s):t===404?new To(t,o,r,s):t===409?new Ro(t,o,r,s):t===422?new Mo(t,o,r,s):t===429?new Eo(t,o,r,s):t>=500?new Ao(t,o,r,s):new j(t,o,r,s)}}class ce extends j{constructor({message:t}={}){super(void 0,void 0,t||"Request was aborted.",void 0)}}class yn extends j{constructor({message:t,cause:n}){super(void 0,void 0,t||"Connection error.",void 0),n&&(this.cause=n)}}class So extends yn{constructor({message:t}={}){super({message:t??"Request timed out."})}}class xo extends j{}class $o extends j{}class Po extends j{}class To extends j{}class Ro extends j{}class Mo extends j{}class Eo extends j{}class Ao extends j{}const Jh=/^[a-z][a-z0-9+.-]*:/i,Gh=e=>Jh.test(e);let Hn=e=>(Hn=Array.isArray,Hn(e)),as=Hn;function Yn(e){return typeof e!="object"?{}:e??{}}function Vh(e){if(!e)return!0;for(const t in e)return!1;return!0}function Xh(e,t){return Object.prototype.hasOwnProperty.call(e,t)}const Kh=(e,t)=>{if(typeof t!="number"||!Number.isInteger(t))throw new w(`${e} must be an integer`);if(t<0)throw new w(`${e} must be a positive integer`);return t},Oo=e=>{try{return JSON.parse(e)}catch{return}},Qh=e=>new Promise(t=>setTimeout(t,e)),Be="0.71.2",ed=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u";function td(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const nd=()=>{const e=td();if(e==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Be,"X-Stainless-OS":cs(Deno.build.os),"X-Stainless-Arch":ls(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:Deno.version?.deno??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Be,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(e==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Be,"X-Stainless-OS":cs(globalThis.process.platform??"unknown"),"X-Stainless-Arch":ls(globalThis.process.arch??"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":globalThis.process.version??"unknown"};const t=rd();return t?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Be,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${t.browser}`,"X-Stainless-Runtime-Version":t.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Be,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function rd(){if(typeof navigator>"u"||!navigator)return null;const e=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:t,pattern:n}of e){const r=n.exec(navigator.userAgent);if(r){const s=r[1]||0,o=r[2]||0,i=r[3]||0;return{browser:t,version:`${s}.${o}.${i}`}}}return null}const ls=e=>e==="x32"?"x32":e==="x86_64"||e==="x64"?"x64":e==="arm"?"arm":e==="aarch64"||e==="arm64"?"arm64":e?`other:${e}`:"unknown",cs=e=>(e=e.toLowerCase(),e.includes("ios")?"iOS":e==="android"?"Android":e==="darwin"?"MacOS":e==="win32"?"Windows":e==="freebsd"?"FreeBSD":e==="openbsd"?"OpenBSD":e==="linux"?"Linux":e?`Other:${e}`:"Unknown");let us;const sd=()=>us??(us=nd());function od(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new Anthropic({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function zo(...e){const t=globalThis.ReadableStream;if(typeof t>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new t(...e)}function qo(e){let t=Symbol.asyncIterator in e?e[Symbol.asyncIterator]():e[Symbol.iterator]();return zo({start(){},async pull(n){const{done:r,value:s}=await t.next();r?n.close():n.enqueue(s)},async cancel(){await t.return?.()}})}function gr(e){if(e[Symbol.asyncIterator])return e;const t=e.getReader();return{async next(){try{const n=await t.read();return n?.done&&t.releaseLock(),n}catch(n){throw t.releaseLock(),n}},async return(){const n=t.cancel();return t.releaseLock(),await n,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function id(e){if(e===null||typeof e!="object")return;if(e[Symbol.asyncIterator]){await e[Symbol.asyncIterator]().return?.();return}const t=e.getReader(),n=t.cancel();t.releaseLock(),await n}const ad=({headers:e,body:t})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(t)});function ld(e){let t=0;for(const s of e)t+=s.length;const n=new Uint8Array(t);let r=0;for(const s of e)n.set(s,r),r+=s.length;return n}let hs;function mr(e){let t;return(hs??(t=new globalThis.TextEncoder,hs=t.encode.bind(t)))(e)}let ds;function ps(e){let t;return(ds??(t=new globalThis.TextDecoder,ds=t.decode.bind(t)))(e)}var K,Q;class $t{constructor(){K.set(this,void 0),Q.set(this,void 0),m(this,K,new Uint8Array),m(this,Q,null)}decode(t){if(t==null)return[];const n=t instanceof ArrayBuffer?new Uint8Array(t):typeof t=="string"?mr(t):t;m(this,K,ld([h(this,K,"f"),n]));const r=[];let s;for(;(s=cd(h(this,K,"f"),h(this,Q,"f")))!=null;){if(s.carriage&&h(this,Q,"f")==null){m(this,Q,s.index);continue}if(h(this,Q,"f")!=null&&(s.index!==h(this,Q,"f")+1||s.carriage)){r.push(ps(h(this,K,"f").subarray(0,h(this,Q,"f")-1))),m(this,K,h(this,K,"f").subarray(h(this,Q,"f"))),m(this,Q,null);continue}const o=h(this,Q,"f")!==null?s.preceding-1:s.preceding,i=ps(h(this,K,"f").subarray(0,o));r.push(i),m(this,K,h(this,K,"f").subarray(s.index)),m(this,Q,null)}return r}flush(){return h(this,K,"f").length?this.decode(`
`):[]}}K=new WeakMap,Q=new WeakMap;$t.NEWLINE_CHARS=new Set([`
`,"\r"]);$t.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function cd(e,t){for(let s=t??0;s<e.length;s++){if(e[s]===10)return{preceding:s,index:s+1,carriage:!1};if(e[s]===13)return{preceding:s,index:s+1,carriage:!0}}return null}function ud(e){for(let r=0;r<e.length-1;r++){if(e[r]===10&&e[r+1]===10||e[r]===13&&e[r+1]===13)return r+2;if(e[r]===13&&e[r+1]===10&&r+3<e.length&&e[r+2]===13&&e[r+3]===10)return r+4}return-1}const cn={off:0,error:200,warn:300,info:400,debug:500},fs=(e,t,n)=>{if(e){if(Xh(cn,e))return e;W(n).warn(`${t} was set to ${JSON.stringify(e)}, expected one of ${JSON.stringify(Object.keys(cn))}`)}};function mt(){}function Ct(e,t,n){return!t||cn[e]>cn[n]?mt:t[e].bind(t)}const hd={error:mt,warn:mt,info:mt,debug:mt};let gs=new WeakMap;function W(e){const t=e.logger,n=e.logLevel??"off";if(!t)return hd;const r=gs.get(t);if(r&&r[0]===n)return r[1];const s={error:Ct("error",t,n),warn:Ct("warn",t,n),info:Ct("info",t,n),debug:Ct("debug",t,n)};return gs.set(t,[n,s]),s}const Ae=e=>(e.options&&(e.options={...e.options},delete e.options.headers),e.headers&&(e.headers=Object.fromEntries((e.headers instanceof Headers?[...e.headers]:Object.entries(e.headers)).map(([t,n])=>[t,t.toLowerCase()==="x-api-key"||t.toLowerCase()==="authorization"||t.toLowerCase()==="cookie"||t.toLowerCase()==="set-cookie"?"***":n]))),"retryOfRequestLogID"in e&&(e.retryOfRequestLogID&&(e.retryOf=e.retryOfRequestLogID),delete e.retryOfRequestLogID),e);var Qe;class de{constructor(t,n,r){this.iterator=t,Qe.set(this,void 0),this.controller=n,m(this,Qe,r)}static fromSSEResponse(t,n,r){let s=!1;const o=r?W(r):console;async function*i(){if(s)throw new w("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");s=!0;let a=!1;try{for await(const l of dd(t,n)){if(l.event==="completion")try{yield JSON.parse(l.data)}catch(c){throw o.error("Could not parse message into JSON:",l.data),o.error("From chunk:",l.raw),c}if(l.event==="message_start"||l.event==="message_delta"||l.event==="message_stop"||l.event==="content_block_start"||l.event==="content_block_delta"||l.event==="content_block_stop")try{yield JSON.parse(l.data)}catch(c){throw o.error("Could not parse message into JSON:",l.data),o.error("From chunk:",l.raw),c}if(l.event!=="ping"&&l.event==="error")throw new j(void 0,Oo(l.data)??l.data,void 0,t.headers)}a=!0}catch(l){if(vt(l))return;throw l}finally{a||n.abort()}}return new de(i,n,r)}static fromReadableStream(t,n,r){let s=!1;async function*o(){const a=new $t,l=gr(t);for await(const c of l)for(const u of a.decode(c))yield u;for(const c of a.flush())yield c}async function*i(){if(s)throw new w("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");s=!0;let a=!1;try{for await(const l of o())a||l&&(yield JSON.parse(l));a=!0}catch(l){if(vt(l))return;throw l}finally{a||n.abort()}}return new de(i,n,r)}[(Qe=new WeakMap,Symbol.asyncIterator)](){return this.iterator()}tee(){const t=[],n=[],r=this.iterator(),s=o=>({next:()=>{if(o.length===0){const i=r.next();t.push(i),n.push(i)}return o.shift()}});return[new de(()=>s(t),this.controller,h(this,Qe,"f")),new de(()=>s(n),this.controller,h(this,Qe,"f"))]}toReadableStream(){const t=this;let n;return zo({async start(){n=t[Symbol.asyncIterator]()},async pull(r){try{const{value:s,done:o}=await n.next();if(o)return r.close();const i=mr(JSON.stringify(s)+`
`);r.enqueue(i)}catch(s){r.error(s)}},async cancel(){await n.return?.()}})}}async function*dd(e,t){if(!e.body)throw t.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new w("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new w("Attempted to iterate over a response with no body");const n=new fd,r=new $t,s=gr(e.body);for await(const o of pd(s))for(const i of r.decode(o)){const a=n.decode(i);a&&(yield a)}for(const o of r.flush()){const i=n.decode(o);i&&(yield i)}}async function*pd(e){let t=new Uint8Array;for await(const n of e){if(n==null)continue;const r=n instanceof ArrayBuffer?new Uint8Array(n):typeof n=="string"?mr(n):n;let s=new Uint8Array(t.length+r.length);s.set(t),s.set(r,t.length),t=s;let o;for(;(o=ud(t))!==-1;)yield t.slice(0,o),t=t.slice(o)}t.length>0&&(yield t)}class fd{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(t){if(t.endsWith("\r")&&(t=t.substring(0,t.length-1)),!t){if(!this.event&&!this.data.length)return null;const o={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],o}if(this.chunks.push(t),t.startsWith(":"))return null;let[n,r,s]=gd(t,":");return s.startsWith(" ")&&(s=s.substring(1)),n==="event"?this.event=s:n==="data"&&this.data.push(s),null}}function gd(e,t){const n=e.indexOf(t);return n!==-1?[e.substring(0,n),t,e.substring(n+t.length)]:[e,"",""]}async function Io(e,t){const{response:n,requestLogID:r,retryOfRequestLogID:s,startTime:o}=t,i=await(async()=>{if(t.options.stream)return W(e).debug("response",n.status,n.url,n.headers,n.body),t.options.__streamClass?t.options.__streamClass.fromSSEResponse(n,t.controller):de.fromSSEResponse(n,t.controller);if(n.status===204)return null;if(t.options.__binaryResponse)return n;const l=n.headers.get("content-type")?.split(";")[0]?.trim();if(l?.includes("application/json")||l?.endsWith("+json")){const d=await n.json();return Co(d,n)}return await n.text()})();return W(e).debug(`[${r}] response parsed`,Ae({retryOfRequestLogID:s,url:n.url,status:n.status,body:i,durationMs:Date.now()-o})),i}function Co(e,t){return!e||typeof e!="object"||Array.isArray(e)?e:Object.defineProperty(e,"_request_id",{value:t.headers.get("request-id"),enumerable:!1})}var _t;class bn extends Promise{constructor(t,n,r=Io){super(s=>{s(null)}),this.responsePromise=n,this.parseResponse=r,_t.set(this,void 0),m(this,_t,t)}_thenUnwrap(t){return new bn(h(this,_t,"f"),this.responsePromise,async(n,r)=>Co(t(await this.parseResponse(n,r),r),r.response))}asResponse(){return this.responsePromise.then(t=>t.response)}async withResponse(){const[t,n]=await Promise.all([this.parse(),this.asResponse()]);return{data:t,response:n,request_id:n.headers.get("request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(t=>this.parseResponse(h(this,_t,"f"),t))),this.parsedPromise}then(t,n){return this.parse().then(t,n)}catch(t){return this.parse().catch(t)}finally(t){return this.parse().finally(t)}}_t=new WeakMap;var Nt;class No{constructor(t,n,r,s){Nt.set(this,void 0),m(this,Nt,t),this.options=s,this.response=n,this.body=r}hasNextPage(){return this.getPaginatedItems().length?this.nextPageRequestOptions()!=null:!1}async getNextPage(){const t=this.nextPageRequestOptions();if(!t)throw new w("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");return await h(this,Nt,"f").requestAPIList(this.constructor,t)}async*iterPages(){let t=this;for(yield t;t.hasNextPage();)t=await t.getNextPage(),yield t}async*[(Nt=new WeakMap,Symbol.asyncIterator)](){for await(const t of this.iterPages())for(const n of t.getPaginatedItems())yield n}}class md extends bn{constructor(t,n,r){super(t,n,async(s,o)=>new r(s,o.response,await Io(s,o),o.options))}async*[Symbol.asyncIterator](){const t=await this;for await(const n of t)yield n}}class Pt extends No{constructor(t,n,r,s){super(t,n,r,s),this.data=r.data||[],this.has_more=r.has_more||!1,this.first_id=r.first_id||null,this.last_id=r.last_id||null}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageRequestOptions(){if(this.options.query?.before_id){const n=this.first_id;return n?{...this.options,query:{...Yn(this.options.query),before_id:n}}:null}const t=this.last_id;return t?{...this.options,query:{...Yn(this.options.query),after_id:t}}:null}}class Lo extends No{constructor(t,n,r,s){super(t,n,r,s),this.data=r.data||[],this.has_more=r.has_more||!1,this.next_page=r.next_page||null}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageRequestOptions(){const t=this.next_page;return t?{...this.options,query:{...Yn(this.options.query),page:t}}:null}}const Do=()=>{if(typeof File>"u"){const{process:e}=globalThis,t=typeof e?.versions?.node=="string"&&parseInt(e.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(t?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function We(e,t,n){return Do(),new File(e,t??"unknown_file",n)}function Kt(e){return(typeof e=="object"&&e!==null&&("name"in e&&e.name&&String(e.name)||"url"in e&&e.url&&String(e.url)||"filename"in e&&e.filename&&String(e.filename)||"path"in e&&e.path&&String(e.path))||"").split(/[\\/]/).pop()||void 0}const Zo=e=>e!=null&&typeof e=="object"&&typeof e[Symbol.asyncIterator]=="function",_r=async(e,t)=>({...e,body:await yd(e.body,t)}),ms=new WeakMap;function _d(e){const t=typeof e=="function"?e:e.fetch,n=ms.get(t);if(n)return n;const r=(async()=>{try{const s="Response"in t?t.Response:(await t("data:,")).constructor,o=new FormData;return o.toString()!==await new s(o).text()}catch{return!0}})();return ms.set(t,r),r}const yd=async(e,t)=>{if(!await _d(t))throw new TypeError("The provided fetch function does not support file uploads with the current global FormData class.");const n=new FormData;return await Promise.all(Object.entries(e||{}).map(([r,s])=>Jn(n,r,s))),n},bd=e=>e instanceof Blob&&"name"in e,Jn=async(e,t,n)=>{if(n!==void 0){if(n==null)throw new TypeError(`Received null for "${t}"; to pass null in FormData, you must use the string 'null'`);if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")e.append(t,String(n));else if(n instanceof Response){let r={};const s=n.headers.get("Content-Type");s&&(r={type:s}),e.append(t,We([await n.blob()],Kt(n),r))}else if(Zo(n))e.append(t,We([await new Response(qo(n)).blob()],Kt(n)));else if(bd(n))e.append(t,We([n],Kt(n),{type:n.type}));else if(Array.isArray(n))await Promise.all(n.map(r=>Jn(e,t+"[]",r)));else if(typeof n=="object")await Promise.all(Object.entries(n).map(([r,s])=>Jn(e,`${t}[${r}]`,s)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${n} instead`)}},Bo=e=>e!=null&&typeof e=="object"&&typeof e.size=="number"&&typeof e.type=="string"&&typeof e.text=="function"&&typeof e.slice=="function"&&typeof e.arrayBuffer=="function",wd=e=>e!=null&&typeof e=="object"&&typeof e.name=="string"&&typeof e.lastModified=="number"&&Bo(e),kd=e=>e!=null&&typeof e=="object"&&typeof e.url=="string"&&typeof e.blob=="function";async function vd(e,t,n){if(Do(),e=await e,t||(t=Kt(e)),wd(e))return e instanceof File&&t==null&&n==null?e:We([await e.arrayBuffer()],t??e.name,{type:e.type,lastModified:e.lastModified,...n});if(kd(e)){const s=await e.blob();return t||(t=new URL(e.url).pathname.split(/[\\/]/).pop()),We(await Gn(s),t,n)}const r=await Gn(e);if(!n?.type){const s=r.find(o=>typeof o=="object"&&"type"in o&&o.type);typeof s=="string"&&(n={...n,type:s})}return We(r,t,n)}async function Gn(e){let t=[];if(typeof e=="string"||ArrayBuffer.isView(e)||e instanceof ArrayBuffer)t.push(e);else if(Bo(e))t.push(e instanceof Blob?e:await e.arrayBuffer());else if(Zo(e))for await(const n of e)t.push(...await Gn(n));else{const n=e?.constructor?.name;throw new Error(`Unexpected data type: ${typeof e}${n?`; constructor: ${n}`:""}${Sd(e)}`)}return t}function Sd(e){return typeof e!="object"||e===null?"":`; props: [${Object.getOwnPropertyNames(e).map(n=>`"${n}"`).join(", ")}]`}class ue{constructor(t){this._client=t}}const jo=Symbol.for("brand.privateNullableHeaders");function*xd(e){if(!e)return;if(jo in e){const{values:r,nulls:s}=e;yield*r.entries();for(const o of s)yield[o,null];return}let t=!1,n;e instanceof Headers?n=e.entries():as(e)?n=e:(t=!0,n=Object.entries(e??{}));for(let r of n){const s=r[0];if(typeof s!="string")throw new TypeError("expected header name to be a string");const o=as(r[1])?r[1]:[r[1]];let i=!1;for(const a of o)a!==void 0&&(t&&!i&&(i=!0,yield[s,null]),yield[s,a])}}const v=e=>{const t=new Headers,n=new Set;for(const r of e){const s=new Set;for(const[o,i]of xd(r)){const a=o.toLowerCase();s.has(a)||(t.delete(o),s.add(a)),i===null?(t.delete(o),n.add(a)):(t.append(o,i),n.delete(a))}}return{[jo]:!0,values:t,nulls:n}};function Fo(e){return e.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const _s=Object.freeze(Object.create(null)),$d=(e=Fo)=>function(n,...r){if(n.length===1)return n[0];let s=!1;const o=[],i=n.reduce((u,d,g)=>{/[?#]/.test(d)&&(s=!0);const f=r[g];let _=(s?encodeURIComponent:e)(""+f);return g!==r.length&&(f==null||typeof f=="object"&&f.toString===Object.getPrototypeOf(Object.getPrototypeOf(f.hasOwnProperty??_s)??_s)?.toString)&&(_=f+"",o.push({start:u.length+d.length,length:_.length,error:`Value of type ${Object.prototype.toString.call(f).slice(8,-1)} is not a valid path parameter`})),u+d+(g===r.length?"":_)},""),a=i.split(/[?#]/,1)[0],l=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let c;for(;(c=l.exec(a))!==null;)o.push({start:c.index,length:c[0].length,error:`Value "${c[0]}" can't be safely passed as a path parameter`});if(o.sort((u,d)=>u.start-d.start),o.length>0){let u=0;const d=o.reduce((g,f)=>{const _=" ".repeat(f.start-u),k="^".repeat(f.length);return u=f.start+f.length,g+_+k},"");throw new w(`Path parameters result in path with invalid segments:
${o.map(g=>g.error).join(`
`)}
${i}
${d}`)}return i},D=$d(Fo);class Uo extends ue{list(t={},n){const{betas:r,...s}=t??{};return this._client.getAPIList("/v1/files",Pt,{query:s,...n,headers:v([{"anthropic-beta":[...r??[],"files-api-2025-04-14"].toString()},n?.headers])})}delete(t,n={},r){const{betas:s}=n??{};return this._client.delete(D`/v1/files/${t}`,{...r,headers:v([{"anthropic-beta":[...s??[],"files-api-2025-04-14"].toString()},r?.headers])})}download(t,n={},r){const{betas:s}=n??{};return this._client.get(D`/v1/files/${t}/content`,{...r,headers:v([{"anthropic-beta":[...s??[],"files-api-2025-04-14"].toString(),Accept:"application/binary"},r?.headers]),__binaryResponse:!0})}retrieveMetadata(t,n={},r){const{betas:s}=n??{};return this._client.get(D`/v1/files/${t}`,{...r,headers:v([{"anthropic-beta":[...s??[],"files-api-2025-04-14"].toString()},r?.headers])})}upload(t,n){const{betas:r,...s}=t;return this._client.post("/v1/files",_r({body:s,...n,headers:v([{"anthropic-beta":[...r??[],"files-api-2025-04-14"].toString()},n?.headers])},this._client))}}let Wo=class extends ue{retrieve(t,n={},r){const{betas:s}=n??{};return this._client.get(D`/v1/models/${t}?beta=true`,{...r,headers:v([{...s?.toString()!=null?{"anthropic-beta":s?.toString()}:void 0},r?.headers])})}list(t={},n){const{betas:r,...s}=t??{};return this._client.getAPIList("/v1/models?beta=true",Pt,{query:s,...n,headers:v([{...r?.toString()!=null?{"anthropic-beta":r?.toString()}:void 0},n?.headers])})}};const Ho={"claude-opus-4-20250514":8192,"claude-opus-4-0":8192,"claude-4-opus-20250514":8192,"anthropic.claude-opus-4-20250514-v1:0":8192,"claude-opus-4@20250514":8192,"claude-opus-4-1-20250805":8192,"anthropic.claude-opus-4-1-20250805-v1:0":8192,"claude-opus-4-1@20250805":8192};function ys(e,t,n){return!t||!("parse"in(t.output_format??{}))?{...e,content:e.content.map(r=>{if(r.type==="text"){const s=Object.defineProperty({...r},"parsed_output",{value:null,enumerable:!1});return Object.defineProperty(s,"parsed",{get(){return n.logger.warn("The `parsed` property on `text` blocks is deprecated, please use `parsed_output` instead."),null},enumerable:!1})}return r}),parsed_output:null}:Yo(e,t,n)}function Yo(e,t,n){let r=null;const s=e.content.map(o=>{if(o.type==="text"){const i=Pd(t,o.text);r===null&&(r=i);const a=Object.defineProperty({...o},"parsed_output",{value:i,enumerable:!1});return Object.defineProperty(a,"parsed",{get(){return n.logger.warn("The `parsed` property on `text` blocks is deprecated, please use `parsed_output` instead."),i},enumerable:!1})}return o});return{...e,content:s,parsed_output:r}}function Pd(e,t){if(e.output_format?.type!=="json_schema")return null;try{return"parse"in e.output_format?e.output_format.parse(t):JSON.parse(t)}catch(n){throw new w(`Failed to parse structured output: ${n}`)}}const Td=e=>{let t=0,n=[];for(;t<e.length;){let r=e[t];if(r==="\\"){t++;continue}if(r==="{"){n.push({type:"brace",value:"{"}),t++;continue}if(r==="}"){n.push({type:"brace",value:"}"}),t++;continue}if(r==="["){n.push({type:"paren",value:"["}),t++;continue}if(r==="]"){n.push({type:"paren",value:"]"}),t++;continue}if(r===":"){n.push({type:"separator",value:":"}),t++;continue}if(r===","){n.push({type:"delimiter",value:","}),t++;continue}if(r==='"'){let a="",l=!1;for(r=e[++t];r!=='"';){if(t===e.length){l=!0;break}if(r==="\\"){if(t++,t===e.length){l=!0;break}a+=r+e[t],r=e[++t]}else a+=r,r=e[++t]}r=e[++t],l||n.push({type:"string",value:a});continue}if(r&&/\s/.test(r)){t++;continue}let o=/[0-9]/;if(r&&o.test(r)||r==="-"||r==="."){let a="";for(r==="-"&&(a+=r,r=e[++t]);r&&o.test(r)||r===".";)a+=r,r=e[++t];n.push({type:"number",value:a});continue}let i=/[a-z]/i;if(r&&i.test(r)){let a="";for(;r&&i.test(r)&&t!==e.length;)a+=r,r=e[++t];if(a=="true"||a=="false"||a==="null")n.push({type:"name",value:a});else{t++;continue}continue}t++}return n},je=e=>{if(e.length===0)return e;let t=e[e.length-1];switch(t.type){case"separator":return e=e.slice(0,e.length-1),je(e);case"number":let n=t.value[t.value.length-1];if(n==="."||n==="-")return e=e.slice(0,e.length-1),je(e);case"string":let r=e[e.length-2];if(r?.type==="delimiter")return e=e.slice(0,e.length-1),je(e);if(r?.type==="brace"&&r.value==="{")return e=e.slice(0,e.length-1),je(e);break;case"delimiter":return e=e.slice(0,e.length-1),je(e)}return e},Rd=e=>{let t=[];return e.map(n=>{n.type==="brace"&&(n.value==="{"?t.push("}"):t.splice(t.lastIndexOf("}"),1)),n.type==="paren"&&(n.value==="["?t.push("]"):t.splice(t.lastIndexOf("]"),1))}),t.length>0&&t.reverse().map(n=>{n==="}"?e.push({type:"brace",value:"}"}):n==="]"&&e.push({type:"paren",value:"]"})}),e},Md=e=>{let t="";return e.map(n=>{n.type==="string"?t+='"'+n.value+'"':t+=n.value}),t},Jo=e=>JSON.parse(Md(Rd(je(Td(e)))));var te,be,De,et,Lt,tt,nt,Dt,rt,pe,st,Zt,Bt,Re,jt,Ft,ot,Rn,bs,Ut,Mn,En,An,ws;const ks="__json_buf";function vs(e){return e.type==="tool_use"||e.type==="server_tool_use"||e.type==="mcp_tool_use"}class un{constructor(t,n){te.add(this),this.messages=[],this.receivedMessages=[],be.set(this,void 0),De.set(this,null),this.controller=new AbortController,et.set(this,void 0),Lt.set(this,()=>{}),tt.set(this,()=>{}),nt.set(this,void 0),Dt.set(this,()=>{}),rt.set(this,()=>{}),pe.set(this,{}),st.set(this,!1),Zt.set(this,!1),Bt.set(this,!1),Re.set(this,!1),jt.set(this,void 0),Ft.set(this,void 0),ot.set(this,void 0),Ut.set(this,r=>{if(m(this,Zt,!0),vt(r)&&(r=new ce),r instanceof ce)return m(this,Bt,!0),this._emit("abort",r);if(r instanceof w)return this._emit("error",r);if(r instanceof Error){const s=new w(r.message);return s.cause=r,this._emit("error",s)}return this._emit("error",new w(String(r)))}),m(this,et,new Promise((r,s)=>{m(this,Lt,r,"f"),m(this,tt,s,"f")})),m(this,nt,new Promise((r,s)=>{m(this,Dt,r,"f"),m(this,rt,s,"f")})),h(this,et,"f").catch(()=>{}),h(this,nt,"f").catch(()=>{}),m(this,De,t),m(this,ot,n?.logger??console)}get response(){return h(this,jt,"f")}get request_id(){return h(this,Ft,"f")}async withResponse(){m(this,Re,!0);const t=await h(this,et,"f");if(!t)throw new Error("Could not resolve a `Response` object");return{data:this,response:t,request_id:t.headers.get("request-id")}}static fromReadableStream(t){const n=new un(null);return n._run(()=>n._fromReadableStream(t)),n}static createMessage(t,n,r,{logger:s}={}){const o=new un(n,{logger:s});for(const i of n.messages)o._addMessageParam(i);return m(o,De,{...n,stream:!0}),o._run(()=>o._createMessage(t,{...n,stream:!0},{...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"stream"}})),o}_run(t){t().then(()=>{this._emitFinal(),this._emit("end")},h(this,Ut,"f"))}_addMessageParam(t){this.messages.push(t)}_addMessage(t,n=!0){this.receivedMessages.push(t),n&&this._emit("message",t)}async _createMessage(t,n,r){const s=r?.signal;let o;s&&(s.aborted&&this.controller.abort(),o=this.controller.abort.bind(this.controller),s.addEventListener("abort",o));try{h(this,te,"m",Mn).call(this);const{response:i,data:a}=await t.create({...n,stream:!0},{...r,signal:this.controller.signal}).withResponse();this._connected(i);for await(const l of a)h(this,te,"m",En).call(this,l);if(a.controller.signal?.aborted)throw new ce;h(this,te,"m",An).call(this)}finally{s&&o&&s.removeEventListener("abort",o)}}_connected(t){this.ended||(m(this,jt,t),m(this,Ft,t?.headers.get("request-id")),h(this,Lt,"f").call(this,t),this._emit("connect"))}get ended(){return h(this,st,"f")}get errored(){return h(this,Zt,"f")}get aborted(){return h(this,Bt,"f")}abort(){this.controller.abort()}on(t,n){return(h(this,pe,"f")[t]||(h(this,pe,"f")[t]=[])).push({listener:n}),this}off(t,n){const r=h(this,pe,"f")[t];if(!r)return this;const s=r.findIndex(o=>o.listener===n);return s>=0&&r.splice(s,1),this}once(t,n){return(h(this,pe,"f")[t]||(h(this,pe,"f")[t]=[])).push({listener:n,once:!0}),this}emitted(t){return new Promise((n,r)=>{m(this,Re,!0),t!=="error"&&this.once("error",r),this.once(t,n)})}async done(){m(this,Re,!0),await h(this,nt,"f")}get currentMessage(){return h(this,be,"f")}async finalMessage(){return await this.done(),h(this,te,"m",Rn).call(this)}async finalText(){return await this.done(),h(this,te,"m",bs).call(this)}_emit(t,...n){if(h(this,st,"f"))return;t==="end"&&(m(this,st,!0),h(this,Dt,"f").call(this));const r=h(this,pe,"f")[t];if(r&&(h(this,pe,"f")[t]=r.filter(s=>!s.once),r.forEach(({listener:s})=>s(...n))),t==="abort"){const s=n[0];!h(this,Re,"f")&&!r?.length&&Promise.reject(s),h(this,tt,"f").call(this,s),h(this,rt,"f").call(this,s),this._emit("end");return}if(t==="error"){const s=n[0];!h(this,Re,"f")&&!r?.length&&Promise.reject(s),h(this,tt,"f").call(this,s),h(this,rt,"f").call(this,s),this._emit("end")}}_emitFinal(){this.receivedMessages.at(-1)&&this._emit("finalMessage",h(this,te,"m",Rn).call(this))}async _fromReadableStream(t,n){const r=n?.signal;let s;r&&(r.aborted&&this.controller.abort(),s=this.controller.abort.bind(this.controller),r.addEventListener("abort",s));try{h(this,te,"m",Mn).call(this),this._connected(null);const o=de.fromReadableStream(t,this.controller);for await(const i of o)h(this,te,"m",En).call(this,i);if(o.controller.signal?.aborted)throw new ce;h(this,te,"m",An).call(this)}finally{r&&s&&r.removeEventListener("abort",s)}}[(be=new WeakMap,De=new WeakMap,et=new WeakMap,Lt=new WeakMap,tt=new WeakMap,nt=new WeakMap,Dt=new WeakMap,rt=new WeakMap,pe=new WeakMap,st=new WeakMap,Zt=new WeakMap,Bt=new WeakMap,Re=new WeakMap,jt=new WeakMap,Ft=new WeakMap,ot=new WeakMap,Ut=new WeakMap,te=new WeakSet,Rn=function(){if(this.receivedMessages.length===0)throw new w("stream ended without producing a Message with role=assistant");return this.receivedMessages.at(-1)},bs=function(){if(this.receivedMessages.length===0)throw new w("stream ended without producing a Message with role=assistant");const n=this.receivedMessages.at(-1).content.filter(r=>r.type==="text").map(r=>r.text);if(n.length===0)throw new w("stream ended without producing a content block with type=text");return n.join(" ")},Mn=function(){this.ended||m(this,be,void 0)},En=function(n){if(this.ended)return;const r=h(this,te,"m",ws).call(this,n);switch(this._emit("streamEvent",n,r),n.type){case"content_block_delta":{const s=r.content.at(-1);switch(n.delta.type){case"text_delta":{s.type==="text"&&this._emit("text",n.delta.text,s.text||"");break}case"citations_delta":{s.type==="text"&&this._emit("citation",n.delta.citation,s.citations??[]);break}case"input_json_delta":{vs(s)&&s.input&&this._emit("inputJson",n.delta.partial_json,s.input);break}case"thinking_delta":{s.type==="thinking"&&this._emit("thinking",n.delta.thinking,s.thinking);break}case"signature_delta":{s.type==="thinking"&&this._emit("signature",s.signature);break}default:n.delta}break}case"message_stop":{this._addMessageParam(r),this._addMessage(ys(r,h(this,De,"f"),{logger:h(this,ot,"f")}),!0);break}case"content_block_stop":{this._emit("contentBlock",r.content.at(-1));break}case"message_start":{m(this,be,r);break}}},An=function(){if(this.ended)throw new w("stream has ended, this shouldn't happen");const n=h(this,be,"f");if(!n)throw new w("request ended without sending any chunks");return m(this,be,void 0),ys(n,h(this,De,"f"),{logger:h(this,ot,"f")})},ws=function(n){let r=h(this,be,"f");if(n.type==="message_start"){if(r)throw new w(`Unexpected event order, got ${n.type} before receiving "message_stop"`);return n.message}if(!r)throw new w(`Unexpected event order, got ${n.type} before "message_start"`);switch(n.type){case"message_stop":return r;case"message_delta":return r.container=n.delta.container,r.stop_reason=n.delta.stop_reason,r.stop_sequence=n.delta.stop_sequence,r.usage.output_tokens=n.usage.output_tokens,r.context_management=n.context_management,n.usage.input_tokens!=null&&(r.usage.input_tokens=n.usage.input_tokens),n.usage.cache_creation_input_tokens!=null&&(r.usage.cache_creation_input_tokens=n.usage.cache_creation_input_tokens),n.usage.cache_read_input_tokens!=null&&(r.usage.cache_read_input_tokens=n.usage.cache_read_input_tokens),n.usage.server_tool_use!=null&&(r.usage.server_tool_use=n.usage.server_tool_use),r;case"content_block_start":return r.content.push(n.content_block),r;case"content_block_delta":{const s=r.content.at(n.index);switch(n.delta.type){case"text_delta":{s?.type==="text"&&(r.content[n.index]={...s,text:(s.text||"")+n.delta.text});break}case"citations_delta":{s?.type==="text"&&(r.content[n.index]={...s,citations:[...s.citations??[],n.delta.citation]});break}case"input_json_delta":{if(s&&vs(s)){let o=s[ks]||"";o+=n.delta.partial_json;const i={...s};if(Object.defineProperty(i,ks,{value:o,enumerable:!1,writable:!0}),o)try{i.input=Jo(o)}catch(a){const l=new w(`Unable to parse tool parameter JSON from model. Please retry your request or adjust your prompt. Error: ${a}. JSON: ${o}`);h(this,Ut,"f").call(this,l)}r.content[n.index]=i}break}case"thinking_delta":{s?.type==="thinking"&&(r.content[n.index]={...s,thinking:s.thinking+n.delta.thinking});break}case"signature_delta":{s?.type==="thinking"&&(r.content[n.index]={...s,signature:n.delta.signature});break}default:n.delta}return r}case"content_block_stop":return r}},Symbol.asyncIterator)](){const t=[],n=[];let r=!1;return this.on("streamEvent",s=>{const o=n.shift();o?o.resolve(s):t.push(s)}),this.on("end",()=>{r=!0;for(const s of n)s.resolve(void 0);n.length=0}),this.on("abort",s=>{r=!0;for(const o of n)o.reject(s);n.length=0}),this.on("error",s=>{r=!0;for(const o of n)o.reject(s);n.length=0}),{next:async()=>t.length?{value:t.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((o,i)=>n.push({resolve:o,reject:i})).then(o=>o?{value:o,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new de(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}const Ed=1e5,Ad=`You have been working on the task described above but have not yet completed it. Write a continuation summary that will allow you (or another instance of yourself) to resume work efficiently in a future context window where the conversation history will be replaced with this summary. Your summary should be structured, concise, and actionable. Include:
1. Task Overview
The user's core request and success criteria
Any clarifications or constraints they specified
2. Current State
What has been completed so far
Files created, modified, or analyzed (with paths if relevant)
Key outputs or artifacts produced
3. Important Discoveries
Technical constraints or requirements uncovered
Decisions made and their rationale
Errors encountered and how they were resolved
What approaches were tried that didn't work (and why)
4. Next Steps
Specific actions needed to complete the task
Any blockers or open questions to resolve
Priority order if multiple steps remain
5. Context to Preserve
User preferences or style requirements
Domain-specific details that aren't obvious
Any promises made to the user
Be concise but complete—err on the side of including information that would prevent duplicate work or repeated mistakes. Write in a way that enables immediate resumption of the task.
Wrap your summary in <summary></summary> tags.`;var it,Ze,Me,N,at,X,me,we,lt,Ss,Vn;function xs(){let e,t;return{promise:new Promise((r,s)=>{e=r,t=s}),resolve:e,reject:t}}class Go{constructor(t,n,r){it.add(this),this.client=t,Ze.set(this,!1),Me.set(this,!1),N.set(this,void 0),at.set(this,void 0),X.set(this,void 0),me.set(this,void 0),we.set(this,void 0),lt.set(this,0),m(this,N,{params:{...n,messages:structuredClone(n.messages)}}),m(this,at,{...r,headers:v([{"x-stainless-helper":"BetaToolRunner"},r?.headers])}),m(this,we,xs())}async*[(Ze=new WeakMap,Me=new WeakMap,N=new WeakMap,at=new WeakMap,X=new WeakMap,me=new WeakMap,we=new WeakMap,lt=new WeakMap,it=new WeakSet,Ss=async function(){const n=h(this,N,"f").params.compactionControl;if(!n||!n.enabled)return!1;let r=0;if(h(this,X,"f")!==void 0)try{const c=await h(this,X,"f");r=c.usage.input_tokens+(c.usage.cache_creation_input_tokens??0)+(c.usage.cache_read_input_tokens??0)+c.usage.output_tokens}catch{return!1}const s=n.contextTokenThreshold??Ed;if(r<s)return!1;const o=n.model??h(this,N,"f").params.model,i=n.summaryPrompt??Ad,a=h(this,N,"f").params.messages;if(a[a.length-1].role==="assistant"){const c=a[a.length-1];if(Array.isArray(c.content)){const u=c.content.filter(d=>d.type!=="tool_use");u.length===0?a.pop():c.content=u}}const l=await this.client.beta.messages.create({model:o,messages:[...a,{role:"user",content:[{type:"text",text:i}]}],max_tokens:h(this,N,"f").params.max_tokens},{headers:{"x-stainless-helper":"compaction"}});if(l.content[0]?.type!=="text")throw new w("Expected text response for compaction");return h(this,N,"f").params.messages=[{role:"user",content:l.content}],!0},Symbol.asyncIterator)](){var t;if(h(this,Ze,"f"))throw new w("Cannot iterate over a consumed stream");m(this,Ze,!0),m(this,Me,!0),m(this,me,void 0);try{for(;;){let n;try{if(h(this,N,"f").params.max_iterations&&h(this,lt,"f")>=h(this,N,"f").params.max_iterations)break;m(this,Me,!1,"f"),m(this,me,void 0,"f"),m(this,lt,(t=h(this,lt,"f"),t++,t),"f"),m(this,X,void 0,"f");const{max_iterations:r,compactionControl:s,...o}=h(this,N,"f").params;if(o.stream?(n=this.client.beta.messages.stream({...o},h(this,at,"f")),m(this,X,n.finalMessage(),"f"),h(this,X,"f").catch(()=>{}),yield n):(m(this,X,this.client.beta.messages.create({...o,stream:!1},h(this,at,"f")),"f"),yield h(this,X,"f")),!await h(this,it,"m",Ss).call(this)){if(!h(this,Me,"f")){const{role:l,content:c}=await h(this,X,"f");h(this,N,"f").params.messages.push({role:l,content:c})}const a=await h(this,it,"m",Vn).call(this,h(this,N,"f").params.messages.at(-1));if(a)h(this,N,"f").params.messages.push(a);else if(!h(this,Me,"f"))break}}finally{n&&n.abort()}}if(!h(this,X,"f"))throw new w("ToolRunner concluded without a message from the server");h(this,we,"f").resolve(await h(this,X,"f"))}catch(n){throw m(this,Ze,!1),h(this,we,"f").promise.catch(()=>{}),h(this,we,"f").reject(n),m(this,we,xs()),n}}setMessagesParams(t){typeof t=="function"?h(this,N,"f").params=t(h(this,N,"f").params):h(this,N,"f").params=t,m(this,Me,!0),m(this,me,void 0)}async generateToolResponse(){const t=await h(this,X,"f")??this.params.messages.at(-1);return t?h(this,it,"m",Vn).call(this,t):null}done(){return h(this,we,"f").promise}async runUntilDone(){if(!h(this,Ze,"f"))for await(const t of this);return this.done()}get params(){return h(this,N,"f").params}pushMessages(...t){this.setMessagesParams(n=>({...n,messages:[...n.messages,...t]}))}then(t,n){return this.runUntilDone().then(t,n)}}Vn=async function(t){return h(this,me,"f")!==void 0?h(this,me,"f"):(m(this,me,Od(h(this,N,"f").params,t)),h(this,me,"f"))};async function Od(e,t=e.messages.at(-1)){if(!t||t.role!=="assistant"||!t.content||typeof t.content=="string")return null;const n=t.content.filter(s=>s.type==="tool_use");return n.length===0?null:{role:"user",content:await Promise.all(n.map(async s=>{const o=e.tools.find(i=>("name"in i?i.name:i.mcp_server_name)===s.name);if(!o||!("run"in o))return{type:"tool_result",tool_use_id:s.id,content:`Error: Tool '${s.name}' not found`,is_error:!0};try{let i=s.input;"parse"in o&&o.parse&&(i=o.parse(i));const a=await o.run(i);return{type:"tool_result",tool_use_id:s.id,content:a}}catch(i){return{type:"tool_result",tool_use_id:s.id,content:`Error: ${i instanceof Error?i.message:String(i)}`,is_error:!0}}}))}}class wn{constructor(t,n){this.iterator=t,this.controller=n}async*decoder(){const t=new $t;for await(const n of this.iterator)for(const r of t.decode(n))yield JSON.parse(r);for(const n of t.flush())yield JSON.parse(n)}[Symbol.asyncIterator](){return this.decoder()}static fromResponse(t,n){if(!t.body)throw n.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new w("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new w("Attempted to iterate over a response with no body");return new wn(gr(t.body),n)}}let Vo=class extends ue{create(t,n){const{betas:r,...s}=t;return this._client.post("/v1/messages/batches?beta=true",{body:s,...n,headers:v([{"anthropic-beta":[...r??[],"message-batches-2024-09-24"].toString()},n?.headers])})}retrieve(t,n={},r){const{betas:s}=n??{};return this._client.get(D`/v1/messages/batches/${t}?beta=true`,{...r,headers:v([{"anthropic-beta":[...s??[],"message-batches-2024-09-24"].toString()},r?.headers])})}list(t={},n){const{betas:r,...s}=t??{};return this._client.getAPIList("/v1/messages/batches?beta=true",Pt,{query:s,...n,headers:v([{"anthropic-beta":[...r??[],"message-batches-2024-09-24"].toString()},n?.headers])})}delete(t,n={},r){const{betas:s}=n??{};return this._client.delete(D`/v1/messages/batches/${t}?beta=true`,{...r,headers:v([{"anthropic-beta":[...s??[],"message-batches-2024-09-24"].toString()},r?.headers])})}cancel(t,n={},r){const{betas:s}=n??{};return this._client.post(D`/v1/messages/batches/${t}/cancel?beta=true`,{...r,headers:v([{"anthropic-beta":[...s??[],"message-batches-2024-09-24"].toString()},r?.headers])})}async results(t,n={},r){const s=await this.retrieve(t);if(!s.results_url)throw new w(`No batch \`results_url\`; Has it finished processing? ${s.processing_status} - ${s.id}`);const{betas:o}=n??{};return this._client.get(s.results_url,{...r,headers:v([{"anthropic-beta":[...o??[],"message-batches-2024-09-24"].toString(),Accept:"application/binary"},r?.headers]),stream:!0,__binaryResponse:!0})._thenUnwrap((i,a)=>wn.fromResponse(a.response,a.controller))}};const $s={"claude-1.3":"November 6th, 2024","claude-1.3-100k":"November 6th, 2024","claude-instant-1.1":"November 6th, 2024","claude-instant-1.1-100k":"November 6th, 2024","claude-instant-1.2":"November 6th, 2024","claude-3-sonnet-20240229":"July 21st, 2025","claude-3-opus-20240229":"January 5th, 2026","claude-2.1":"July 21st, 2025","claude-2.0":"July 21st, 2025","claude-3-7-sonnet-latest":"February 19th, 2026","claude-3-7-sonnet-20250219":"February 19th, 2026"};let kn=class extends ue{constructor(){super(...arguments),this.batches=new Vo(this._client)}create(t,n){const{betas:r,...s}=t;s.model in $s&&console.warn(`The model '${s.model}' is deprecated and will reach end-of-life on ${$s[s.model]}
Please migrate to a newer model. Visit https://docs.anthropic.com/en/docs/resources/model-deprecations for more information.`);let o=this._client._options.timeout;if(!s.stream&&o==null){const i=Ho[s.model]??void 0;o=this._client.calculateNonstreamingTimeout(s.max_tokens,i)}return this._client.post("/v1/messages?beta=true",{body:s,timeout:o??6e5,...n,headers:v([{...r?.toString()!=null?{"anthropic-beta":r?.toString()}:void 0},n?.headers]),stream:t.stream??!1})}parse(t,n){return n={...n,headers:v([{"anthropic-beta":[...t.betas??[],"structured-outputs-2025-11-13"].toString()},n?.headers])},this.create(t,n).then(r=>Yo(r,t,{logger:this._client.logger??console}))}stream(t,n){return un.createMessage(this,t,n)}countTokens(t,n){const{betas:r,...s}=t;return this._client.post("/v1/messages/count_tokens?beta=true",{body:s,...n,headers:v([{"anthropic-beta":[...r??[],"token-counting-2024-11-01"].toString()},n?.headers])})}toolRunner(t,n){return new Go(this._client,t,n)}};kn.Batches=Vo;kn.BetaToolRunner=Go;class Xo extends ue{create(t,n={},r){const{betas:s,...o}=n??{};return this._client.post(D`/v1/skills/${t}/versions?beta=true`,_r({body:o,...r,headers:v([{"anthropic-beta":[...s??[],"skills-2025-10-02"].toString()},r?.headers])},this._client))}retrieve(t,n,r){const{skill_id:s,betas:o}=n;return this._client.get(D`/v1/skills/${s}/versions/${t}?beta=true`,{...r,headers:v([{"anthropic-beta":[...o??[],"skills-2025-10-02"].toString()},r?.headers])})}list(t,n={},r){const{betas:s,...o}=n??{};return this._client.getAPIList(D`/v1/skills/${t}/versions?beta=true`,Lo,{query:o,...r,headers:v([{"anthropic-beta":[...s??[],"skills-2025-10-02"].toString()},r?.headers])})}delete(t,n,r){const{skill_id:s,betas:o}=n;return this._client.delete(D`/v1/skills/${s}/versions/${t}?beta=true`,{...r,headers:v([{"anthropic-beta":[...o??[],"skills-2025-10-02"].toString()},r?.headers])})}}class yr extends ue{constructor(){super(...arguments),this.versions=new Xo(this._client)}create(t={},n){const{betas:r,...s}=t??{};return this._client.post("/v1/skills?beta=true",_r({body:s,...n,headers:v([{"anthropic-beta":[...r??[],"skills-2025-10-02"].toString()},n?.headers])},this._client))}retrieve(t,n={},r){const{betas:s}=n??{};return this._client.get(D`/v1/skills/${t}?beta=true`,{...r,headers:v([{"anthropic-beta":[...s??[],"skills-2025-10-02"].toString()},r?.headers])})}list(t={},n){const{betas:r,...s}=t??{};return this._client.getAPIList("/v1/skills?beta=true",Lo,{query:s,...n,headers:v([{"anthropic-beta":[...r??[],"skills-2025-10-02"].toString()},n?.headers])})}delete(t,n={},r){const{betas:s}=n??{};return this._client.delete(D`/v1/skills/${t}?beta=true`,{...r,headers:v([{"anthropic-beta":[...s??[],"skills-2025-10-02"].toString()},r?.headers])})}}yr.Versions=Xo;class Je extends ue{constructor(){super(...arguments),this.models=new Wo(this._client),this.messages=new kn(this._client),this.files=new Uo(this._client),this.skills=new yr(this._client)}}Je.Models=Wo;Je.Messages=kn;Je.Files=Uo;Je.Skills=yr;class Ko extends ue{create(t,n){const{betas:r,...s}=t;return this._client.post("/v1/complete",{body:s,timeout:this._client._options.timeout??6e5,...n,headers:v([{...r?.toString()!=null?{"anthropic-beta":r?.toString()}:void 0},n?.headers]),stream:t.stream??!1})}}var ne,ke,ct,Wt,ut,ht,Ht,dt,fe,pt,Yt,Jt,Ee,Gt,Vt,On,Ps,zn,qn,In,Cn,Ts;const Rs="__json_buf";function Ms(e){return e.type==="tool_use"||e.type==="server_tool_use"}class hn{constructor(){ne.add(this),this.messages=[],this.receivedMessages=[],ke.set(this,void 0),this.controller=new AbortController,ct.set(this,void 0),Wt.set(this,()=>{}),ut.set(this,()=>{}),ht.set(this,void 0),Ht.set(this,()=>{}),dt.set(this,()=>{}),fe.set(this,{}),pt.set(this,!1),Yt.set(this,!1),Jt.set(this,!1),Ee.set(this,!1),Gt.set(this,void 0),Vt.set(this,void 0),zn.set(this,t=>{if(m(this,Yt,!0),vt(t)&&(t=new ce),t instanceof ce)return m(this,Jt,!0),this._emit("abort",t);if(t instanceof w)return this._emit("error",t);if(t instanceof Error){const n=new w(t.message);return n.cause=t,this._emit("error",n)}return this._emit("error",new w(String(t)))}),m(this,ct,new Promise((t,n)=>{m(this,Wt,t,"f"),m(this,ut,n,"f")})),m(this,ht,new Promise((t,n)=>{m(this,Ht,t,"f"),m(this,dt,n,"f")})),h(this,ct,"f").catch(()=>{}),h(this,ht,"f").catch(()=>{})}get response(){return h(this,Gt,"f")}get request_id(){return h(this,Vt,"f")}async withResponse(){m(this,Ee,!0);const t=await h(this,ct,"f");if(!t)throw new Error("Could not resolve a `Response` object");return{data:this,response:t,request_id:t.headers.get("request-id")}}static fromReadableStream(t){const n=new hn;return n._run(()=>n._fromReadableStream(t)),n}static createMessage(t,n,r){const s=new hn;for(const o of n.messages)s._addMessageParam(o);return s._run(()=>s._createMessage(t,{...n,stream:!0},{...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"stream"}})),s}_run(t){t().then(()=>{this._emitFinal(),this._emit("end")},h(this,zn,"f"))}_addMessageParam(t){this.messages.push(t)}_addMessage(t,n=!0){this.receivedMessages.push(t),n&&this._emit("message",t)}async _createMessage(t,n,r){const s=r?.signal;let o;s&&(s.aborted&&this.controller.abort(),o=this.controller.abort.bind(this.controller),s.addEventListener("abort",o));try{h(this,ne,"m",qn).call(this);const{response:i,data:a}=await t.create({...n,stream:!0},{...r,signal:this.controller.signal}).withResponse();this._connected(i);for await(const l of a)h(this,ne,"m",In).call(this,l);if(a.controller.signal?.aborted)throw new ce;h(this,ne,"m",Cn).call(this)}finally{s&&o&&s.removeEventListener("abort",o)}}_connected(t){this.ended||(m(this,Gt,t),m(this,Vt,t?.headers.get("request-id")),h(this,Wt,"f").call(this,t),this._emit("connect"))}get ended(){return h(this,pt,"f")}get errored(){return h(this,Yt,"f")}get aborted(){return h(this,Jt,"f")}abort(){this.controller.abort()}on(t,n){return(h(this,fe,"f")[t]||(h(this,fe,"f")[t]=[])).push({listener:n}),this}off(t,n){const r=h(this,fe,"f")[t];if(!r)return this;const s=r.findIndex(o=>o.listener===n);return s>=0&&r.splice(s,1),this}once(t,n){return(h(this,fe,"f")[t]||(h(this,fe,"f")[t]=[])).push({listener:n,once:!0}),this}emitted(t){return new Promise((n,r)=>{m(this,Ee,!0),t!=="error"&&this.once("error",r),this.once(t,n)})}async done(){m(this,Ee,!0),await h(this,ht,"f")}get currentMessage(){return h(this,ke,"f")}async finalMessage(){return await this.done(),h(this,ne,"m",On).call(this)}async finalText(){return await this.done(),h(this,ne,"m",Ps).call(this)}_emit(t,...n){if(h(this,pt,"f"))return;t==="end"&&(m(this,pt,!0),h(this,Ht,"f").call(this));const r=h(this,fe,"f")[t];if(r&&(h(this,fe,"f")[t]=r.filter(s=>!s.once),r.forEach(({listener:s})=>s(...n))),t==="abort"){const s=n[0];!h(this,Ee,"f")&&!r?.length&&Promise.reject(s),h(this,ut,"f").call(this,s),h(this,dt,"f").call(this,s),this._emit("end");return}if(t==="error"){const s=n[0];!h(this,Ee,"f")&&!r?.length&&Promise.reject(s),h(this,ut,"f").call(this,s),h(this,dt,"f").call(this,s),this._emit("end")}}_emitFinal(){this.receivedMessages.at(-1)&&this._emit("finalMessage",h(this,ne,"m",On).call(this))}async _fromReadableStream(t,n){const r=n?.signal;let s;r&&(r.aborted&&this.controller.abort(),s=this.controller.abort.bind(this.controller),r.addEventListener("abort",s));try{h(this,ne,"m",qn).call(this),this._connected(null);const o=de.fromReadableStream(t,this.controller);for await(const i of o)h(this,ne,"m",In).call(this,i);if(o.controller.signal?.aborted)throw new ce;h(this,ne,"m",Cn).call(this)}finally{r&&s&&r.removeEventListener("abort",s)}}[(ke=new WeakMap,ct=new WeakMap,Wt=new WeakMap,ut=new WeakMap,ht=new WeakMap,Ht=new WeakMap,dt=new WeakMap,fe=new WeakMap,pt=new WeakMap,Yt=new WeakMap,Jt=new WeakMap,Ee=new WeakMap,Gt=new WeakMap,Vt=new WeakMap,zn=new WeakMap,ne=new WeakSet,On=function(){if(this.receivedMessages.length===0)throw new w("stream ended without producing a Message with role=assistant");return this.receivedMessages.at(-1)},Ps=function(){if(this.receivedMessages.length===0)throw new w("stream ended without producing a Message with role=assistant");const n=this.receivedMessages.at(-1).content.filter(r=>r.type==="text").map(r=>r.text);if(n.length===0)throw new w("stream ended without producing a content block with type=text");return n.join(" ")},qn=function(){this.ended||m(this,ke,void 0)},In=function(n){if(this.ended)return;const r=h(this,ne,"m",Ts).call(this,n);switch(this._emit("streamEvent",n,r),n.type){case"content_block_delta":{const s=r.content.at(-1);switch(n.delta.type){case"text_delta":{s.type==="text"&&this._emit("text",n.delta.text,s.text||"");break}case"citations_delta":{s.type==="text"&&this._emit("citation",n.delta.citation,s.citations??[]);break}case"input_json_delta":{Ms(s)&&s.input&&this._emit("inputJson",n.delta.partial_json,s.input);break}case"thinking_delta":{s.type==="thinking"&&this._emit("thinking",n.delta.thinking,s.thinking);break}case"signature_delta":{s.type==="thinking"&&this._emit("signature",s.signature);break}default:n.delta}break}case"message_stop":{this._addMessageParam(r),this._addMessage(r,!0);break}case"content_block_stop":{this._emit("contentBlock",r.content.at(-1));break}case"message_start":{m(this,ke,r);break}}},Cn=function(){if(this.ended)throw new w("stream has ended, this shouldn't happen");const n=h(this,ke,"f");if(!n)throw new w("request ended without sending any chunks");return m(this,ke,void 0),n},Ts=function(n){let r=h(this,ke,"f");if(n.type==="message_start"){if(r)throw new w(`Unexpected event order, got ${n.type} before receiving "message_stop"`);return n.message}if(!r)throw new w(`Unexpected event order, got ${n.type} before "message_start"`);switch(n.type){case"message_stop":return r;case"message_delta":return r.stop_reason=n.delta.stop_reason,r.stop_sequence=n.delta.stop_sequence,r.usage.output_tokens=n.usage.output_tokens,n.usage.input_tokens!=null&&(r.usage.input_tokens=n.usage.input_tokens),n.usage.cache_creation_input_tokens!=null&&(r.usage.cache_creation_input_tokens=n.usage.cache_creation_input_tokens),n.usage.cache_read_input_tokens!=null&&(r.usage.cache_read_input_tokens=n.usage.cache_read_input_tokens),n.usage.server_tool_use!=null&&(r.usage.server_tool_use=n.usage.server_tool_use),r;case"content_block_start":return r.content.push({...n.content_block}),r;case"content_block_delta":{const s=r.content.at(n.index);switch(n.delta.type){case"text_delta":{s?.type==="text"&&(r.content[n.index]={...s,text:(s.text||"")+n.delta.text});break}case"citations_delta":{s?.type==="text"&&(r.content[n.index]={...s,citations:[...s.citations??[],n.delta.citation]});break}case"input_json_delta":{if(s&&Ms(s)){let o=s[Rs]||"";o+=n.delta.partial_json;const i={...s};Object.defineProperty(i,Rs,{value:o,enumerable:!1,writable:!0}),o&&(i.input=Jo(o)),r.content[n.index]=i}break}case"thinking_delta":{s?.type==="thinking"&&(r.content[n.index]={...s,thinking:s.thinking+n.delta.thinking});break}case"signature_delta":{s?.type==="thinking"&&(r.content[n.index]={...s,signature:n.delta.signature});break}default:n.delta}return r}case"content_block_stop":return r}},Symbol.asyncIterator)](){const t=[],n=[];let r=!1;return this.on("streamEvent",s=>{const o=n.shift();o?o.resolve(s):t.push(s)}),this.on("end",()=>{r=!0;for(const s of n)s.resolve(void 0);n.length=0}),this.on("abort",s=>{r=!0;for(const o of n)o.reject(s);n.length=0}),this.on("error",s=>{r=!0;for(const o of n)o.reject(s);n.length=0}),{next:async()=>t.length?{value:t.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((o,i)=>n.push({resolve:o,reject:i})).then(o=>o?{value:o,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new de(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}class Qo extends ue{create(t,n){return this._client.post("/v1/messages/batches",{body:t,...n})}retrieve(t,n){return this._client.get(D`/v1/messages/batches/${t}`,n)}list(t={},n){return this._client.getAPIList("/v1/messages/batches",Pt,{query:t,...n})}delete(t,n){return this._client.delete(D`/v1/messages/batches/${t}`,n)}cancel(t,n){return this._client.post(D`/v1/messages/batches/${t}/cancel`,n)}async results(t,n){const r=await this.retrieve(t);if(!r.results_url)throw new w(`No batch \`results_url\`; Has it finished processing? ${r.processing_status} - ${r.id}`);return this._client.get(r.results_url,{...n,headers:v([{Accept:"application/binary"},n?.headers]),stream:!0,__binaryResponse:!0})._thenUnwrap((s,o)=>wn.fromResponse(o.response,o.controller))}}class br extends ue{constructor(){super(...arguments),this.batches=new Qo(this._client)}create(t,n){t.model in Es&&console.warn(`The model '${t.model}' is deprecated and will reach end-of-life on ${Es[t.model]}
Please migrate to a newer model. Visit https://docs.anthropic.com/en/docs/resources/model-deprecations for more information.`);let r=this._client._options.timeout;if(!t.stream&&r==null){const s=Ho[t.model]??void 0;r=this._client.calculateNonstreamingTimeout(t.max_tokens,s)}return this._client.post("/v1/messages",{body:t,timeout:r??6e5,...n,stream:t.stream??!1})}stream(t,n){return hn.createMessage(this,t,n)}countTokens(t,n){return this._client.post("/v1/messages/count_tokens",{body:t,...n})}}const Es={"claude-1.3":"November 6th, 2024","claude-1.3-100k":"November 6th, 2024","claude-instant-1.1":"November 6th, 2024","claude-instant-1.1-100k":"November 6th, 2024","claude-instant-1.2":"November 6th, 2024","claude-3-sonnet-20240229":"July 21st, 2025","claude-3-opus-20240229":"January 5th, 2026","claude-2.1":"July 21st, 2025","claude-2.0":"July 21st, 2025","claude-3-7-sonnet-latest":"February 19th, 2026","claude-3-7-sonnet-20250219":"February 19th, 2026"};br.Batches=Qo;class ei extends ue{retrieve(t,n={},r){const{betas:s}=n??{};return this._client.get(D`/v1/models/${t}`,{...r,headers:v([{...s?.toString()!=null?{"anthropic-beta":s?.toString()}:void 0},r?.headers])})}list(t={},n){const{betas:r,...s}=t??{};return this._client.getAPIList("/v1/models",Pt,{query:s,...n,headers:v([{...r?.toString()!=null?{"anthropic-beta":r?.toString()}:void 0},n?.headers])})}}var zd={};const Xt=e=>{if(typeof globalThis.process<"u")return zd?.[e]?.trim()??void 0;if(typeof globalThis.Deno<"u")return globalThis.Deno.env?.get?.(e)?.trim()};var Xn,wr,Qt,ti;const qd="\\n\\nHuman:",Id="\\n\\nAssistant:";class C{constructor({baseURL:t=Xt("ANTHROPIC_BASE_URL"),apiKey:n=Xt("ANTHROPIC_API_KEY")??null,authToken:r=Xt("ANTHROPIC_AUTH_TOKEN")??null,...s}={}){Xn.add(this),Qt.set(this,void 0);const o={apiKey:n,authToken:r,...s,baseURL:t||"https://api.anthropic.com"};if(!o.dangerouslyAllowBrowser&&ed())throw new w(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new Anthropic({ apiKey, dangerouslyAllowBrowser: true });
`);this.baseURL=o.baseURL,this.timeout=o.timeout??wr.DEFAULT_TIMEOUT,this.logger=o.logger??console;const i="warn";this.logLevel=i,this.logLevel=fs(o.logLevel,"ClientOptions.logLevel",this)??fs(Xt("ANTHROPIC_LOG"),"process.env['ANTHROPIC_LOG']",this)??i,this.fetchOptions=o.fetchOptions,this.maxRetries=o.maxRetries??2,this.fetch=o.fetch??od(),m(this,Qt,ad),this._options=o,this.apiKey=typeof n=="string"?n:null,this.authToken=r}withOptions(t){return new this.constructor({...this._options,baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,authToken:this.authToken,...t})}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:t,nulls:n}){if(!(t.get("x-api-key")||t.get("authorization"))&&!(this.apiKey&&t.get("x-api-key"))&&!n.has("x-api-key")&&!(this.authToken&&t.get("authorization"))&&!n.has("authorization"))throw new Error('Could not resolve authentication method. Expected either apiKey or authToken to be set. Or for one of the "X-Api-Key" or "Authorization" headers to be explicitly omitted')}async authHeaders(t){return v([await this.apiKeyAuth(t),await this.bearerAuth(t)])}async apiKeyAuth(t){if(this.apiKey!=null)return v([{"X-Api-Key":this.apiKey}])}async bearerAuth(t){if(this.authToken!=null)return v([{Authorization:`Bearer ${this.authToken}`}])}stringifyQuery(t){return Object.entries(t).filter(([n,r])=>typeof r<"u").map(([n,r])=>{if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")return`${encodeURIComponent(n)}=${encodeURIComponent(r)}`;if(r===null)return`${encodeURIComponent(n)}=`;throw new w(`Cannot stringify type ${typeof r}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${Be}`}defaultIdempotencyKey(){return`stainless-node-retry-${vo()}`}makeStatusError(t,n,r,s){return j.generate(t,n,r,s)}buildURL(t,n,r){const s=!h(this,Xn,"m",ti).call(this)&&r||this.baseURL,o=Gh(t)?new URL(t):new URL(s+(s.endsWith("/")&&t.startsWith("/")?t.slice(1):t)),i=this.defaultQuery();return Vh(i)||(n={...i,...n}),typeof n=="object"&&n&&!Array.isArray(n)&&(o.search=this.stringifyQuery(n)),o.toString()}_calculateNonstreamingTimeout(t){if(3600*t/128e3>600)throw new w("Streaming is required for operations that may take longer than 10 minutes. See https://github.com/anthropics/anthropic-sdk-typescript#streaming-responses for more details");return 600*1e3}async prepareOptions(t){}async prepareRequest(t,{url:n,options:r}){}get(t,n){return this.methodRequest("get",t,n)}post(t,n){return this.methodRequest("post",t,n)}patch(t,n){return this.methodRequest("patch",t,n)}put(t,n){return this.methodRequest("put",t,n)}delete(t,n){return this.methodRequest("delete",t,n)}methodRequest(t,n,r){return this.request(Promise.resolve(r).then(s=>({method:t,path:n,...s})))}request(t,n=null){return new bn(this,this.makeRequest(t,n,void 0))}async makeRequest(t,n,r){const s=await t,o=s.maxRetries??this.maxRetries;n==null&&(n=o),await this.prepareOptions(s);const{req:i,url:a,timeout:l}=await this.buildRequest(s,{retryCount:o-n});await this.prepareRequest(i,{url:a,options:s});const c="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),u=r===void 0?"":`, retryOf: ${r}`,d=Date.now();if(W(this).debug(`[${c}] sending request`,Ae({retryOfRequestLogID:r,method:s.method,url:a,options:s,headers:i.headers})),s.signal?.aborted)throw new ce;const g=new AbortController,f=await this.fetchWithTimeout(a,i,l,g).catch(Wn),_=Date.now();if(f instanceof globalThis.Error){const L=`retrying, ${n} attempts remaining`;if(s.signal?.aborted)throw new ce;const I=vt(f)||/timed? ?out/i.test(String(f)+("cause"in f?String(f.cause):""));if(n)return W(this).info(`[${c}] connection ${I?"timed out":"failed"} - ${L}`),W(this).debug(`[${c}] connection ${I?"timed out":"failed"} (${L})`,Ae({retryOfRequestLogID:r,url:a,durationMs:_-d,message:f.message})),this.retryRequest(s,n,r??c);throw W(this).info(`[${c}] connection ${I?"timed out":"failed"} - error; no more retries left`),W(this).debug(`[${c}] connection ${I?"timed out":"failed"} (error; no more retries left)`,Ae({retryOfRequestLogID:r,url:a,durationMs:_-d,message:f.message})),I?new So:new yn({cause:f})}const k=[...f.headers.entries()].filter(([L])=>L==="request-id").map(([L,I])=>", "+L+": "+JSON.stringify(I)).join(""),M=`[${c}${u}${k}] ${i.method} ${a} ${f.ok?"succeeded":"failed"} with status ${f.status} in ${_-d}ms`;if(!f.ok){const L=await this.shouldRetry(f);if(n&&L){const ie=`retrying, ${n} attempts remaining`;return await id(f.body),W(this).info(`${M} - ${ie}`),W(this).debug(`[${c}] response error (${ie})`,Ae({retryOfRequestLogID:r,url:f.url,status:f.status,headers:f.headers,durationMs:_-d})),this.retryRequest(s,n,r??c,f.headers)}const I=L?"error; no more retries left":"error; not retryable";W(this).info(`${M} - ${I}`);const O=await f.text().catch(ie=>Wn(ie).message),T=Oo(O),E=T?void 0:O;throw W(this).debug(`[${c}] response error (${I})`,Ae({retryOfRequestLogID:r,url:f.url,status:f.status,headers:f.headers,message:E,durationMs:Date.now()-d})),this.makeStatusError(f.status,T,E,f.headers)}return W(this).info(M),W(this).debug(`[${c}] response start`,Ae({retryOfRequestLogID:r,url:f.url,status:f.status,headers:f.headers,durationMs:_-d})),{response:f,options:s,controller:g,requestLogID:c,retryOfRequestLogID:r,startTime:d}}getAPIList(t,n,r){return this.requestAPIList(n,{method:"get",path:t,...r})}requestAPIList(t,n){const r=this.makeRequest(n,null,void 0);return new md(this,r,t)}async fetchWithTimeout(t,n,r,s){const{signal:o,method:i,...a}=n||{};o&&o.addEventListener("abort",()=>s.abort());const l=setTimeout(()=>s.abort(),r),c=globalThis.ReadableStream&&a.body instanceof globalThis.ReadableStream||typeof a.body=="object"&&a.body!==null&&Symbol.asyncIterator in a.body,u={signal:s.signal,...c?{duplex:"half"}:{},method:"GET",...a};i&&(u.method=i.toUpperCase());try{return await this.fetch.call(void 0,t,u)}finally{clearTimeout(l)}}async shouldRetry(t){const n=t.headers.get("x-should-retry");return n==="true"?!0:n==="false"?!1:t.status===408||t.status===409||t.status===429||t.status>=500}async retryRequest(t,n,r,s){let o;const i=s?.get("retry-after-ms");if(i){const l=parseFloat(i);Number.isNaN(l)||(o=l)}const a=s?.get("retry-after");if(a&&!o){const l=parseFloat(a);Number.isNaN(l)?o=Date.parse(a)-Date.now():o=l*1e3}if(!(o&&0<=o&&o<60*1e3)){const l=t.maxRetries??this.maxRetries;o=this.calculateDefaultRetryTimeoutMillis(n,l)}return await Qh(o),this.makeRequest(t,n-1,r)}calculateDefaultRetryTimeoutMillis(t,n){const o=n-t,i=Math.min(.5*Math.pow(2,o),8),a=1-Math.random()*.25;return i*a*1e3}calculateNonstreamingTimeout(t,n){if(36e5*t/128e3>6e5||n!=null&&t>n)throw new w("Streaming is required for operations that may take longer than 10 minutes. See https://github.com/anthropics/anthropic-sdk-typescript#long-requests for more details");return 6e5}async buildRequest(t,{retryCount:n=0}={}){const r={...t},{method:s,path:o,query:i,defaultBaseURL:a}=r,l=this.buildURL(o,i,a);"timeout"in r&&Kh("timeout",r.timeout),r.timeout=r.timeout??this.timeout;const{bodyHeaders:c,body:u}=this.buildBody({options:r}),d=await this.buildHeaders({options:t,method:s,bodyHeaders:c,retryCount:n});return{req:{method:s,headers:d,...r.signal&&{signal:r.signal},...globalThis.ReadableStream&&u instanceof globalThis.ReadableStream&&{duplex:"half"},...u&&{body:u},...this.fetchOptions??{},...r.fetchOptions??{}},url:l,timeout:r.timeout}}async buildHeaders({options:t,method:n,bodyHeaders:r,retryCount:s}){let o={};this.idempotencyHeader&&n!=="get"&&(t.idempotencyKey||(t.idempotencyKey=this.defaultIdempotencyKey()),o[this.idempotencyHeader]=t.idempotencyKey);const i=v([o,{Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(s),...t.timeout?{"X-Stainless-Timeout":String(Math.trunc(t.timeout/1e3))}:{},...sd(),...this._options.dangerouslyAllowBrowser?{"anthropic-dangerous-direct-browser-access":"true"}:void 0,"anthropic-version":"2023-06-01"},await this.authHeaders(t),this._options.defaultHeaders,r,t.headers]);return this.validateHeaders(i),i.values}buildBody({options:{body:t,headers:n}}){if(!t)return{bodyHeaders:void 0,body:void 0};const r=v([n]);return ArrayBuffer.isView(t)||t instanceof ArrayBuffer||t instanceof DataView||typeof t=="string"&&r.values.has("content-type")||globalThis.Blob&&t instanceof globalThis.Blob||t instanceof FormData||t instanceof URLSearchParams||globalThis.ReadableStream&&t instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:t}:typeof t=="object"&&(Symbol.asyncIterator in t||Symbol.iterator in t&&"next"in t&&typeof t.next=="function")?{bodyHeaders:void 0,body:qo(t)}:h(this,Qt,"f").call(this,{body:t,headers:r})}}wr=C,Qt=new WeakMap,Xn=new WeakSet,ti=function(){return this.baseURL!=="https://api.anthropic.com"};C.Anthropic=wr;C.HUMAN_PROMPT=qd;C.AI_PROMPT=Id;C.DEFAULT_TIMEOUT=6e5;C.AnthropicError=w;C.APIError=j;C.APIConnectionError=yn;C.APIConnectionTimeoutError=So;C.APIUserAbortError=ce;C.NotFoundError=To;C.ConflictError=Ro;C.RateLimitError=Eo;C.BadRequestError=xo;C.AuthenticationError=$o;C.InternalServerError=Ao;C.PermissionDeniedError=Po;C.UnprocessableEntityError=Mo;C.toFile=vd;class vn extends C{constructor(){super(...arguments),this.completions=new Ko(this),this.messages=new br(this),this.models=new ei(this),this.beta=new Je(this)}}vn.Completions=Ko;vn.Messages=br;vn.Models=ei;vn.Beta=Je;function Cd(e){const{registrations:t,complexityFactors:n,calculations:r,followUps:s}=e,o=[],i=[],a=[];let l=1;if(r.blockDiy)return{priority1:[],priority2:[],priority3:[]};if(n.hasCowriters&&(s.f5_split_sheets_status==="no"||s.f5_split_sheets_status==="yes_some"||s.f5_split_sheets_status==="whats_a_split_sheet")&&o.push({number:l++,title:"Document Co-Writer Splits",why:"Before registering any co-written songs, you need written agreement on who owns what percentage. Conflicting claims freeze royalty payments.",instructions:`Create a simple split sheet for each co-written song that documents:
- Song title
- Each writer's name and ownership percentage
- Get each co-writer to sign

This protects everyone and ensures clean registrations.`,linkText:"Download Split Sheet Template",linkUrl:"https://theroyaltyguy.com/split-sheet",timeEstimate:"15 minutes per song",requirements:["Co-writer contact info","Agreement on percentages"]}),t.hasPro&&!t.hasPublishingAdmin&&t.hasProPublishingEntity===!1){const c=t.proName?.toUpperCase()||"your PRO";o.push({number:l++,title:`Create a Publishing Entity with ${c}`,why:"Performance royalties are split 50/50 between Writer and Publisher. Without a publishing entity, you're only collecting the Writer half - you're missing 50% of your PRO income!",instructions:c==="ASCAP"?`1. Log into your ASCAP account
2. Go to Member Access
3. Click "Create a Publisher"
4. Choose a name for your publishing company (can be anything)
5. Complete the application
6. Once approved, register your songs under your publisher entity too

This is FREE and takes about 15 minutes.`:c==="BMI"?`1. Log into your BMI account
2. Go to Publisher Affiliation
3. Apply for publisher affiliation
4. Choose a name for your publishing company
5. Complete the application
6. Once approved, register your songs under your publisher entity too

This is FREE and takes about 15 minutes.`:`Contact ${c} to set up a publisher entity under your account. This lets you collect both the writer and publisher share of your performance royalties.`,linkText:c==="ASCAP"?"ASCAP Publisher Info":"BMI Publisher Info",linkUrl:c==="ASCAP"?"https://www.ascap.com/help/music-business-101/publishing":"https://www.bmi.com/join#publisher",timeEstimate:"15-20 minutes",requirements:["Your PRO login","A name for your publishing company"]})}if(t.hasPro||o.push({number:l++,title:"Join a PRO (ASCAP or BMI)",why:"PROs collect performance royalties when your songs are played on radio, TV, in venues, or streamed. Without this, you're missing this entire royalty stream.",instructions:`Choose one (not both):
- **BMI**: Free for writers. More songwriter-focused.
- **ASCAP**: $50 one-time fee. Slightly faster payments.

Both are legitimate - pick whichever appeals to you.

1. Create an account on their website
2. Complete the membership application
3. Once approved, add your songs as "works"

Important: Also create a publishing entity (see instructions above) to collect both halves of your royalties.`,linkText:"Join BMI (Free)",linkUrl:"https://www.bmi.com/join",timeEstimate:"20 minutes to join, plus 5-10 minutes per song to register works",requirements:["Legal name and SSN","Contact information","Your song titles and co-writer info"]}),!t.hasMlc&&!t.mlcCoveredByAdmin&&o.push({number:l++,title:"Register with The MLC",why:"The MLC collects mechanical royalties from US streaming services. At your income level, this could be significant money accumulating unclaimed.",instructions:`1. Go to themlc.com and create a free account
2. Add your songs using their ISRC codes (get these from ${ln(t.distributor)})
3. Once registered, royalties will start flowing to you

Note: Unclaimed MLC royalties may be redistributed after 3 years, so register soon.`,linkText:"Register with The MLC",linkUrl:"https://www.themlc.com",timeEstimate:"30-60 minutes depending on catalog size",requirements:[`Catalog export from ${ln(t.distributor)} with ISRC codes`,"Co-writer splits for any collaborative songs"]}),t.hasSoundexchange||o.push({number:l++,title:"Register with SoundExchange (Both Sides!)",why:"SoundExchange collects royalties when your recordings are played on digital radio (Pandora, SiriusXM, internet radio). SiriusXM spins are especially valuable - about $35 per spin if you own 100%.",instructions:`Important: You need to register as BOTH:
- **Rights Owner** (50%): You own the master recording
- **Featured Artist** (45%): You performed on the recording

Most indie artists need both registrations to collect their full 95%.

1. Go to soundexchange.com
2. Create an account as Featured Artist
3. Also register as Rights Owner
4. Add your recordings

This applies to cover songs too - you own the master royalties for YOUR recording of a cover.`,linkText:"Register with SoundExchange",linkUrl:"https://www.soundexchange.com",timeEstimate:"20-30 minutes",requirements:["Legal name and SSN","Your recordings/releases"]}),t.hasSoundexchange&&t.soundexchangeOneSide){const c=s.f18_soundexchange_registration_type==="rights_owner_only"?"Featured Artist":"Rights Owner";o.push({number:l++,title:`Register as ${c} with SoundExchange`,why:`You're only registered as one side and missing roughly half your SoundExchange royalties! The ${c} side gets ${c==="Featured Artist"?"45%":"50%"} of the total.`,instructions:`1. Log into your SoundExchange account
2. Navigate to add a new registration type
3. Register as ${c}
4. Add your recordings under this registration

This could nearly double your SoundExchange income.`,linkText:"SoundExchange Account",linkUrl:"https://www.soundexchange.com/login",timeEstimate:"15-20 minutes",requirements:["Your SoundExchange login"]})}return n.hasCowriters&&(s.f6_cowriter_registered==="yes_they_registered"||s.f6_cowriter_registered==="not_sure"||s.f6_cowriter_registered==="some_have_some_havent")&&i.push({number:l++,title:"Verify Existing Registrations (Before Registering)",why:"Your co-writers may have already registered these songs. If their splits don't match yours, you'll create a conflict that freezes payments.",instructions:`1. Search Songview (songview.com) for each co-written song
2. Check what splits are already registered
3. Contact your co-writers to confirm
4. Only register once you've verified no conflicts

If you find conflicting registrations, you'll need to work with your co-writers to resolve them before proceeding.`,linkText:"Search Songview",linkUrl:"https://songview.com",timeEstimate:"30-60 minutes",requirements:["List of co-written songs","Co-writer contact info"]}),n.songsByOthers&&(s.f10_registered_on_others==="no"||s.f10_registered_on_others==="not_sure")&&i.push({number:l++,title:"Register as Songwriter on Other Artists' Releases",why:"When other artists record your songs, you're entitled to songwriter royalties from their streams. You may be missing significant income.",instructions:`1. List all songs recorded by other artists
2. Search Songview to see if you're listed as writer
3. If not, register yourself as songwriter with your PRO
4. Contact the other artists' teams to ensure proper crediting`,linkText:"Search Songview",linkUrl:"https://songview.com",timeEstimate:"1-2 hours",requirements:["List of songs by other artists","Your PRO account"]}),(s.f16_audience_location==="mostly_outside_us"||s.f16_audience_location==="mix")&&!t.hasPublishingAdmin&&a.push({number:l++,title:"Consider International Royalty Collection",why:"The MLC only collects US mechanical royalties. With significant international audience, you may have unclaimed royalties in other countries.",instructions:`Options:
1. **Publishing Administrator** (Songtrust, Sentric, TuneCore Publishing) - They register with foreign societies for you. Commission: 10-20% of what they collect.
2. **Direct Registration** - Register directly with foreign PROs and collection societies. More work, but no commission.

For most artists, a publishing admin is the easier choice for international collection.`,timeEstimate:"Research: 1 hour, Setup: 1-2 hours"}),n.nameChanges&&a.push({number:l++,title:"Verify Registrations Under All Artist Names",why:"Your music is released under multiple names, so registrations may be fragmented. Searches might miss parts of your catalog.",instructions:`For each name variation (${n.previousNames||"your previous names"}):
1. Search Songview
2. Check your PRO account
3. Search The MLC database
4. Check SoundExchange

Ensure all songs under all names are properly registered and linked to you.`,timeEstimate:"1-2 hours"}),{priority1:o,priority2:i,priority3:a}}function Nd(e){const t=[];for(const n of e.gotchasDetected){const r=n.severity==="critical"?"🔴":n.severity==="warning"?"⚠️":"ℹ️";t.push({icon:r,title:n.title,description:n.description,consequence:n.consequence,action:n.action})}return t}function Ld(e,t){const{intake:n,registrations:r,calculations:s,gotchasDetected:o}=e,i=Cd(e),a=Nd(e),l=[],c=[];r.hasDistributor&&l.push({name:`Distribution (${ln(r.distributor)})`,description:"Collecting streaming income from Spotify, Apple Music, etc."}),r.hasPro?l.push({name:`PRO (${os(r.proName)})`,description:"Collecting performance royalties for your compositions"}):c.push({name:"PRO Membership",whatItCollects:"Performance royalties for your compositions"}),r.hasMlc?l.push({name:"The MLC",description:"Collecting mechanical royalties from US streaming"}):r.mlcCoveredByAdmin?l.push({name:`The MLC (via ${is(r.publishingAdmin)})`,description:"Mechanical royalties covered by your publishing admin"}):c.push({name:"The MLC",whatItCollects:"Mechanical royalties from US streaming"}),r.hasSoundexchange?l.push({name:"SoundExchange",description:"Collecting digital radio royalties for your recordings"}):c.push({name:"SoundExchange",whatItCollects:"Digital radio royalties (Pandora, SiriusXM, etc.)"});const u=[],{estimates:d}=s;d.pro.applicable&&u.push({name:"PRO (Performance)",monthly:`~${re(d.pro.monthly)}`,total:`~${Te(d.pro.totalLow,d.pro.totalHigh)}`}),d.proPublisherShare.applicable&&u.push({name:"PRO Publisher Share",monthly:`~${re(d.proPublisherShare.monthly)}`,total:`~${Te(d.proPublisherShare.totalLow,d.proPublisherShare.totalHigh)}`}),d.mlc.applicable&&u.push({name:"The MLC (Mechanicals)",monthly:`~${re(d.mlc.monthly)}`,total:`~${Te(d.mlc.totalLow,d.mlc.totalHigh)}`}),d.soundexchange.applicable&&u.push({name:"SoundExchange",monthly:`~${re(d.soundexchange.monthly)}`,total:`~${Te(d.soundexchange.totalLow,d.soundexchange.totalHigh)}`}),d.soundexchangeMissingSide.applicable&&u.push({name:"SoundExchange (Missing Side)",monthly:`~${re(d.soundexchangeMissingSide.monthly)}`,total:`~${Te(d.soundexchangeMissingSide.totalLow,d.soundexchangeMissingSide.totalHigh)}`}),d.songsByOthers.applicable&&u.push({name:"Songs by Other Artists",monthly:`~${re(d.songsByOthers.monthly)}`,total:`~${Te(d.songsByOthers.totalLow,d.songsByOthers.totalHigh)}`});const g=[];r.hasPro||g.push({task:"Join PRO + register works",time:"1-2 hours"}),r.hasPro&&!r.hasPublishingAdmin&&!r.hasProPublishingEntity&&g.push({task:"Create PRO publishing entity",time:"15-20 min"}),!r.hasMlc&&!r.mlcCoveredByAdmin&&g.push({task:"Register with The MLC",time:"30-60 min"}),r.hasSoundexchange||g.push({task:"Register with SoundExchange",time:"20-30 min"}),e.complexityFactors.hasCowriters&&g.push({task:"Document co-writer splits",time:"1-2 hours"});let f;if(s.blockDiy){const k=o.filter(M=>M.severity==="critical"&&M.blocksDiy);k.some(M=>M.id==="estate_inherited")?f="Estate and inherited catalog situations require legal documentation before any registrations can be made. Proceeding without proper authority could create legal complications.":k.some(M=>M.id==="legal_disputes")?f="With potential legal disputes or contested ownership, making registrations could complicate your situation. We recommend consulting with an entertainment attorney before proceeding.":k.some(M=>M.id==="double_publishing_admin")&&(f="You may have multiple publishing administrators with active registrations. Registering new songs could create additional conflicts. The existing situation needs to be resolved first.")}const _=s.diyTimeHoursLow===s.diyTimeHoursHigh?`${s.diyTimeHoursLow} hours`:`${s.diyTimeHoursLow}-${s.diyTimeHoursHigh} hours`;return{artistName:n.q1_artist_name,legalName:n.q2_legal_name,currentDate:new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),distributor:ln(r.distributor),monthlyIncome:Dh(n.q6_monthly_income),catalogSize:Bh(n.q4_catalog_size),timeReleasing:Zh(n.q3_time_releasing),score:s.score,scoreLabel:s.scoreLabel,estimateLow:re(s.estimates.total.totalLow),estimateHigh:re(s.estimates.total.totalHigh),monthlyGap:re(s.estimates.total.monthlyGap),complexity:s.complexity,recommendation:s.recommendation,registrationsHave:l,registrationsMissing:c,hasDistributor:r.hasDistributor,hasPro:r.hasPro,proName:r.proName?os(r.proName):null,proWorksRegistered:null,hasProPublishingEntity:r.hasProPublishingEntity,hasMlc:r.hasMlc||r.mlcCoveredByAdmin,hasPublishingAdmin:r.hasPublishingAdmin,publishingAdmin:r.publishingAdmin?is(r.publishingAdmin):null,hasSoundexchange:r.hasSoundexchange,soundexchangeBothSides:r.soundexchangeBothSides,soundexchangeOneSide:r.soundexchangeOneSide,soundexchangeRegisteredAs:r.soundexchangeRegisteredAs,missingEstimates:u,totalMonthlyLoss:re(s.estimates.total.monthlyGap),totalLossEstimate:Te(s.estimates.total.totalLow,s.estimates.total.totalHigh),estimationExplanation:"Estimates are based on industry averages for your income level. Mechanical royalties are typically 10-15% of streaming income. Performance royalties vary based on radio play and venue usage. SoundExchange royalties depend on digital radio exposure. Actual amounts may vary significantly.",hasWarnings:a.length>0,warnings:a,isCritical:s.blockDiy,criticalMessage:f,actionsPriority1:i.priority1,actionsPriority2:i.priority2,actionsPriority3:i.priority3,diyTimeEstimates:g,totalDiyTime:_,dfyPrice:`$${t.pricing.doneForYouLow}-${t.pricing.doneForYouHigh}`,ongoingPrice:`$${t.pricing.ongoingLow}-${t.pricing.ongoingHigh}`,dfyBestFor:s.complexity==="Complex"?"People with complex situations who want expert handling":s.complexity==="Moderate"?"People who value their time or want peace of mind":"People who prefer to have an expert handle it",consultationLink:t.links.consultation,dfyLink:t.links.purchaseDfy,fullServiceLink:t.links.purchaseFull,callLink:t.links.freeCall,splitSheetLink:t.links.splitSheetTemplate}}function Dd(e){const t=[];return t.push(Zd(e)),t.push(Bd(e)),t.push(jd(e)),t.push(Fd(e)),t.push(Ud(e)),e.hasWarnings&&t.push(Wd(e)),t.push(Hd(e)),e.isCritical||t.push(Yd()),!e.isCritical&&e.diyTimeEstimates.length>0&&t.push(Jd(e)),t.push(Gd(e)),t.push(Vd(e)),t.join(`

`)}function Zd(e){return`# Royalty Health Report

**Prepared for:** ${e.artistName}
**Date:** ${e.currentDate}

---`}function Bd(e){return`## Quick Summary

| Metric | Value |
|--------|-------|
| **Registration Score** | ${e.score}/10 (${e.scoreLabel}) |
| **Estimated Unclaimed Royalties** | ${e.estimateLow} - ${e.estimateHigh} |
| **Ongoing Monthly Gap** | ~${e.monthlyGap}/month |
| **Situation Complexity** | ${e.complexity} |
| **Recommended Path** | ${e.recommendation} |

---`}function jd(e){let t=`## Your Current Setup

### What You Have ✓

`;if(e.registrationsHave.length>0)for(const n of e.registrationsHave)t+=`- ✅ **${n.name}** - ${n.description}
`;else t+=`- ❌ No royalty registrations detected
`;if(t+=`
### What You're Missing ✗

`,e.registrationsMissing.length>0)for(const n of e.registrationsMissing)t+=`- ❌ **${n.name}** - ${n.whatItCollects}
`;else t+=`- ✅ You appear to have all major registrations covered
`;return t+=`
---`,t}function Fd(e){let t=`## Understanding Your Royalty Streams

As a musician, you have multiple income streams. Here's what applies to you:

### 1. Distribution Income (Streaming/Downloads)
**Source:** Your distributor (${e.distributor})
**What it is:** When someone streams your song on Spotify, Apple Music, etc., your distributor collects and pays you.

`;return e.hasDistributor?t+=`✅ You're collecting this.
`:t+=`❌ You need a distributor to release music and collect streaming income.
`,t+=`
### 2. Performance Royalties (PRO)
**Source:** ASCAP, BMI, or SESAC
**What it is:** When your song is played on radio, TV, in venues, or streamed, your PRO collects performance royalties for the *composition* (the song itself, not the recording).

**Important:** Performance royalties are split **50/50 between Writer and Publisher**:
- **Writer share (50%)** - Goes to you as the songwriter
- **Publisher share (50%)** - Goes to whoever publishes your music

If you don't have a publisher or publishing admin, you need to create your own **publishing entity** with your PRO to collect the publisher half. Otherwise, you're only getting 50% of your performance royalties! Creating a publishing entity is FREE and takes about 15 minutes.

`,e.hasPro?(t+=`✅ You're registered with ${e.proName}.
`,e.hasPublishingAdmin?t+=`✅ Your publishing admin (${e.publishingAdmin}) collects your publisher share.
`:e.hasProPublishingEntity?t+=`✅ You have a publishing entity to collect both shares.
`:t+=`⚠️ **You may be missing 50% of your PRO income.** Without a publishing entity, you're only collecting the Writer share. Set up a publishing entity with ${e.proName} to collect both halves.
`):t+=`❌ **You are not collecting performance royalties.** This is separate from what your distributor pays you.
`,t+=`
### 3. Mechanical Royalties (The MLC)
**Source:** The Mechanical Licensing Collective
**What it is:** When your song is streamed on interactive services (Spotify, Apple Music, Amazon), mechanical royalties are generated for the *composition*. This is separate from what your distributor pays.

`,e.hasMlc?e.hasPublishingAdmin?t+=`✅ Your publishing administrator (${e.publishingAdmin}) should be collecting this for you.
`:t+=`✅ You're registered with The MLC.
`:t+=`❌ **You are not collecting mechanical royalties.** This could be significant money accumulating unclaimed.
`,t+=`
### 4. Digital Performance Royalties (SoundExchange)
**Source:** SoundExchange
**What it is:** When your *recording* is played on non-interactive digital radio (Pandora, SiriusXM, internet radio), SoundExchange collects royalties for the sound recording.

**Important:** SoundExchange has **TWO separate registrations**:
- **Rights Owner (50%)** - Who owns the master recording (typically you if you're indie)
- **Featured Artist (45%)** - Who performed on the recording (you)
- **Non-featured (5%)** - Goes to session musician fund (AFM/SAG-AFTRA)

If you record and perform your own music, you need to register as **BOTH** Rights Owner AND Featured Artist to collect your full 95%. Many artists only register once and miss roughly half their SoundExchange money!

Also note: **This applies to cover songs too!** If you recorded a cover of someone else's song, YOU own the Rights Owner and Featured Artist royalties for YOUR recording. (The composition royalties go to the original songwriter, but the master royalties are yours.)

SiriusXM plays are especially valuable - **~$35 per spin total** if you own 100% of both sides.

`,e.hasSoundexchange?(t+=`✅ You're registered with SoundExchange.
`,e.soundexchangeBothSides?t+=`✅ You're registered as both Rights Owner and Featured Artist.
`:e.soundexchangeOneSide?t+=`⚠️ **You may be missing half your SoundExchange income.** You're only registered as ${e.soundexchangeRegisteredAs}. Register as the other side to collect your full royalties.
`:t+=`⚠️ Make sure you're registered as BOTH Rights Owner AND Featured Artist to collect your full royalties.
`):t+=`❌ **You are not collecting digital performance royalties.** The amount varies by how much radio play you get, but SXM spins are extremely valuable (~$35/spin total at 100% ownership).
`,t+=`
---`,t}function Ud(e){let t=`## Estimated Money Left on the Table

Based on your reported income of **${e.monthlyIncome}**/month from streaming:

| Missing Registration | Estimated Monthly Loss | Estimated Total Lost |
|---------------------|----------------------|---------------------|
`;for(const n of e.missingEstimates)t+=`| ${n.name} | ${n.monthly} | ${n.total} |
`;return t+=`| **TOTAL** | **~${e.totalMonthlyLoss}** | **~${e.totalLossEstimate}** |

**How we calculated this:**
${e.estimationExplanation}

⚠️ **Important:** These are estimates based on industry averages. Actual amounts vary based on where your streams come from, radio play, and other factors. The only way to know for sure is to register and start collecting.

---`,t}function Wd(e){let t=`## ⚠️ Warnings & Red Flags

`;for(const n of e.warnings)t+=`### ${n.icon} ${n.title}

${n.description}

**Why this matters:** ${n.consequence}

**What to do:** ${n.action}

---

`;return t}function Hd(e){if(e.isCritical)return`## Your Action Plan

### 🛑 STOP - Complex Situation Detected

${e.criticalMessage}

**We recommend scheduling a consultation before taking any action.** Proceeding with DIY registration could make your situation worse.

[Book a Consultation →](${e.consultationLink})

---`;let t=`## Your Action Plan

`;if(e.actionsPriority1.length>0){t+=`### Priority 1: Do This Week (Critical)

`;for(const n of e.actionsPriority1)t+=Nn(n)}if(e.actionsPriority2.length>0){t+=`### Priority 2: Do This Month (Important)

`;for(const n of e.actionsPriority2)t+=Nn(n)}if(e.actionsPriority3.length>0){t+=`### Priority 3: When You Have Time (Recommended)

`;for(const n of e.actionsPriority3)t+=Nn(n)}return t+="---",t}function Nn(e){let t=`#### ${e.number}. ${e.title}

**Why:** ${e.why}

**How:**
${e.instructions}

`;if(e.linkText&&e.linkUrl&&(t+=`**Link:** [${e.linkText}](${e.linkUrl})

`),t+=`**Time needed:** ${e.timeEstimate}

`,e.requirements&&e.requirements.length>0){t+=`**What you'll need:**
`;for(const n of e.requirements)t+=`- ${n}
`;t+=`
`}return t+=`---

`,t}function Yd(e){return`## Ongoing Maintenance

Once you complete the setup above, here's what you need to do going forward:

### Every New Release:
- Register new songs with your PRO as "works"
- If not using a publishing admin, register with The MLC
- Confirm co-writer splits are documented before release

### Quarterly:
- Check that royalty payments are arriving from all sources
- Log into each account to verify no issues

### Annually:
- Review your catalog for any missing registrations
- Update contact/payment info if changed

---`}function Jd(e){let t=`## DIY Estimated Time

If you follow this plan yourself:

| Task | Estimated Time |
|------|---------------|
`;for(const n of e.diyTimeEstimates)t+=`| ${n.task} | ${n.time} |
`;return t+=`| **Total** | **${e.totalDiyTime}** |

---`,t}function Gd(e){return e.isCritical?`## Your Options

Given the complexity of your situation, we recommend:

### Consultation ($49)
A 30-minute call to discuss your specific situation and create a custom action plan.

[Book a Consultation →](${e.consultationLink})

---`:`## Your Options

### Option 1: DIY (Free)
You have everything you need in this report. Follow the action plan step by step.

**Best for:** People with straightforward situations and time to handle it themselves.

**Estimated time:** ${e.totalDiyTime}

---

### Option 2: Done-For-You (${e.dfyPrice})

I'll execute this entire plan for you:
- Complete all registrations on your behalf
- Verify everything is set up correctly
- Handle any complications that arise
- Deliver a confirmation report when complete

**Best for:** ${e.dfyBestFor}

**Typical turnaround:** 1-2 weeks

[Get Done-For-You →](${e.dfyLink})

---

### Option 3: Done-For-You + Ongoing Management (${e.dfyPrice} + ${e.ongoingPrice}/month)

Everything in Option 2, plus:
- Quarterly royalty statement review
- New release registration reminders
- Ongoing monitoring for issues
- Direct access for questions
- Annual royalty health check

**Best for:** Artists who want to focus on music, not paperwork.

[Get Full Service →](${e.fullServiceLink})

---`}function Vd(e){return`## Questions?

**Not sure which option is right for you?**

Book a free 15-minute call to discuss your situation:
[Schedule a Call →](${e.callLink})

---

## Disclaimer

This report is for informational purposes only and does not constitute legal, tax, or financial advice. Estimates are based on industry averages and your reported information; actual royalties may vary. We recommend consulting with appropriate professionals for complex situations involving legal disputes, estates, or significant income.

---

**Report generated by The Royalty Guy**`}function Xd(e,t={},n){const r=Lh(e,t),s=fr(r),o=Hh(r),i=Yh(r),a=Ld(r,n),l=Dd(a);return{stage1:r,stage2:s,reportData:a,reportMarkdown:l,canGeneratePlan:o,missingInfoWarning:i,timestamp:new Date().toISOString()}}const Kd=se({name:b(),description:b()}),Qd=se({name:b(),whatItCollects:b()}),ep=se({icon:b(),title:b(),description:b(),consequence:b(),action:b()}),Ln=se({number:ee(),title:b(),why:b(),instructions:b(),linkText:b().optional(),linkUrl:b().optional(),timeEstimate:b(),requirements:he(b()).optional()}),tp=se({task:b(),time:b()}),np=se({name:b(),monthly:b(),total:b()});se({artistName:b(),legalName:b(),currentDate:b(),distributor:b(),monthlyIncome:b(),catalogSize:b(),timeReleasing:b(),score:ee(),scoreLabel:bo,estimateLow:b(),estimateHigh:b(),monthlyGap:b(),complexity:wo,recommendation:ko,registrationsHave:he(Kd),registrationsMissing:he(Qd),hasDistributor:J(),hasPro:J(),proName:b().nullable(),proWorksRegistered:J().nullable(),hasProPublishingEntity:J().nullable(),hasMlc:J(),hasPublishingAdmin:J(),publishingAdmin:b().nullable(),hasSoundexchange:J(),soundexchangeBothSides:J().nullable(),soundexchangeOneSide:J().nullable(),soundexchangeRegisteredAs:b().nullable(),missingEstimates:he(np),totalMonthlyLoss:b(),totalLossEstimate:b(),estimationExplanation:b(),hasWarnings:J(),warnings:he(ep),isCritical:J(),criticalMessage:b().optional(),actionsPriority1:he(Ln),actionsPriority2:he(Ln),actionsPriority3:he(Ln),diyTimeEstimates:he(tp),totalDiyTime:b(),dfyPrice:b(),ongoingPrice:b(),dfyBestFor:b(),consultationLink:b(),dfyLink:b(),fullServiceLink:b(),callLink:b(),splitSheetLink:b()});const rp={pricing:{planOnly:49,doneForYouLow:399,doneForYouHigh:599,ongoingLow:99,ongoingHigh:149},links:{consultation:"https://calendly.com/theroyaltyguy/consultation",purchaseDfy:"https://theroyaltyguy.com/done-for-you",purchaseFull:"https://theroyaltyguy.com/full-service",freeCall:"https://calendly.com/theroyaltyguy/free-call",splitSheetTemplate:"https://theroyaltyguy.com/split-sheet"},externalLinks:{ascapJoin:"https://www.ascap.com/join",bmiJoin:"https://www.bmi.com/join",mlc:"https://www.themlc.com",soundexchange:"https://www.soundexchange.com",songview:"https://songview.com"},brand:{name:"The Royalty Guy",tagline:"Your royalties, handled."}};let _e=1;const sp=5;let P={},bt={},St="";document.addEventListener("DOMContentLoaded",()=>{Tt()});window.nextPage=function(e){op(e)&&(ni(e),e===3&&lp(),_e=e+1,Sn(_e),Tt())};window.prevPage=function(e){_e=e-1,Sn(_e),Tt()};function Sn(e){document.querySelectorAll(".form-page").forEach(t=>{t.classList.remove("active")}),document.getElementById(`page-${e}`).classList.add("active"),window.scrollTo({top:0,behavior:"smooth"})}function Tt(){const e=document.getElementById("progress-fill"),t=_e/sp*100;e.style.width=`${t}%`,document.querySelectorAll(".step").forEach((n,r)=>{n.classList.remove("active","completed"),r+1===_e?n.classList.add("active"):r+1<_e&&n.classList.add("completed")})}function op(e){let t=!0;return e===1?t=B("q1_artist_name","text")&&B("q2_legal_name","text")&&B("q3_time_releasing","radio")&&B("q4_catalog_size","radio")&&B("q5_distributor","radio")&&B("q6_monthly_income","radio"):e===2?t=B("q7_pro","radio")&&B("q8_soundexchange","radio")&&B("q9_mlc","radio")&&B("q10_publishing_admin","radio")&&B("q11_previous_admin","radio"):e===3&&(t=B("q12_has_cowriters","radio")&&B("q13_changed_names","radio")&&B("q14_songs_by_others","radio")&&B("q15_managing_for","radio")&&B("q16_disputes","radio")),t}function B(e,t){if(t==="text"){const n=document.getElementById(e);return n.value.trim()?(ap(n),!0):(ip(n),!1)}else if(t==="radio")return document.querySelector(`input[name="${e}"]:checked`)?(document.querySelector(`input[name="${e}"]`).closest(".form-group").classList.remove("error"),!0):(document.querySelector(`input[name="${e}"]`).closest(".form-group").classList.add("error"),!1);return!0}function ip(e){e.closest(".form-group").classList.add("error")}function ap(e){e.closest(".form-group").classList.remove("error")}function ni(e){e===1?(P.q1_artist_name=document.getElementById("q1_artist_name").value,P.q2_legal_name=document.getElementById("q2_legal_name").value,P.q3_time_releasing=Y("q3_time_releasing"),P.q4_catalog_size=Y("q4_catalog_size"),P.q5_distributor=Y("q5_distributor"),P.q6_monthly_income=Y("q6_monthly_income")):e===2?(P.q7_pro=Y("q7_pro"),P.q8_soundexchange=Y("q8_soundexchange"),P.q9_mlc=Y("q9_mlc"),P.q10_publishing_admin=Y("q10_publishing_admin"),P.q11_previous_admin=Y("q11_previous_admin")):e===3?(P.q12_has_cowriters=Y("q12_has_cowriters"),P.q13_changed_names=Y("q13_changed_names"),P.q14_songs_by_others=Y("q14_songs_by_others"),P.q15_managing_for=Y("q15_managing_for"),P.q16_disputes=Y("q16_disputes")):e===4&&up()}function Y(e){const t=document.querySelector(`input[name="${e}"]:checked`);return t?t.value:null}function lp(){const e=document.getElementById("followup-questions");e.innerHTML="";const t=[];P.q11_previous_admin==="yes"&&(t.push({id:"f1_previous_admins",question:"Which publishing administrator(s) did you use before?",type:"checkbox",options:[{value:"songtrust",label:"Songtrust"},{value:"cd_baby_pro",label:"CD Baby Pro"},{value:"tunecore_publishing",label:"TuneCore Publishing"},{value:"sentric",label:"Sentric"},{value:"other",label:"Other"}]}),t.push({id:"f2_admin_cancelled",question:"Did you formally cancel or close that account?",type:"radio",options:[{value:"yes_cancelled",label:"Yes, I cancelled it"},{value:"no_might_be_active",label:"No, it might still be active"},{value:"not_sure",label:"Not sure"}]})),P.q7_pro!=="none"&&P.q7_pro!=="not_sure"&&(P.q10_publishing_admin==="none"||P.q10_publishing_admin==="not_sure"||P.q10_publishing_admin==="distrokid")&&t.push({id:"f17_pro_publishing_entity",question:"Have you set up a publishing entity with your PRO?",helpText:"This is different from being a member. A publishing entity lets you collect both the writer AND publisher share of your royalties.",type:"radio",options:[{value:"yes_have_publishing_entity",label:"Yes, I have a publishing entity"},{value:"no_only_writer",label:"No, I'm only registered as a writer"},{value:"whats_a_publishing_entity",label:"What's a publishing entity?"},{value:"not_sure",label:"Not sure"}]}),P.q8_soundexchange==="yes"&&t.push({id:"f18_soundexchange_registration_type",question:"When you registered with SoundExchange, did you register as:",helpText:"SoundExchange has two sides: Rights Owner (who owns the master) and Featured Artist (who performed). Most indie artists need both.",type:"radio",options:[{value:"both_rights_owner_and_featured_artist",label:"Both Rights Owner AND Featured Artist"},{value:"rights_owner_only",label:"Rights Owner only"},{value:"featured_artist_only",label:"Featured Artist only"},{value:"not_sure",label:"Not sure"}]}),P.q12_has_cowriters==="yes"&&(t.push({id:"f4_cowriter_count",question:"Approximately how many of your songs have co-writers?",type:"radio",options:[{value:"1_to_5",label:"1-5 songs"},{value:"6_to_15",label:"6-15 songs"},{value:"16_to_30",label:"16-30 songs"},{value:"most_or_all",label:"Most or all of my songs"}]}),t.push({id:"f5_split_sheets_status",question:"Do you have signed split sheets documenting ownership percentages?",type:"radio",options:[{value:"yes_all",label:"Yes, for all of them"},{value:"yes_some",label:"Yes, for some of them"},{value:"no",label:"No"},{value:"whats_a_split_sheet",label:"What's a split sheet?"}]}),t.push({id:"f6_cowriter_registered",question:"Do you know if your co-writers have registered these songs with their PRO?",type:"radio",options:[{value:"yes_they_registered",label:"Yes, they have registered"},{value:"no_they_havent",label:"No, they haven't"},{value:"not_sure",label:"Not sure"},{value:"some_have_some_havent",label:"Some have, some haven't"}]})),P.q13_changed_names==="yes"&&t.push({id:"f7_previous_names",question:"What were your previous artist names?",type:"text",placeholder:"List all previous names, separated by commas"}),t.push({id:"f16_audience_location",question:"Where is most of your audience located?",type:"radio",options:[{value:"mostly_us",label:"Mostly US"},{value:"mostly_outside_us",label:"Mostly outside US"},{value:"mix",label:"Mix of US and international"},{value:"not_sure",label:"Not sure"}]}),t.length===0?e.innerHTML='<p>No additional questions needed. Click "Generate My Report" to continue.</p>':t.forEach(n=>{e.appendChild(cp(n))})}function cp(e){const t=document.createElement("div");t.className="form-group";let n=`<label>${e.question}</label>`;return e.helpText&&(n+=`<span class="help-text">${e.helpText}</span>`),e.type==="radio"?(n+='<div class="radio-group">',e.options.forEach(r=>{n+=`
        <label class="radio-option">
          <input type="radio" name="${e.id}" value="${r.value}">
          <span>${r.label}</span>
        </label>
      `}),n+="</div>"):e.type==="checkbox"?(n+='<div class="checkbox-group">',e.options.forEach(r=>{n+=`
        <label class="checkbox-option">
          <input type="checkbox" name="${e.id}" value="${r.value}">
          <span>${r.label}</span>
        </label>
      `}),n+="</div>"):e.type==="text"&&(n+=`<input type="text" id="${e.id}" placeholder="${e.placeholder||""}">`),t.innerHTML=n,t}function up(){["f1_previous_admins","f2_admin_cancelled","f3_pro_registration_order","f4_cowriter_count","f5_split_sheets_status","f6_cowriter_registered","f7_previous_names","f8_songs_per_name","f9_songs_by_others_count","f10_registered_on_others","f11_previous_admin_status","f12_relationship","f13_deceased","f14_legal_authority","f15_dispute_description","f16_audience_location","f17_pro_publishing_entity","f18_soundexchange_registration_type"].forEach(t=>{const n=document.querySelector(`input[name="${t}"]:checked`);n&&(bt[t]=n.value);const r=document.querySelectorAll(`input[name="${t}"]:checked`);r.length>0&&(bt[t]=Array.from(r).map(o=>o.value));const s=document.getElementById(t);s&&s.value&&(bt[t]=s.value)})}window.generateReport=function(){ni(4),document.getElementById("loading-overlay").classList.add("active"),setTimeout(()=>{try{St=Xd(P,bt,rp).reportMarkdown;const t=document.getElementById("report-content");t.innerHTML=x.parse(St),document.getElementById("loading-overlay").classList.remove("active"),_e=5,Sn(5),Tt()}catch(e){console.error("Error generating report:",e),document.getElementById("loading-overlay").classList.remove("active"),alert("Error generating report. Please check your answers and try again.")}},1e3)};window.copyReport=function(){navigator.clipboard.writeText(St).then(()=>{alert("Report copied to clipboard!")})};window.downloadReport=function(){const e=new Blob([St],{type:"text/markdown"}),t=URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download=`royalty-health-report-${P.q1_artist_name.replace(/\s+/g,"-").toLowerCase()}.md`,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(t)};window.startOver=function(){P={},bt={},St="",document.querySelectorAll("input").forEach(e=>{e.type==="radio"||e.type==="checkbox"?e.checked=!1:e.value=""}),_e=1,Sn(1),Tt()};
